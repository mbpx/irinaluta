"use strict";(self.webpackChunkirinaluta=self.webpackChunkirinaluta||[]).push([[179],{76:()=>{let sn=null,pa=1;function Xt(n){const e=sn;return sn=n,e}function IM(n){if((!Tl(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==pa)){if(!n.producerMustRecompute(n)&&!jm(n))return n.dirty=!1,void(n.lastCleanEpoch=pa);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=pa}}function jm(n){ma(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(IM(t),i!==t.version))return!0}return!1}function Hd(n,e){if(function UM(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),ma(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Hd(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];ma(r),r.producerIndexOfThis[i]=e}}function Tl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function ma(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let kM=null;function Ht(n){return"function"==typeof n}function Xm(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Ym=Xm(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Zm(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ei{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Ht(i))try{i()}catch(s){e=s instanceof Ym?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{GM(s)}catch(o){e=e??[],o instanceof Ym?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ym(e)}}add(e){var t;if(e&&e!==this)if(this.closed)GM(e);else{if(e instanceof Ei){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Zm(t,e)}remove(e){const{_finalizers:t}=this;t&&Zm(t,e),e instanceof Ei&&e._removeParent(this)}}Ei.EMPTY=(()=>{const n=new Ei;return n.closed=!0,n})();const HM=Ei.EMPTY;function zM(n){return n instanceof Ei||n&&"closed"in n&&Ht(n.remove)&&Ht(n.add)&&Ht(n.unsubscribe)}function GM(n){Ht(n)?n():n.unsubscribe()}const lo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},zd={setTimeout(n,e,...t){const{delegate:i}=zd;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=zd;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function WM(n){zd.setTimeout(()=>{const{onUnhandledError:e}=lo;if(!e)throw n;e(n)})}function Km(){}const DL=Jm("C",void 0,void 0);function Jm(n,e,t){return{kind:n,value:e,error:t}}let uo=null;function Gd(n){if(lo.useDeprecatedSynchronousErrorHandling){const e=!uo;if(e&&(uo={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=uo;if(uo=null,t)throw i}}else n()}class Qm extends Ei{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,zM(e)&&e.add(this)):this.destination=FL}static create(e,t,i){return new Cl(e,t,i)}next(e){this.isStopped?tg(function RL(n){return Jm("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?tg(function IL(n){return Jm("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?tg(DL,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const NL=Function.prototype.bind;function eg(n,e){return NL.call(n,e)}class LL{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Wd(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Wd(i)}else Wd(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Wd(t)}}}class Cl extends Qm{constructor(e,t,i){let r;if(super(),Ht(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&lo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&eg(e.next,s),error:e.error&&eg(e.error,s),complete:e.complete&&eg(e.complete,s)}):r=e}this.destination=new LL(r)}}function Wd(n){lo.useDeprecatedSynchronousErrorHandling?function PL(n){lo.useDeprecatedSynchronousErrorHandling&&uo&&(uo.errorThrown=!0,uo.error=n)}(n):WM(n)}function tg(n,e){const{onStoppedNotification:t}=lo;t&&zd.setTimeout(()=>t(n,e))}const FL={closed:!0,next:Km,error:function OL(n){throw n},complete:Km},ng="function"==typeof Symbol&&Symbol.observable||"@@observable";function ws(n){return n}function jM(n){return 0===n.length?ws:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Yt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function BL(n){return n&&n instanceof Qm||function kL(n){return n&&Ht(n.next)&&Ht(n.error)&&Ht(n.complete)}(n)&&zM(n)}(t)?t:new Cl(t,i,r);return Gd(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=$M(i))((r,s)=>{const o=new Cl({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[ng](){return this}pipe(...t){return jM(t)(this)}toPromise(t){return new(t=$M(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function $M(n){var e;return null!==(e=n??lo.Promise)&&void 0!==e?e:Promise}const VL=Xm(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Bi=(()=>{class n extends Yt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new qM(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new VL}next(t){Gd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Gd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Gd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?HM:(this.currentObservers=null,s.push(t),new Ei(()=>{this.currentObservers=null,Zm(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Yt;return t.source=this,t}}return n.create=(e,t)=>new qM(e,t),n})();class qM extends Bi{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:HM}}function XM(n){return Ht(n?.lift)}function wn(n){return e=>{if(XM(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function pn(n,e,t,i,r){return new HL(n,e,t,i,r)}class HL extends Qm{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function vt(n,e){return wn((t,i)=>{let r=0;t.subscribe(pn(i,s=>{i.next(n.call(e,s,r++))}))})}function Ss(n){return this instanceof Ss?(this.v=n,this):new Ss(n)}function JM(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function og(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const QM=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function ew(n){return Ht(n?.then)}function tw(n){return Ht(n[ng])}function nw(n){return Symbol.asyncIterator&&Ht(n?.[Symbol.asyncIterator])}function iw(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const rw=function lO(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function sw(n){return Ht(n?.[rw])}function ow(n){return function KM(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,v){s.push([h,f,p,v])>1||a(h,f)})})}function a(h,f){try{!function c(h){h.value instanceof Ss?Promise.resolve(h.value.v).then(l,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Ss(t.read());if(r)return yield Ss(void 0);yield yield Ss(i)}}finally{t.releaseLock()}})}function aw(n){return Ht(n?.getReader)}function Vi(n){if(n instanceof Yt)return n;if(null!=n){if(tw(n))return function uO(n){return new Yt(e=>{const t=n[ng]();if(Ht(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(QM(n))return function dO(n){return new Yt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(ew(n))return function hO(n){return new Yt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,WM)})}(n);if(nw(n))return cw(n);if(sw(n))return function fO(n){return new Yt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(aw(n))return function pO(n){return cw(ow(n))}(n)}throw iw(n)}function cw(n){return new Yt(e=>{(function mO(n,e){var t,i,r,s;return function YM(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(d){o(d)}}function c(u){try{l(i.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=JM(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Wr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Vn(n,e,t=1/0){return Ht(e)?Vn((i,r)=>vt((s,o)=>e(i,s,r,o))(Vi(n(i,r))),t):("number"==typeof e&&(t=e),wn((i,r)=>function gO(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,d=!1;const h=()=>{d&&!c.length&&!l&&e.complete()},f=v=>l<i?p(v):c.push(v),p=v=>{s&&e.next(v),l++;let g=!1;Vi(t(v,u++)).subscribe(pn(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<i;){const m=c.shift();o?Wr(e,o,()=>p(m)):p(m)}h()}catch(m){e.error(m)}}))};return n.subscribe(pn(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function ga(n=1/0){return Vn(ws,n)}const _r=new Yt(n=>n.complete());function ag(n){return n[n.length-1]}function lw(n){return Ht(ag(n))?n.pop():void 0}function Al(n){return function yO(n){return n&&Ht(n.schedule)}(ag(n))?n.pop():void 0}function uw(n,e=0){return wn((t,i)=>{t.subscribe(pn(i,r=>Wr(i,n,()=>i.next(r),e),()=>Wr(i,n,()=>i.complete(),e),r=>Wr(i,n,()=>i.error(r),e)))})}function dw(n,e=0){return wn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function hw(n,e){if(!n)throw new Error("Iterable cannot be null");return new Yt(t=>{Wr(t,e,()=>{const i=n[Symbol.asyncIterator]();Wr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Sn(n,e){return e?function bO(n,e){if(null!=n){if(tw(n))return function xO(n,e){return Vi(n).pipe(dw(e),uw(e))}(n,e);if(QM(n))return function wO(n,e){return new Yt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(ew(n))return function MO(n,e){return Vi(n).pipe(dw(e),uw(e))}(n,e);if(nw(n))return hw(n,e);if(sw(n))return function SO(n,e){return new Yt(t=>{let i;return Wr(t,e,()=>{i=n[rw](),Wr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ht(i?.return)&&i.return()})}(n,e);if(aw(n))return function EO(n,e){return hw(ow(n),e)}(n,e)}throw iw(n)}(n,e):Vi(n)}class Hi extends Bi{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function De(...n){return Sn(n,Al(n))}function fw(n={}){const{connector:e=(()=>new Bi),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{const v=o;f(),v?.unsubscribe()};return wn((v,g)=>{l++,!d&&!u&&h();const m=c=c??e();g.add(()=>{l--,0===l&&!d&&!u&&(a=cg(p,r))}),m.subscribe(g),!o&&l>0&&(o=new Cl({next:_=>m.next(_),error:_=>{d=!0,h(),a=cg(f,t,_),m.error(_)},complete:()=>{u=!0,h(),a=cg(f,i),m.complete()}}),Vi(v).subscribe(o))})(s)}}function cg(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Cl({next:()=>{i.unsubscribe(),n()}});return e(...t).subscribe(i)}function di(n,e){return wn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(pn(i,c=>{r?.unsubscribe();let l=0;const u=s++;Vi(n(c,u)).subscribe(r=pn(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function AO(n,e){return n===e}function Tt(n){for(let e in n)if(n[e]===Tt)return e;throw Error("Could not find renamed property on target object.")}function mn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(mn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function lg(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const DO=Tt({__forward_ref__:Tt});function ug(n){return n.__forward_ref__=ug,n.toString=function(){return mn(this())},n}function ke(n){return $d(n)?n():n}function $d(n){return"function"==typeof n&&n.hasOwnProperty(DO)&&n.__forward_ref__===ug}function dg(n){return n&&!!n.\u0275providers}class te extends Error{constructor(e,t){super(function va(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}const Dl=Tt({\u0275cmp:Tt}),hg=Tt({\u0275dir:Tt}),fg=Tt({\u0275pipe:Tt}),mw=Tt({\u0275mod:Tt}),jr=Tt({\u0275fac:Tt}),Il=Tt({__NG_ELEMENT_ID__:Tt}),gw=Tt({__NG_ENV_ID__:Tt});function je(n){return"string"==typeof n?n:null==n?"":String(n)}function pg(n,e){throw new te(-201,!1)}function hi(n,e){null==n&&function Be(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function xr(n){return{providers:n.providers||[],imports:n.imports||[]}}function qd(n){return vw(n,Yd)||vw(n,yw)}function vw(n,e){return n.hasOwnProperty(e)?n[e]:null}function Xd(n){return n&&(n.hasOwnProperty(mg)||n.hasOwnProperty(kO))?n[mg]:null}const Yd=Tt({\u0275prov:Tt}),mg=Tt({\u0275inj:Tt}),yw=Tt({ngInjectableDef:Tt}),kO=Tt({ngInjectorDef:Tt});var dt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(dt||{});let gg;function _w(){return gg}function fi(n){const e=gg;return gg=n,e}function xw(n,e,t){const i=qd(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&dt.Optional?null:void 0!==e?e:void pg(mn(n))}const Lt=globalThis;class ve{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Rl={},Mg="__NG_DI_FLAG__",Zd="ngTempTokenPath",HO=/\n/gm,ww="__source";let ya;function bs(n){const e=ya;return ya=n,e}function WO(n,e=dt.Default){if(void 0===ya)throw new te(-203,!1);return null===ya?xw(n,void 0,e):ya.get(n,e&dt.Optional?null:void 0,e)}function Me(n,e=dt.Default){return(_w()||WO)(ke(n),e)}function se(n,e=dt.Default){return Me(n,Kd(e))}function Kd(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function wg(n){const e=[];for(let t=0;t<n.length;t++){const i=ke(n[t]);if(Array.isArray(i)){if(0===i.length)throw new te(900,!1);let r,s=dt.Default;for(let o=0;o<i.length;o++){const a=i[o],c=jO(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(Me(r,s))}else e.push(Me(i))}return e}function Pl(n,e){return n[Mg]=e,n.prototype[Mg]=e,n}function jO(n){return n[Mg]}function $r(n){return{toString:n}.toString()}var Jd=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Jd||{}),Qi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Qi||{});const Mr={},yt=[];function Ew(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Sg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];Tw(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function bw(n){return 3===n||4===n||6===n}function Tw(n){return 64===n.charCodeAt(0)}function Nl(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Cw(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Cw(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const Aw="ng-template";function XO(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==Ew(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Dw(n){return 4===n.type&&n.value!==Aw}function YO(n,e,t){return e===(4!==n.type||t?n.value:Aw)}function ZO(n,e,t){let i=4;const r=n.attrs||[],s=function QO(n){for(let e=0;e<n.length;e++)if(bw(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!YO(n,c,t)||""===c&&1===e.length){if(er(i))return!1;o=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!XO(n.attrs,l,t)){if(er(i))return!1;o=!0}continue}const d=KO(8&i?"class":c,r,Dw(n),t);if(-1===d){if(er(i))return!1;o=!0;continue}if(""!==l){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==Ew(f,l,0)||2&i&&l!==h){if(er(i))return!1;o=!0}}}}else{if(!o&&!er(i)&&!er(c))return!1;if(o&&er(c))continue;o=!1,i=c|1&i}}return er(i)||o}function er(n){return 0==(1&n)}function KO(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function eF(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Iw(n,e,t=!1){for(let i=0;i<e.length;i++)if(ZO(n,e[i],t))return!0;return!1}function Rw(n,e){return n?":not("+e.trim()+")":e}function nF(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!er(o)&&(e+=Rw(s,r),r=""),i=o,s=s||!er(i);t++}return""!==r&&(e+=Rw(s,r)),e}function Ts(n){return $r(()=>{const e=Nw(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Jd.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Qi.Emulated,styles:n.styles||yt,_:null,schemas:n.schemas||null,tView:null,id:""};Lw(t);const i=n.dependencies;return t.directiveDefs=Qd(i,!1),t.pipeDefs=Qd(i,!0),t.id=function cF(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function sF(n){return at(n)||En(n)}function oF(n){return null!==n}function qr(n){return $r(()=>({type:n.type,bootstrap:n.bootstrap||yt,declarations:n.declarations||yt,imports:n.imports||yt,exports:n.exports||yt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Pw(n,e){if(null==n)return Mr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Kn(n){return $r(()=>{const e=Nw(n);return Lw(e),e})}function Jn(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function at(n){return n[Dl]||null}function En(n){return n[hg]||null}function Un(n){return n[fg]||null}function Hn(n,e){const t=n[mw]||null;if(!t&&!0===e)throw new Error(`Type ${mn(n)} does not have '\u0275mod' property.`);return t}function Nw(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Mr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||yt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Pw(n.inputs,e),outputs:Pw(n.outputs),debugInfo:null}}function Lw(n){n.features?.forEach(e=>e(n))}function Qd(n,e){if(!n)return null;const t=e?Un:sF;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(oF)}const Zt=0,ne=1,Pe=2,jt=3,tr=4,zn=5,nr=6,_a=7,Ot=8,Qn=9,xa=10,$e=11,Ll=12,Ow=13,Ma=14,$t=15,Ol=16,wa=17,wr=18,Fl=19,Fw=20,As=21,eh=22,ho=23,qe=25,Eg=1,Sr=7,Sa=9,on=10;var Ea=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n[n.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",n}(Ea||{});function kn(n){return Array.isArray(n)&&"object"==typeof n[Eg]}function Rn(n){return Array.isArray(n)&&!0===n[Eg]}function bg(n){return 0!=(4&n.flags)}function fo(n){return n.componentOffset>-1}function nh(n){return 1==(1&n.flags)}function ir(n){return!!n.template}function Tg(n){return 0!=(512&n[Pe])}function po(n,e){return n.hasOwnProperty(jr)?n[jr]:null}class hF{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function mo(){return Vw}function Vw(n){return n.type.prototype.ngOnChanges&&(n.setInput=pF),fF}function fF(){const n=zw(this),e=n?.current;if(e){const t=n.previous;if(t===Mr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function pF(n,e,t,i){const r=this.declaredInputs[t],s=zw(n)||function mF(n,e){return n[Hw]=e}(n,{previous:Mr,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new hF(c&&c.currentValue,e,a===Mr),n[i]=e}mo.ngInherit=!0;const Hw="__ngSimpleChanges__";function zw(n){return n[Hw]||null}const Er=function(n,e,t){};function Ft(n){for(;Array.isArray(n);)n=n[Zt];return n}function ei(n,e){return Ft(e[n.index])}function Bl(n,e){return n.data[e]}function Ti(n,e){const t=e[n];return kn(t)?t:t[Zt]}function Rg(n){return 128==(128&n[Pe])}function br(n,e){return null==e?null:n[e]}function jw(n){n[wa]=0}function xF(n){1024&n[Pe]||(n[Pe]|=1024,Rg(n)&&ih(n))}function qw(n){return 9216&n[Pe]||n[ho]?.dirty}function Xw(n){qw(n)&&ih(n)}function ih(n){let e=n[jt];for(;null!==e&&!(Rn(e)&&e[Pe]&Ea.HasChildViewsToRefresh||kn(e)&&8192&e[Pe]);){if(Rn(e))e[Pe]|=Ea.HasChildViewsToRefresh;else if(e[Pe]|=8192,!Rg(e))break;e=e[jt]}}function rh(n,e){if(256==(256&n[Pe]))throw new te(911,!1);null===n[As]&&(n[As]=[]),n[As].push(e)}const He={lFrame:rS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Zw(){return He.bindingsEnabled}function z(){return He.lFrame.lView}function pt(){return He.lFrame.tView}function At(){let n=Kw();for(;null!==n&&64===n.type;)n=n.parent;return n}function Kw(){return He.lFrame.currentTNode}function Tr(n,e){const t=He.lFrame;t.currentTNode=n,t.isParent=e}function Ng(){return He.lFrame.isParent}function Cr(){return He.lFrame.bindingIndex++}function NF(n,e){const t=He.lFrame;t.bindingIndex=t.bindingRootIndex=n,Og(e)}function Og(n){He.lFrame.currentDirectiveIndex=n}function tS(){return He.lFrame.currentQueryIndex}function Ug(n){He.lFrame.currentQueryIndex=n}function OF(n){const e=n[ne];return 2===e.type?e.declTNode:1===e.type?n[zn]:null}function nS(n,e,t){if(t&dt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&dt.Host||(r=OF(s),null===r||(s=s[Ma],10&r.type))););if(null===r)return!1;e=r,n=s}const i=He.lFrame=iS();return i.currentTNode=e,i.lView=n,!0}function kg(n){const e=iS(),t=n[ne];He.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function iS(){const n=He.lFrame,e=null===n?null:n.child;return null===e?rS(n):e}function rS(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function sS(){const n=He.lFrame;return He.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const oS=sS;function Bg(){const n=sS();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Gn(){return He.lFrame.selectedIndex}function go(n){He.lFrame.selectedIndex=n}let cS=!0;function sh(){return cS}function Ds(n){cS=n}function oh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function ah(n,e,t){lS(n,e,3,t)}function ch(n,e,t,i){(3&n[Pe])===t&&lS(n,e,t,i)}function Vg(n,e){let t=n[Pe];(3&t)===e&&(t&=16383,t+=1,n[Pe]=t)}function lS(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[wa]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[wa]+=65536),(a<s||-1==s)&&(zF(n,t,e,c),n[wa]=(4294901760&n[wa])+c+2),c++}function uS(n,e){Er(4,n,e);const t=Xt(null);try{e.call(n)}finally{Xt(t),Er(5,n,e)}}function zF(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Pe]>>14<n[wa]>>16&&(3&n[Pe])===e&&(n[Pe]+=16384,uS(a,s)):uS(a,s)}const Ca=-1;class Hl{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function zg(n){return n!==Ca}function zl(n){return 32767&n}function Gl(n,e){let t=function qF(n){return n>>16}(n),i=e;for(;t>0;)i=i[Ma],t--;return i}let Gg=!0;function lh(n){const e=Gg;return Gg=n,e}const dS=255,hS=5;let XF=0;const Ar={};function uh(n,e){const t=fS(n,e);if(-1!==t)return t;const i=e[ne];i.firstCreatePass&&(n.injectorIndex=e.length,Wg(i.data,n),Wg(e,null),Wg(i.blueprint,null));const r=dh(n,e),s=n.injectorIndex;if(zg(r)){const o=zl(r),a=Gl(r,e),c=a[ne].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function Wg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function fS(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function dh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=xS(r),null===i)return Ca;if(t++,r=r[Ma],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Ca}function jg(n,e,t){!function YF(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Il)&&(i=t[Il]),null==i&&(i=t[Il]=XF++);const r=i&dS;e.data[n+(r>>hS)]|=1<<r}(n,e,t)}function pS(n,e,t){if(t&dt.Optional||void 0!==n)return n;pg()}function mS(n,e,t,i){if(t&dt.Optional&&void 0===i&&(i=null),!(t&(dt.Self|dt.Host))){const r=n[Qn],s=fi(void 0);try{return r?r.get(e,i,t&dt.Optional):xw(e,i,t&dt.Optional)}finally{fi(s)}}return pS(i,0,t)}function gS(n,e,t,i=dt.Default,r){if(null!==n){if(2048&e[Pe]&&!(i&dt.Self)){const o=function e2(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Pe]&&!(512&o[Pe]);){const a=vS(s,o,t,i|dt.Self,Ar);if(a!==Ar)return a;let c=s.parent;if(!c){const l=o[Fw];if(l){const u=l.get(t,Ar,i);if(u!==Ar)return u}c=xS(o),o=o[Ma]}s=c}return r}(n,e,t,i,Ar);if(o!==Ar)return o}const s=vS(n,e,t,i,Ar);if(s!==Ar)return s}return mS(e,t,i,r)}function vS(n,e,t,i,r){const s=function JF(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Il)?n[Il]:void 0;return"number"==typeof e?e>=0?e&dS:QF:e}(t);if("function"==typeof s){if(!nS(e,n,i))return i&dt.Host?pS(r,0,i):mS(e,t,i,r);try{let o;if(o=s(i),null!=o||i&dt.Optional)return o;pg()}finally{oS()}}else if("number"==typeof s){let o=null,a=fS(n,e),c=Ca,l=i&dt.Host?e[$t][zn]:null;for((-1===a||i&dt.SkipSelf)&&(c=-1===a?dh(n,e):e[a+8],c!==Ca&&_S(i,!1)?(o=e[ne],a=zl(c),e=Gl(c,e)):a=-1);-1!==a;){const u=e[ne];if(yS(s,a,u.data)){const d=KF(a,e,t,o,i,l);if(d!==Ar)return d}c=e[a+8],c!==Ca&&_S(i,e[ne].data[a+8]===l)&&yS(s,a,e)?(o=u,a=zl(c),e=Gl(c,e)):a=-1}}return r}function KF(n,e,t,i,r,s){const o=e[ne],a=o.data[n+8],u=hh(a,o,t,null==i?fo(a)&&Gg:i!=o&&0!=(3&a.type),r&dt.Host&&s===a);return null!==u?vo(e,o,u,a):Ar}function hh(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&ir(f)&&f.type===t)return c}return null}function vo(n,e,t,i){let r=n[t];const s=e.data;if(function GF(n){return n instanceof Hl}(r)){const o=r;o.resolving&&function RO(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,`Circular dependency in DI detected for ${n}${t}`)}(function _t(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():je(n)}(s[t]));const a=lh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?fi(o.injectImpl):null;nS(n,i,dt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function HF(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Vw(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&fi(l),lh(a),o.resolving=!1,oS()}}return r}function yS(n,e,t){return!!(t[e+(n>>hS)]&1<<n)}function _S(n,e){return!(n&dt.Self||n&dt.Host&&e)}class bn{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return gS(this._tNode,this._lView,e,Kd(i),t)}}function QF(){return new bn(At(),z())}function Ia(n){return $r(()=>{const e=n.prototype.constructor,t=e[jr]||$g(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[jr]||$g(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function $g(n){return $d(n)?()=>{const e=$g(ke(n));return e&&e()}:po(n)}function xS(n){const e=n[ne],t=e.type;return 2===t?e.declTNode:1===t?n[zn]:null}const Pa="__parameters__";function La(n,e,t){return $r(()=>{const i=function qg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const d=c.hasOwnProperty(Pa)?c[Pa]:Object.defineProperty(c,Pa,{value:[]})[Pa];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Fa(n,e){n.forEach(t=>Array.isArray(t)?Fa(t,e):e(t))}function wS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ph(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const gh=Pl(La("Optional"),8),vh=Pl(La("SkipSelf"),4),Ba=new ve("ENVIRONMENT_INITIALIZER"),AS=new ve("INJECTOR",-1),Jg=new ve("INJECTOR_DEF_TYPES");class _h{get(e,t=Rl){if(t===Rl){const i=new Error(`NullInjectorError: No provider for ${mn(e)}!`);throw i.name="NullInjectorError",i}return t}}function w2(...n){return{\u0275providers:DS(0,n),\u0275fromNgModule:!0}}function DS(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Fa(e,o=>{const a=o;xh(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&IS(r,s),t}function IS(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];ev(r,s=>{e(s,i)})}}function xh(n,e,t,i){if(!(n=ke(n)))return!1;let r=null,s=Xd(n);const o=!s&&at(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=Xd(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)xh(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{Fa(s.imports,u=>{xh(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&IS(l,e)}if(!a){const l=po(r)||(()=>new r);e({provide:r,useFactory:l,deps:yt},r),e({provide:Jg,useValue:r,multi:!0},r),e({provide:Ba,useValue:()=>Me(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=n;ev(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function ev(n,e){for(let t of n)dg(t)&&(t=t.\u0275providers),Array.isArray(t)?ev(t,e):e(t)}const S2=Tt({provide:String,useValue:Tt});function tv(n){return null!==n&&"object"==typeof n&&S2 in n}function yo(n){return"function"==typeof n}const nv=new ve("Set Injector scope."),Mh={},b2={};let iv;function wh(){return void 0===iv&&(iv=new _h),iv}class Ai{}class Va extends Ai{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sv(e,o=>this.processProvider(o)),this.records.set(AS,Ha(void 0,this)),r.has("environment")&&this.records.set(Ai,Ha(void 0,this));const s=this.records.get(nv);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Jg,yt,dt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=bs(this),i=fi(void 0);try{return e()}finally{bs(t),fi(i)}}get(e,t=Rl,i=dt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(gw))return e[gw](this);i=Kd(i);const s=bs(this),o=fi(void 0);try{if(!(i&dt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function I2(n){return"function"==typeof n||"object"==typeof n&&n instanceof ve}(e)&&qd(e);c=l&&this.injectableDefInScope(l)?Ha(rv(e),Mh):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&dt.Self?wh():this.parent).get(e,t=i&dt.Optional&&t===Rl?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Zd]=a[Zd]||[]).unshift(mn(e)),s)throw a;return function $O(n,e,t,i){const r=n[Zd];throw e[ww]&&r.unshift(e[ww]),n.message=function qO(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=mn(e);if(Array.isArray(e))r=e.map(mn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):mn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(HO,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Zd]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{fi(o),bs(s)}}resolveInjectorInitializers(){const e=bs(this),t=fi(void 0);try{const r=this.get(Ba,yt,dt.Self);for(const s of r)s()}finally{bs(e),fi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(mn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){let t=yo(e=ke(e))?e:ke(e&&e.provide);const i=function C2(n){return tv(n)?Ha(void 0,n.useValue):Ha(function NS(n,e,t){let i;if(yo(n)){const r=ke(n);return po(r)||rv(r)}if(tv(n))i=()=>ke(n.useValue);else if(function PS(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...wg(n.deps||[]));else if(function RS(n){return!(!n||!n.useExisting)}(n))i=()=>Me(ke(n.useExisting));else{const r=ke(n&&(n.useClass||n.provide));if(!function A2(n){return!!n.deps}(n))return po(r)||rv(r);i=()=>new r(...wg(n.deps))}return i}(n),Mh)}(e);if(yo(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Ha(void 0,Mh,!0),r.factory=()=>wg(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Mh&&(t.value=b2,t.value=t.factory()),"object"==typeof t.value&&t.value&&function D2(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ke(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function rv(n){const e=qd(n),t=null!==e?e.factory:po(n);if(null!==t)return t;if(n instanceof ve)throw new te(204,!1);if(n instanceof Function)return function T2(n){const e=n.length;if(e>0)throw function jl(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new te(204,!1);const t=function UO(n){return n&&(n[Yd]||n[yw])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new te(204,!1)}function Ha(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function sv(n,e){for(const t of n)Array.isArray(t)?sv(t,e):t&&dg(t)?sv(t.\u0275providers,e):e(t)}function Is(n,e){n instanceof Va&&n.assertNotDestroyed();const i=bs(n),r=fi(void 0);try{return e()}finally{bs(i),fi(r)}}function US(n,e=null,t=null,i){const r=kS(n,e,t,i);return r.resolveInjectorInitializers(),r}function kS(n,e=null,t=null,i,r=new Set){const s=[t||yt,w2(n)];return i=i||("object"==typeof n?void 0:mn(n)),new Va(s,e||wh(),i||null,r)}let cv,Di=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Rl;static#t=this.NULL=new _h;static create(t,i){if(Array.isArray(t))return US({name:""},i,t,"");{const r=t.name??"";return US({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=Se({token:n,providedIn:"any",factory:()=>Me(AS)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();const Eh=new ve("AppId",{providedIn:"root",factory:()=>B2}),B2="ng",VS=new ve("Platform Initializer"),_o=new ve("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),HS=new ve("CSP nonce",{providedIn:"root",factory:()=>function Ps(){if(void 0!==cv)return cv;if(typeof document<"u")return document;throw new te(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function Ii(n){return n instanceof Function?n():n}function Ah(n){return 128==(128&n.flags)}var Os=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Os||{});const fv=new Map;let J2=0;const mv="__ngContext__";function Wn(n,e){kn(e)?(n[mv]=e[Fl],function eU(n){fv.set(n[Fl],n)}(e)):n[mv]=e}let gv;function vv(n,e){return gv(n,e)}function Kl(n){const e=n[jt];return Rn(e)?e[jt]:e}function sE(n){return aE(n[Ll])}function oE(n){return aE(n[tr])}function aE(n){for(;null!==n&&!Rn(n);)n=n[tr];return n}function Ga(n,e,t,i,r){if(null!=i){let s,o=!1;Rn(i)?s=i:kn(i)&&(o=!0,i=i[Zt]);const a=Ft(i);0===n&&null!==t?null==r?dE(e,t,a):xo(e,t,a,r||null,!0):1===n&&null!==t?xo(e,t,a,r||null,!0):2===n?function Oh(n,e,t){const i=Nh(n,e);i&&function _U(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function wU(n,e,t,i,r){const s=t[Sr];s!==Ft(t)&&Ga(e,n,i,s,r);for(let a=on;a<t.length;a++){const c=t[a];eu(c[ne],c,n,e,i,s)}}(e,n,s,t,r)}}function Rh(n,e,t){return n.createElement(e,t)}function lE(n,e){const t=n[Sa],i=t.indexOf(e);t.splice(i,1)}function Jl(n,e){if(n.length<=on)return;const t=on+e,i=n[t];if(i){const r=i[Ol];null!==r&&r!==n&&lE(r,i),e>0&&(n[t-1][tr]=i[tr]);const s=ph(n,on+e);!function dU(n,e){eu(n,e,e[$e],2,null,null),e[Zt]=null,e[zn]=null}(i[ne],i);const o=s[wr];null!==o&&o.detachView(s[ne]),i[jt]=null,i[tr]=null,i[Pe]&=-129}return i}function Ph(n,e){if(!(256&e[Pe])){const t=e[$e];t.destroyNode&&eu(n,e,t,3,null,null),function pU(n){let e=n[Ll];if(!e)return _v(n[ne],n);for(;e;){let t=null;if(kn(e))t=e[Ll];else{const i=e[on];i&&(t=i)}if(!t){for(;e&&!e[tr]&&e!==n;)kn(e)&&_v(e[ne],e),e=e[jt];null===e&&(e=n),kn(e)&&_v(e[ne],e),t=e&&e[tr]}e=t}}(e)}}function _v(n,e){if(!(256&e[Pe])){e[Pe]&=-129,e[Pe]|=256,e[ho]&&function OM(n){if(ma(n),Tl(n))for(let e=0;e<n.producerNode.length;e++)Hd(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(e[ho]),function yU(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Hl)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Er(4,a,c);try{c.call(a)}finally{Er(5,a,c)}}else{Er(4,r,s);try{s.call(r)}finally{Er(5,r,s)}}}}}(n,e),function vU(n,e){const t=n.cleanup,i=e[_a];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[_a]=null);const r=e[As];if(null!==r){e[As]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[ne].type&&e[$e].destroy();const t=e[Ol];if(null!==t&&Rn(e[jt])){t!==e[jt]&&lE(t,e);const i=e[wr];null!==i&&i.detachView(n)}!function tU(n){fv.delete(n[Fl])}(e)}}function xv(n,e,t){return function uE(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Zt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Qi.None||s===Qi.Emulated)return null}return ei(i,t)}}(n,e.parent,t)}function xo(n,e,t,i,r){n.insertBefore(e,t,i,r)}function dE(n,e,t){n.appendChild(e,t)}function hE(n,e,t,i,r){null!==i?xo(n,e,t,i,r):dE(n,e,t)}function Nh(n,e){return n.parentNode(e)}let Mv,mE=function pE(n,e,t){return 40&n.type?ei(n,t):null};function Lh(n,e,t,i){const r=xv(n,i,e),s=e[$e],a=function fE(n,e,t){return mE(n,e,t)}(i.parent||e[zn],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)hE(s,r,t[c],a,!1);else hE(s,r,t,a,!1);void 0!==Mv&&Mv(s,i,e,t,r)}function Ql(n,e){if(null!==e){const t=e.type;if(3&t)return ei(e,n);if(4&t)return wv(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Ql(n,i);{const r=n[e.index];return Rn(r)?wv(-1,r):Ft(r)}}if(32&t)return vv(e,n)()||Ft(n[e.index]);{const i=vE(n,e);return null!==i?Array.isArray(i)?i[0]:Ql(Kl(n[$t]),i):Ql(n,e.next)}}return null}function vE(n,e){return null!==e?n[$t][zn].projection[e.projection]:null}function wv(n,e){const t=on+n+1;if(t<e.length){const i=e[t],r=i[ne].firstChild;if(null!==r)return Ql(i,r)}return e[Sr]}function Sv(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],c=t.type;if(o&&0===e&&(a&&Wn(Ft(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)Sv(n,e,t.child,i,r,s,!1),Ga(e,n,r,a,s);else if(32&c){const l=vv(t,i);let u;for(;u=l();)Ga(e,n,r,u,s);Ga(e,n,r,a,s)}else 16&c?_E(n,e,i,t,r,s):Ga(e,n,r,a,s);t=o?t.projectionNext:t.next}}function eu(n,e,t,i,r,s){Sv(t,i,n.firstChild,e,r,s,!1)}function _E(n,e,t,i,r,s){const o=t[$t],c=o[zn].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Ga(e,n,r,c[l],s);else{let l=c;const u=o[jt];Ah(i)&&(l.flags|=128),Sv(n,e,l,u,r,s,!0)}}function xE(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function ME(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Sg(n,e,i),null!==r&&xE(n,e,r),null!==s&&function EU(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}let OE=(n,e,t)=>null;function Uv(n,e,t=!1){return OE(n,e,t)}class rk{}class kE{}class ok{resolveComponentFactory(e){throw function sk(n){const e=Error(`No component factory found for ${mn(n)}.`);return e.ngComponent=n,e}(e)}}let Wh=(()=>{class n{static#e=this.NULL=new ok}return n})();function ak(){return Xa(At(),z())}function Xa(n,e){return new Us(ei(n,e))}let Us=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=ak}return n})();function ck(n){return n instanceof Us?n.nativeElement:n}class VE{}let uk=(()=>{class n{static#e=this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>null})}return n})();class $h{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const dk=new $h("17.0.7"),Vv={};function au(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Ft(s)),Rn(s)&&XE(s,i);const o=t.type;if(8&o)au(n,e,t.child,i);else if(32&o){const a=vv(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=vE(e,t);if(Array.isArray(a))i.push(...a);else{const c=Kl(e[$t]);au(c[ne],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function XE(n,e){for(let t=on;t<n.length;t++){const i=n[t],r=i[ne].firstChild;null!==r&&au(i[ne],i,r,e)}n[Sr]!==n[Zt]&&e.push(n[Sr])}let YE=[];const bk={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{ih(n.lView)},consumerOnSignalRead(){this.lView[ho]=this}};function zv(n){return n.ngOriginalError}class Kr{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&zv(e);for(;t&&zv(t);)t=zv(t);return t||null}}const KE=new ve("",{providedIn:"root",factory:()=>se(Kr).handleError.bind(void 0)}),QE=new ve("",{providedIn:"root",factory:()=>!1}),Ke={};function jn(n){ib(pt(),z(),Gn()+n,!1)}function ib(n,e,t,i){if(!i)if(3==(3&e[Pe])){const s=n.preOrderCheckHooks;null!==s&&ah(e,s,t)}else{const s=n.preOrderHooks;null!==s&&ch(e,s,0,t)}go(t)}function Oe(n,e=dt.Default){const t=z();return null===t?Me(n,e):gS(At(),t,ke(n),e)}function Zh(n,e,t,i,r,s,o,a,c,l,u){const d=e.blueprint.slice();return d[Zt]=r,d[Pe]=140|i,(null!==l||n&&2048&n[Pe])&&(d[Pe]|=2048),jw(d),d[jt]=d[Ma]=n,d[Ot]=t,d[xa]=o||n&&n[xa],d[$e]=a||n&&n[$e],d[Qn]=c||n&&n[Qn]||null,d[zn]=s,d[Fl]=function Q2(){return J2++}(),d[nr]=u,d[Fw]=l,d[$t]=2==e.type?n[$t]:d,d}function Ya(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Gv(n,e,t,i,r){const s=Kw(),o=Ng(),c=n.data[e]=function kk(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function Ta(){return null!==He.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function PF(){return He.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Vl(){const n=He.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Tr(s,!0),s}function cu(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function sb(n,e,t,i,r){const s=Gn(),o=2&i;try{go(-1),o&&e.length>qe&&ib(n,e,qe,!1),Er(o?2:0,r),t(i,r)}finally{go(s),Er(o?3:1,r)}}function Wv(n,e,t){if(bg(e)){const i=Xt(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Xt(i)}}}function ob(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=qv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function qv(n,e,t,i,r,s,o,a,c,l,u){const d=qe+i,h=d+r,f=function Pk(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ke);return t}(d,h),p="function"==typeof l?l():l;return f[ne]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let ab=n=>null;function cb(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?lb(t,e,r,s):i.hasOwnProperty(r)&&lb(t,e,i[r],s)}return t}function lb(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function ub(n,e,t,i,r,s){for(let l=0;l<i.length;l++)jg(uh(t,e),n,i[l].type);!function Zk(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=cu(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=Nl(t.mergedAttrs,u.hostAttrs),Kk(n,t,e,c,u),Yk(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function Bk(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;c=cb(d.inputs,u,c,h?h.inputs:null),l=cb(d.outputs,u,l,p);const v=null===c||null===o||Dw(e)?null:e3(c,u,o);a.push(v)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function db(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function LF(){return He.lFrame.currentDirectiveIndex}();try{go(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];Og(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&$k(c,l)}}finally{go(-1),Og(o)}}function $k(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Yv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Yk(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ir(e)&&(t[""]=n)}}function Kk(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=po(r.type)),o=new Hl(s,ir(r),Oe);n.blueprint[i]=o,t[i]=o,function Gk(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function Wk(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,cu(n,t,r.hostVars,Ke),r)}function Qk(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)hb(i,t,o[a++],o[a++],o[a++])}function hb(n,e,t,i,r){const s=Xt(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{Xt(s)}}function e3(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function pb(n,e){const t=n.contentQueries;if(null!==t){const i=Xt(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const a=n.data[o];Ug(t[r]),a.contentQueries(2,e[o],o)}}}finally{Xt(i)}}}function Kh(n,e){return n[Ll]?n[Ow][tr]=e:n[Ll]=e,n[Ow]=e,e}function Kv(n,e,t){Ug(0);const i=Xt(null);try{e(n,t)}finally{Xt(i)}}function mb(n){return n[_a]||(n[_a]=[])}function gb(n){return n.cleanup||(n.cleanup=[])}function Jh(n,e){const t=n[Qn],i=t?t.get(Kr,null):null;i&&i.handleError(e)}function Jv(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];hb(n.data[o],e[o],i,a,r)}}function Jr(n,e,t){const i=function kl(n,e){return Ft(e[n])}(e,n);!function cE(n,e,t){n.setValue(e,t)}(n[$e],i,t)}function i3(n,e,t,i){const r=e[Pe];if(256==(256&r))return;e[xa].inlineEffectRunner?.flush(),kg(e);let o=null,a=null;(function r3(n){return 2!==n.type})(n)&&(a=function wk(n){return n[ho]??function Sk(n){const e=YE.pop()??Object.create(bk);return e.lView=n,e}(n)}(e),o=function NM(n){return n&&(n.nextProducerIndex=0),Xt(n)}(a));try{jw(e),function Qw(n){return He.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&sb(n,e,t,2,i);const c=3==(3&r);if(c){const d=n.preOrderCheckHooks;null!==d&&ah(e,d,null)}else{const d=n.preOrderHooks;null!==d&&ch(e,d,0,null),Vg(e,0)}if(function s3(n){for(let e=sE(n);null!==e;e=oE(e)){if(!(e[Pe]&Ea.HasTransplantedViews))continue;const t=e[Sa];for(let i=0;i<t.length;i++){xF(t[i])}}}(e),yb(e,0),null!==n.contentQueries&&pb(n,e),c){const d=n.contentCheckHooks;null!==d&&ah(e,d)}else{const d=n.contentHooks;null!==d&&ch(e,d,1),Vg(e,1)}!function Rk(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)go(~r);else{const s=r,o=t[++i],a=t[++i];NF(o,s),a(2,e[s])}}}finally{go(-1)}}(n,e);const l=n.components;null!==l&&xb(e,l,0);const u=n.viewQuery;if(null!==u&&Kv(2,u,i),c){const d=n.viewCheckHooks;null!==d&&ah(e,d)}else{const d=n.viewHooks;null!==d&&ch(e,d,2),Vg(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[eh]){for(const d of e[eh])d();e[eh]=null}e[Pe]&=-73}catch(c){throw ih(e),c}finally{null!==a&&(function LM(n,e){if(Xt(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Tl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Hd(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}(a,o),function Ek(n){n.lView[ho]!==n&&(n.lView=null,YE.push(n))}(a)),Bg()}}function yb(n,e){for(let t=sE(n);null!==t;t=oE(t)){t[Pe]&=~Ea.HasChildViewsToRefresh;for(let i=on;i<t.length;i++)_b(t[i],e)}}function o3(n,e,t){_b(Ti(e,n),t)}function _b(n,e){Rg(n)&&ey(n,e)}function ey(n,e){const i=n[ne],r=n[Pe],s=n[ho];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!jm(s)),s&&(s.dirty=!1),n[Pe]&=-9217,o)i3(i,n,i.template,n[Ot]);else if(8192&r){yb(n,1);const a=i.components;null!==a&&xb(n,a,1)}}function xb(n,e,t){for(let i=0;i<e.length;i++)o3(n,e[i],t)}function lu(n){for(;n;){n[Pe]|=64;const e=Kl(n);if(Tg(n)&&!e)return n;n=e}return null}class uu{get rootNodes(){const e=this._lView,t=e[ne];return au(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ot]}set context(e){this._lView[Ot]=e}get destroyed(){return 256==(256&this._lView[Pe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[jt];if(Rn(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Jl(e,i),ph(t,i))}this._attachedToViewContainer=!1}Ph(this._lView[ne],this._lView)}onDestroy(e){rh(this._lView,e)}markForCheck(){lu(this._cdRefInjectingView||this._lView)}detach(){this._lView[Pe]&=-129}reattach(){Xw(this._lView),this._lView[Pe]|=128}detectChanges(){this._lView[Pe]|=1024,function Qv(n,e=!0){const t=n[xa],i=t.rendererFactory,r=t.afterRenderEventManager;i.begin?.(),r?.begin();try{!function n3(n){ey(n,0);let e=0;for(;qw(n);){if(100===e)throw new te(103,!1);e++,ey(n,1)}}(n)}catch(o){throw e&&Jh(n,o),o}finally{i.end?.(),t.inlineEffectRunner?.flush(),r?.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fU(n,e){eu(n,e,e[$e],2,null,null)}(this._lView[ne],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e}}let du=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=a3}return n})();function a3(n){return function c3(n,e,t){if(fo(n)&&!t){const i=Ti(n.index,e);return new uu(i,i)}return 47&n.type?new uu(e[$t],e):null}(At(),z(),16==(16&n))}let Qh=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=h3;static#t=this.__NG_ENV_ID__=t=>t}return n})();class d3 extends Qh{constructor(e){super(),this._lView=e}onDestroy(e){return rh(this._lView,e),()=>function Pg(n,e){if(null===n[As])return;const t=n[As].indexOf(e);-1!==t&&n[As].splice(t,1)}(this._lView,e)}}function h3(){return new d3(z())}const Mb=new Set;function Mo(n){Mb.has(n)||(Mb.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function ty(n){return e=>{setTimeout(n,void 0,e)}}const an=class _3 extends Bi{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=ty(s),r&&(r=ty(r)),o&&(o=ty(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Ei&&e.add(a),a}};function wb(...n){}class Et{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new an(!1),this.onMicrotaskEmpty=new an(!1),this.onStable=new an(!1),this.onError=new an(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function x3(){const n="function"==typeof Lt.requestAnimationFrame;let e=Lt[n?"requestAnimationFrame":"setTimeout"],t=Lt[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function S3(n){const e=()=>{!function w3(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Lt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,iy(n),n.isCheckStableRunning=!0,ny(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),iy(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function b3(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return Sb(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),Eb(n)}},onInvoke:(t,i,r,s,o,a,c)=>{try{return Sb(n),t.invoke(r,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),Eb(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,iy(n),ny(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Et.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(Et.isInAngularZone())throw new te(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,M3,wb,wb);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const M3={};function ny(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function iy(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Sb(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Eb(n){n._nesting--,ny(n)}class E3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new an,this.onMicrotaskEmpty=new an,this.onStable=new an,this.onError=new an}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const bb=new ve("",{providedIn:"root",factory:Tb});function Tb(){const n=se(Et);let e=!0;return function TO(...n){const e=Al(n),t=function _O(n,e){return"number"==typeof ag(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Vi(i[0]):ga(t)(Sn(i,e)):_r}(new Yt(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Yt(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Et.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(fw()))}var wo=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(wo||{});const Cb={destroy(){}};function Db(n,e){!e&&function ov(n){if(!_w()&&!function GO(){return ya}())throw new te(-203,!1)}();const t=e?.injector??se(Di);if(!function Ns(n){return"browser"===(n??se(Di)).get(_o)}(t))return Cb;Mo("NgAfterNextRender");const i=t.get(ef),r=i.handler??=new Rb,s=e?.phase??wo.MixedReadWrite,o=()=>{r.unregister(c),a()},a=t.get(Qh).onDestroy(o),c=new Ib(t,s,()=>{o(),n()});return r.register(c),{destroy:o}}class Ib{constructor(e,t,i){this.phase=t,this.callbackFn=i,this.zone=e.get(Et),this.errorHandler=e.get(Kr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class Rb{constructor(){this.executingCallbacks=!1,this.buckets={[wo.EarlyRead]:new Set,[wo.Write]:new Set,[wo.MixedReadWrite]:new Set,[wo.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new te(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let ef=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const t of this.internalCallbacks)t();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>new n})}return n})();function A3(n,e){const t=Ti(e,n),i=t[ne];!function D3(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Zt];null!==r&&null===t[nr]&&(t[nr]=Uv(r,t[Qn])),ry(i,t,t[Ot])}function ry(n,e,t){kg(e);try{const i=n.viewQuery;null!==i&&Kv(1,i,t);const r=n.template;null!==r&&sb(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&pb(n,e),n.staticViewQueries&&Kv(2,n.viewQuery,t);const s=n.components;null!==s&&function I3(n,e){for(let t=0;t<e.length;t++)A3(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Pe]&=-5,Bg()}}function tf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=lg(r,a):2==s&&(i=lg(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class Pb extends Wh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=at(e);return new hu(t,this.ngModule)}}function Nb(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class P3{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Kd(i);const r=this.injector.get(e,Vv,i);return r!==Vv||t===Vv?r:this.parentInjector.get(e,t,i)}}class hu extends kE{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=Nb(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return Nb(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function iF(n){return n.map(nF).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Ai?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new P3(e,s):e,a=o.get(VE,null);if(null===a)throw new te(407,!1);const u={rendererFactory:a,sanitizer:o.get(uk,null),inlineEffectRunner:null,afterRenderEventManager:o.get(ef,null)},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",f=i?function Nk(n,e,t,i){const s=i.get(QE,!1)||t===Qi.ShadowDom,o=n.selectRootElement(e,s);return function Lk(n){ab(n)}(o),o}(d,i,this.componentDef.encapsulation,o):Rh(d,h,function R3(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(h)),g=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let m=null;null!==f&&(m=Uv(f,o,!0));const _=qv(0,null,null,1,0,null,null,null,null,null,null),y=Zh(null,_,null,g,null,null,u,d,o,null,m);let x,M;kg(y);try{const S=this.componentDef;let b,I=null;S.findHostDirectiveDefs?(b=[],I=new Map,S.findHostDirectiveDefs(S,b,I),b.push(S)):b=[S];const w=function L3(n,e){const t=n[ne],i=qe;return n[i]=e,Ya(t,i,2,"#host",null)}(y,f),T=function O3(n,e,t,i,r,s,o){const a=r[ne];!function F3(n,e,t,i){for(const r of n)e.mergedAttrs=Nl(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(tf(e,e.mergedAttrs,!0),null!==t&&ME(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=Uv(e,r[Qn]));const l=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=Zh(r,ob(t),null,u,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Yv(a,n,i.length-1),Kh(r,d),r[n.index]=d}(w,f,S,b,y,u,d);M=Bl(_,qe),f&&function k3(n,e,t,i){if(i)Sg(n,t,["ng-version",dk.full]);else{const{attrs:r,classes:s}=function rF(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!er(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Sg(n,t,r),s&&s.length>0&&xE(n,t,s.join(" "))}}(d,S,f,i),void 0!==t&&function B3(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(M,this.ngContentSelectors,t),x=function U3(n,e,t,i,r,s){const o=At(),a=r[ne],c=ei(o,r);ub(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Wn(vo(r,a,o.directiveStart+u,o),r);db(a,r,o),c&&Wn(c,r);const l=vo(r,a,o.directiveStart+o.componentOffset,o);if(n[Ot]=r[Ot]=l,null!==s)for(const u of s)u(l,e);return Wv(a,o,n),l}(T,S,b,I,y,[V3]),ry(_,y,null)}finally{Bg()}return new N3(this.componentType,x,Xa(M,y),y,M)}}class N3 extends rk{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new uu(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;Jv(s[ne],s,r,e,t),this.previousInputValues.set(e,t),lu(Ti(this._tNode.index,s))}}get injector(){return new bn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function V3(){const n=At();oh(z()[ne],n)}function gn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function af(n,e,t){const i=z();return gn(i,Cr(),e)&&function Ri(n,e,t,i,r,s,o,a){const c=ei(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(Jv(n,t,u,i,r),fo(e)&&function Hk(n,e){const t=Ti(e,n);16&t[Pe]||(t[Pe]|=64)}(t,e.index)):3&e.type&&(i=function Vk(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}(pt(),function zt(){const n=He.lFrame;return Bl(n.tView,n.selectedIndex)}(),i,n,e,i[$e],t,!1),af}function ly(n,e,t,i,r){const o=r?"class":"style";Jv(n,t,e.inputs[o],o,i)}function ac(n,e){return!e||null===e.firstChild||Ah(n)}function xu(n,e,t,i=!0){const r=e[ne];if(function mU(n,e,t,i){const r=on+i,s=t.length;i>0&&(t[r-1][tr]=e),i<s-on?(e[tr]=t[r],wS(t,on+i,e)):(t.push(e),e[tr]=null),e[jt]=t;const o=e[Ol];null!==o&&t!==o&&function gU(n,e){const t=n[Sa];e[$t]!==e[jt][jt][$t]&&(n[Pe]|=Ea.HasTransplantedViews),null===t?n[Sa]=[e]:t.push(e)}(o,e);const a=e[wr];null!==a&&a.insertView(n),Xw(e),e[Pe]|=128}(r,e,n,t),i){const o=wv(t,n),a=e[$e],c=Nh(a,n[Sr]);null!==c&&function hU(n,e,t,i,r,s){i[Zt]=r,i[zn]=e,eu(n,i,t,1,r,s)}(r,n[zn],a,e,c,o)}const s=e[nr];null!==s&&null!==s.firstChild&&(s.firstChild=null)}let or=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=KB}return n})();function KB(){return wT(At(),z())}const JB=or,xT=class extends JB{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Xa(this._hostTNode,this._hostLView)}get injector(){return new bn(this._hostTNode,this._hostLView)}get parentInjector(){const e=dh(this._hostTNode,this._hostLView);if(zg(e)){const t=Gl(e,this._hostLView),i=zl(e);return new bn(t[ne].data[i+8],t)}return new bn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=MT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-on}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,ac(this._hostTNode,null)),a}createComponent(e,t,i,r,s){const o=e&&!function Wl(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new hu(at(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const v=(o?l:this.parentInjector).get(Ai,null);v&&(s=v)}at(c.componentType??{});const f=c.create(l,r,null,s);return this.insertImpl(f.hostView,a,ac(this._hostTNode,null)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function _F(n){return Rn(n[jt])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[jt],l=new xT(c,c[zn],c[jt]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return xu(o,r,s,i),e.attachToViewContainerRef(),wS(_y(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=MT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Jl(this._lContainer,t);i&&(ph(_y(this._lContainer),t),Ph(i[ne],i))}detach(e){const t=this._adjustIndex(e,-1),i=Jl(this._lContainer,t);return i&&null!=ph(_y(this._lContainer),t)?new uu(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function MT(n){return n[8]}function _y(n){return n[8]||(n[8]=[])}function wT(n,e){let t;const i=e[n.index];return Rn(i)?t=i:(t=function fb(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}(i,e,null,n),e[n.index]=t,Kh(e,t)),ST(t,e,n,i),new xT(t,n,e)}let ST=function bT(n,e,t,i){if(n[Sr])return;let r;r=8&t.type?Ft(i):function QB(n,e){const t=n[$e],i=t.createComment(""),r=ei(e,n);return xo(t,Nh(t,r),i,function xU(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Sr]=r};function Pt(n,e,t,i){const r=z(),s=pt(),o=qe+n,a=r[$e],c=s.firstCreatePass?function $V(n,e,t,i,r,s){const o=e.consts,c=Ya(e,n,2,i,br(o,r));return function Xv(n,e,t,i){if(Zw()){const r=null===i?null:{"":-1},s=function qk(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(Iw(e,o.selectors,!1))if(i||(i=[]),ir(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Yv(n,e,a.length)}else i.unshift(o),Yv(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&ub(n,e,t,o,r,a),r&&function Xk(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new te(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Nl(t.mergedAttrs,t.attrs)}(e,t,c,br(o,s)),null!==c.attrs&&tf(c,c.attrs,!1),null!==c.mergedAttrs&&tf(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=ZT(s,r,c,a,e,n);r[o]=l;const u=nh(c);return Tr(c,!0),ME(a,l,c),32!=(32&c.flags)&&sh()&&Lh(s,r,l,c),0===function MF(){return He.lFrame.elementDepthCount}()&&Wn(l,r),function wF(){He.lFrame.elementDepthCount++}(),u&&(function jv(n,e,t){Zw()&&(function jk(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;fo(t)&&function Jk(n,e,t){const i=ei(e,n),r=ob(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Kh(n,Zh(n,r,null,o,i,e,null,n[xa].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||uh(t,e),Wn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=vo(e,n,a,t);Wn(l,e),null!==o&&Qk(0,a-r,l,c,0,o),ir(c)&&(Ti(t.index,e)[Ot]=vo(e,n,a,t))}}(n,e,t,ei(t,e)),64==(64&t.flags)&&db(n,e,t))}(s,r,c),Wv(s,c,r)),null!==i&&function $v(n,e,t=ei){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}(r,c),Pt}function Ct(){let n=At();Ng()?function Lg(){He.lFrame.isParent=!1}():(n=n.parent,Tr(n,!1));const e=n;(function EF(n){return He.skipHydrationRootTNode===n})(e)&&function AF(){He.skipHydrationRootTNode=null}(),function SF(){He.lFrame.elementDepthCount--}();const t=pt();return t.firstCreatePass&&(oh(t,n),bg(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function jF(n){return 0!=(8&n.flags)}(e)&&ly(t,e,z(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function $F(n){return 0!=(16&n.flags)}(e)&&ly(t,e,z(),e.stylesWithoutHost,!1),Ct}function ln(n,e,t,i){return Pt(n,e,t,i),Ct(),ln}let ZT=(n,e,t,i,r,s)=>(Ds(!0),Rh(i,r,function aS(){return He.lFrame.currentNamespace}()));const mc="en-US";let iC=mc;function wf(n){return!!n&&"function"==typeof n.then}function AC(n){return!!n&&"function"==typeof n.subscribe}function Qr(n,e,t,i){const r=z(),s=pt(),o=At();return function IC(n,e,t,i,r,s,o){const a=nh(i),l=n.firstCreatePass&&gb(n),u=e[Ot],d=mb(e);let h=!0;if(3&i.type||o){const v=ei(i,e),g=o?o(v):v,m=d.length,_=o?x=>o(Ft(x[i.index])):i.index;let y=null;if(!o&&a&&(y=function YH(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[_a],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,h=!1;else{s=PC(i,e,u,s,!1);const x=t.listen(g,r,s);d.push(s,x),l&&l.push(r,_,m,m+1)}}else s=PC(i,e,u,s,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const v=p.length;if(v)for(let g=0;g<v;g+=2){const M=e[p[g]][p[g+1]].subscribe(s),S=d.length;d.push(s,M),l&&l.push(r,i.index,S,-(S+1))}}}(s,r,r[$e],o,n,e,i),Qr}function RC(n,e,t,i){try{return Er(6,e,t),!1!==t(i)}catch(r){return Jh(n,r),!1}finally{Er(7,e,t)}}function PC(n,e,t,i,r){return function s(o){if(o===Function)return i;lu(n.componentOffset>-1?Ti(n.index,e):e);let c=RC(e,t,i,o),l=s.__ngNextListenerFn__;for(;l;)c=RC(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&o.preventDefault(),c}}function Pn(n,e=""){const t=z(),i=pt(),r=n+qe,s=i.firstCreatePass?Ya(i,r,1,e,null):i.data[r],o=KC(i,t,s,e,n);t[r]=o,sh()&&Lh(i,t,o,s),Tr(s,!1)}let KC=(n,e,t,i,r)=>(Ds(!0),function Ih(n,e){return n.createText(e)}(e[$e],i));function Co(n){return ar("",n,""),Co}function ar(n,e,t){const i=z(),r=function Ka(n,e,t,i){return gn(n,Cr(),t)?e+je(t)+i:Ke}(i,n,e,t);return r!==Ke&&Jr(i,Gn(),r),ar}class Ao{}class aA{}class Vy extends Ao{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Pb(this);const r=Hn(e);this._bootstrapComponents=Ii(r.bootstrap),this._r3Injector=kS(e,t,[{provide:Ao,useValue:this},{provide:Wh,useValue:this.componentFactoryResolver},...i],mn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Hy extends aA{constructor(e){super(),this.moduleType=e}create(e){return new Vy(this.moduleType,e,[])}}class cA extends Ao{constructor(e){super(),this.componentFactoryResolver=new Pb(this),this.instance=null;const t=new Va([...e.providers,{provide:Ao,useValue:this},{provide:Wh,useValue:this.componentFactoryResolver}],e.parent||wh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function zy(n,e,t=null){return new cA({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let xz=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=DS(0,t.type),r=i.length>0?zy([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Se({token:n,providedIn:"environment",factory:()=>new n(Me(Ai))})}return n})();function lA(n){Mo("NgStandalone"),n.getStandaloneInjector=e=>e.get(xz).getOrCreateStandaloneInjector(n)}function vA(n,e,t,i,r,s){const o=e+t;return gn(n,o,r)?function Ir(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function Iu(n,e){const t=n[e];return t===Ke?void 0:t}(n,o+1)}function vi(n,e){const t=pt();let i;const r=n+qe;t.firstCreatePass?(i=function Hz(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=po(i.type)),a=fi(Oe);try{const c=lh(!1),l=s();return lh(c),function ez(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,z(),r,l),l}finally{fi(a)}}function yi(n,e,t){const i=n+qe,r=z(),s=function ba(n,e){return n[e]}(r,i);return function Ru(n,e){return n[ne].data[e].pure}(r,i)?vA(r,function ti(){const n=He.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t)}function $z(){return this._results[Symbol.iterator]()}class Wy{static#e=Symbol.iterator;get changes(){return this._changes??=new an}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=Wy.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=$z)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function pi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function s2(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let es=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=Yz}return n})();const qz=es,Xz=class extends qz{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function _u(n,e,t,i){const r=e.tView,a=Zh(n,r,t,4096&n[Pe]?4096:16,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null);a[Ol]=n[e.index];const l=n[wr];return null!==l&&(a[wr]=l.createEmbeddedView(r)),ry(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:i});return new uu(r)}};function Yz(){return bf(At(),z())}function bf(n,e){return 4&n.type?new Xz(e,n,Xa(n,e)):null}class jy{constructor(e){this.queryList=e,this.matches=null}clone(){return new jy(this.queryList)}setDirty(){this.queryList.setDirty()}}class $y{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new $y(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==AA(e,t).matches&&this.queries[t].setDirty()}}class wA{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class qy{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new qy(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Xy{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Xy(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,Zz(t,s)),this.matchTNodeWithReadOption(e,t,hh(t,e,s,!1,!1))}else i===es?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,hh(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Us||r===or||r===es&&4&t.type)this.addMatch(t.index,-2);else{const s=hh(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Zz(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function Jz(n,e,t,i){return-1===t?function Kz(n,e){return 11&n.type?Xa(n,e):4&n.type?bf(n,e):null}(e,n):-2===t?function Qz(n,e,t){return t===Us?Xa(e,n):t===es?bf(e,n):t===or?wT(e,n):void 0}(n,e,i):vo(n,n[ne],t,e)}function SA(n,e,t,i){const r=e[wr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:Jz(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function Yy(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=SA(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let d=on;d<u.length;d++){const h=u[d];h[Ol]===h[jt]&&Yy(h[ne],h,l,i)}if(null!==u[Sa]){const d=u[Sa];for(let h=0;h<d.length;h++){const f=d[h];Yy(f[ne],f,l,i)}}}}}return i}function Zy(n){const e=z(),t=pt(),i=tS();Ug(i+1);const r=AA(t,i);if(n.dirty&&function yF(n){return 4==(4&n[Pe])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Yy(t,e,i,[]):SA(t,e,r,i);n.reset(s,ck),n.notifyOnChanges()}return!0}return!1}function EA(n,e,t){const i=pt();i.firstCreatePass&&(function CA(n,e,t){null===n.queries&&(n.queries=new qy),n.queries.track(new Xy(e,t))}(i,new wA(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function TA(n,e,t){const i=new Wy(4==(4&t));(function Uk(n,e,t,i){const r=mb(e);r.push(t),n.firstCreatePass&&gb(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[wr]&&(e[wr]=new $y),e[wr].queries.push(new jy(i))}(i,z(),e)}function AA(n,e){return n.queries.getByIndex(e)}let WA=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Cf=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Hi(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class EG{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let jA=(()=>{class n{compileModuleSync(t){return new Hy(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Ii(Hn(t).declarations).reduce((o,a)=>{const c=at(a);return c&&o.push(new hu(c)),o},[]);return new EG(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ZA=new ve(""),Df=new ve("");let s_,i_=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,s_||(function YG(n){s_=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(Me(Et),Me(r_),Me(Df))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),r_=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return s_?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const o_=new ve("Application Initializer");let a_=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=se(o_,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(wf(s))t.push(s);else if(AC(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const c_=new ve("appBootstrapListener");function QA(n,e){return Array.isArray(e)?e.reduce(QA,n):{...n,...e}}let yc=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=se(KE),this.zoneIsStable=se(bb),this.componentTypes=[],this.components=[],this.isStable=se(Cf).hasPendingTasks.pipe(di(t=>t?De(!1):this.zoneIsStable),function CO(n,e=ws){return n=n??AO,wn((t,i)=>{let r,s=!0;t.subscribe(pn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}()),this._injector=se(Ai)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof kE;if(!this._injector.get(a_).done)throw!r&&function Cs(n){const e=at(n)||En(n)||Un(n);return null!==e&&e.standalone}(t),new te(405,!1);let o;o=r?t:this._injector.get(Wh).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function KG(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Ao),l=o.create(Di.NULL,[],i||o.selector,a),u=l.location.nativeElement,d=l.injector.get(ZA,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),If(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new te(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;If(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(c_,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>If(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new te(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function If(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let QG=(()=>{class n{constructor(){this.zone=se(Et),this.applicationRef=se(yc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function e4(){const n=se(Et),e=se(Kr);return t=>n.runOutsideAngular(()=>e.handleError(t))}const ts=new ve("LocaleId",{providedIn:"root",factory:()=>se(ts,dt.Optional|dt.SkipSelf)||function n4(){return typeof $localize<"u"&&$localize.locale||mc}()}),l_=new ve("PlatformDestroyListeners");let iD=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function T3(n="zone.js",e){return"noop"===n?new E3:"zone.js"===n?new Et(e):n}(i?.ngZone,function nD(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function _z(n,e,t){return new Vy(n,e,t)}(t.moduleType,this.injector,function tD(n){return[{provide:Et,useFactory:n},{provide:Ba,multi:!0,useFactory:()=>{const e=se(QG,{optional:!0});return()=>e.initialize()}},{provide:KE,useFactory:e4},{provide:bb,useFactory:Tb}]}(()=>r)),o=s.injector.get(Kr,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:c=>{o.handleError(c)}});s.onDestroy(()=>{If(this._modules,s),a.unsubscribe()})}),function JA(n,e,t){try{const i=t();return wf(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(a_);return a.runInitializers(),a.donePromise.then(()=>(function rC(n){hi(n,"Expected localeId to be defined"),"string"==typeof n&&(iC=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(ts,mc)||mc),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=QA({},i);return function ZG(n,e,t){const i=new Hy(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(yc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new te(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(l_,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(Me(Di))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Vs=null;const rD=new ve("AllowMultipleToken");function sD(n,e,t=[]){const i=`Platform: ${e}`,r=new ve(i);return(s=[])=>{let o=u_();if(!o||o.injector.get(rD,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function s4(n){if(Vs&&!Vs.get(rD,!1))throw new te(400,!1);(function KA(){!function bL(n){kM=n}(()=>{throw new te(600,!1)})})(),Vs=n;const e=n.get(iD);(function aD(n){n.get(VS,null)?.forEach(t=>t())})(n)}(function oD(n=[],e){return Di.create({name:e,providers:[{provide:nv,useValue:"platform"},{provide:l_,useValue:new Set([()=>Vs=null])},...n]})}(a,i))}return function o4(n){const e=u_();if(!e)throw new te(401,!1);return e}()}}function u_(){return Vs?.get(iD)??null}const h4=sD(null,"core",[]);let f4=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(Me(yc))};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({})}return n})(),x_=null;function xc(){return x_}class H4{}const _i=new ve("DocumentToken");let M_=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(G4),providedIn:"platform"})}return n})();const z4=new ve("Location Initialized");let G4=(()=>{class n extends M_{constructor(){super(),this._doc=se(_i),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return xc().getBaseHref(this._doc)}onPopState(t){const i=xc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=xc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function w_(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function ID(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function ns(n){return n&&"?"!==n[0]?"?"+n:n}let Io=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(PD),providedIn:"root"})}return n})();const RD=new ve("appBaseHref");let PD=(()=>{class n extends Io{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??se(_i).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return w_(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+ns(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+ns(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+ns(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(M_),Me(RD,8))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),W4=(()=>{class n extends Io{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=w_(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+ns(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+ns(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(M_),Me(RD,8))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),Fu=(()=>{class n{constructor(t){this._subject=new an,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function q4(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(ID(ND(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ns(i))}normalize(t){return n.stripTrailingSlash(function $4(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,ND(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ns(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ns(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=ns;static#t=this.joinWithSlash=w_;static#n=this.stripTrailingSlash=ID;static#i=this.\u0275fac=function(i){return new(i||n)(Me(Io))};static#r=this.\u0275prov=Se({token:n,factory:()=>function j4(){return new Fu(Me(Io))}(),providedIn:"root"})}return n})();function ND(n){return n.replace(/\/index.html$/,"")}function zD(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}let cW=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({})}return n})();function ZD(n){return"server"===n}let hW=(()=>{class n{static#e=this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>new fW(Me(_i),window)})}return n})();class fW{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function pW(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class KD{}class UW extends H4{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class B_ extends UW{static makeCurrent(){!function V4(n){x_||(x_=n)}(new B_)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function kW(){return Vu=Vu||document.querySelector("base"),Vu?Vu.getAttribute("href"):null}();return null==t?null:function BW(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){Vu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return zD(document.cookie,e)}}let Vu=null,HW=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const V_=new ve("EventManagerPlugins");let tI=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(Me(V_),Me(Et))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();class nI{constructor(e){this._doc=e}}const H_="ng-app-id";let iI=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ZD(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${H_}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(H_),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(H_,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(_i),Me(Eh),Me(HS,8),Me(_o))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const z_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},G_=/%COMP%/g,jW=new ve("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function sI(n,e){return e.map(t=>t.replace(G_,n))}let oI=(()=>{class n{constructor(t,i,r,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=ZD(a),this.defaultRenderer=new W_(t,o,c,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Qi.ShadowDom&&(i={...i,encapsulation:Qi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof cI?r.applyToHost(t):r instanceof j_&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Qi.Emulated:s=new cI(c,l,i,this.appId,u,o,a,d);break;case Qi.ShadowDom:return new YW(c,l,t,i,o,a,this.nonce,d);default:s=new j_(c,l,i,u,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(Me(tI),Me(iI),Me(Eh),Me(jW),Me(_i),Me(_o),Me(Et),Me(HS))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();class W_{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(z_[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(aI(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(aI(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new te(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=z_[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=z_[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Os.DashCase|Os.Important)?e.style.setProperty(t,i,r&Os.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Os.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=xc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function aI(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class YW extends W_{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=sI(r.id,r.styles);for(const u of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class j_ extends W_{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?sI(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class cI extends j_{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function $W(n){return"_ngcontent-%COMP%".replace(G_,n)}(l),this.hostAttr=function qW(n){return"_nghost-%COMP%".replace(G_,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let ZW=(()=>{class n extends nI{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(_i))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const lI=["alt","control","meta","shift"],KW={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},JW={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let QW=(()=>{class n extends nI{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>xc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),lI.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=KW[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),lI.forEach(o=>{o!==r&&(0,JW[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(Me(_i))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const ij=sD(h4,"browser",[{provide:_o,useValue:"browser"},{provide:VS,useValue:function ej(){B_.makeCurrent()},multi:!0},{provide:_i,useFactory:function nj(){return function k2(n){cv=n}(document),document},deps:[]}]),rj=new ve(""),hI=[{provide:Df,useClass:class VW{addToWindow(e){Lt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new te(5103,!1);return s},Lt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Lt.getAllAngularRootElements=()=>e.getAllRootElements(),Lt.frameworkStabilizers||(Lt.frameworkStabilizers=[]),Lt.frameworkStabilizers.push(i=>{const r=Lt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(c){o=o||c,s--,0==s&&i(o)};r.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?xc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:ZA,useClass:i_,deps:[Et,r_,Df]},{provide:i_,useClass:i_,deps:[Et,r_,Df]}],fI=[{provide:nv,useValue:"root"},{provide:Kr,useFactory:function tj(){return new Kr},deps:[]},{provide:V_,useClass:ZW,multi:!0,deps:[_i,Et,_o]},{provide:V_,useClass:QW,multi:!0,deps:[_i]},oI,iI,tI,{provide:VE,useExisting:oI},{provide:KD,useClass:HW,deps:[]},[]];let sj=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:Eh,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Me(rj,12))};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({providers:[...fI,...hI],imports:[cW,f4]})}return n})(),pI=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(Me(_i))};static#t=this.\u0275prov=Se({token:n,factory:function(i){let r=null;return r=i?new i:function aj(){return new pI(Me(_i))}(),r},providedIn:"root"})}return n})();function zs(n){return!!n&&(n instanceof Yt||Ht(n.lift)&&Ht(n.subscribe))}typeof window<"u"&&window;const{isArray:hj}=Array,{getPrototypeOf:fj,prototype:pj,keys:mj}=Object;function yI(n){if(1===n.length){const e=n[0];if(hj(e))return{args:e,keys:null};if(function gj(n){return n&&"object"==typeof n&&fj(n)===pj}(e)){const t=mj(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:vj}=Array;function _I(n){return vt(e=>function yj(n,e){return vj(e)?n(...e):n(e)}(n,e))}function xI(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function q_(...n){const e=Al(n),t=lw(n),{args:i,keys:r}=yI(n);if(0===i.length)return Sn([],e);const s=new Yt(function _j(n,e,t=ws){return i=>{MI(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)MI(e,()=>{const l=Sn(n[c],e);let u=!1;l.subscribe(pn(i,d=>{s[c]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>xI(r,o):ws));return t?s.pipe(_I(t)):s}function MI(n,e,t){n?Wr(t,n,e):e()}const Kf=Xm(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Hu(...n){return function xj(){return ga(1)}()(Sn(n,Al(n)))}function Jf(n){return new Yt(e=>{Vi(n()).subscribe(e)})}function Qf(n,e){const t=Ht(n)?n:()=>n,i=r=>r.error(t());return new Yt(e?r=>e.schedule(i,0,r):i)}function X_(){return wn((n,e)=>{let t=null;n._refCount++;const i=pn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class wI extends Yt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,XM(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ei;const t=this.getSubject();e.add(this.source.subscribe(pn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ei.EMPTY)}return e}refCount(){return X_()(this)}}function Nr(n){return n<=0?()=>_r:wn((e,t)=>{let i=0;e.subscribe(pn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function ss(n,e){return wn((t,i)=>{let r=0;t.subscribe(pn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function ep(n){return wn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function SI(n=wj){return wn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function wj(){return new Kf}function Ro(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ss((r,s)=>n(r,s,i)):ws,Nr(1),t?ep(e):SI(()=>new Kf))}function Po(n,e){return Ht(e)?Vn(n,e,1):Vn(n,1)}function $n(n,e,t){const i=Ht(n)||e||t?{next:n,error:e,complete:t}:n;return i?wn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(pn(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):ws}function wc(n){return wn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(pn(t,void 0,void 0,o=>{s=Vi(n(o,wc(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Y_(n){return n<=0?()=>_r:wn((e,t)=>{let i=[];e.subscribe(pn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function zu(n){return wn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const nt="primary",Gu=Symbol("RouteTitle");class Aj{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Sc(n){return new Aj(n)}function Dj(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Lr(n,e){const t=n?Z_(n):void 0,i=e?Z_(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!EI(n[r],e[r]))return!1;return!0}function Z_(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function EI(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function bI(n){return n.length>0?n[n.length-1]:null}function Gs(n){return zs(n)?n:wf(n)?Sn(Promise.resolve(n)):De(n)}const Rj={exact:function AI(n,e,t){if(!No(n.segments,e.segments)||!tp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!AI(n.children[i],e.children[i],t))return!1;return!0},subset:DI},TI={exact:function Pj(n,e){return Lr(n,e)},subset:function Nj(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>EI(n[t],e[t]))},ignored:()=>!0};function CI(n,e,t){return Rj[t.paths](n.root,e.root,t.matrixParams)&&TI[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function DI(n,e,t){return II(n,e,e.segments,t)}function II(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!No(r,t)||e.hasChildren()||!tp(r,t,i))}if(n.segments.length===t.length){if(!No(n.segments,t)||!tp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!DI(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(No(n.segments,r)&&tp(n.segments,r,i)&&n.children[nt])&&II(n.children[nt],e,s,i)}}function tp(n,e,t){return e.every((i,r)=>TI[t](n[r].parameters,i.parameters))}class Ec{constructor(e=new Dt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Sc(this.queryParams)),this._queryParamMap}toString(){return Fj.serialize(this)}}class Dt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return np(this)}}class Wu{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Sc(this.parameters)),this._parameterMap}toString(){return NI(this)}}function No(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let bc=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>new K_,providedIn:"root"})}return n})();class K_{parse(e){const t=new qj(e);return new Ec(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${ju(e.root,!0)}`,i=function Bj(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${ip(t)}=${ip(r)}`).join("&"):`${ip(t)}=${ip(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Uj(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Fj=new K_;function np(n){return n.segments.map(e=>NI(e)).join("/")}function ju(n,e){if(!n.hasChildren())return np(n);if(e){const t=n.children[nt]?ju(n.children[nt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==nt&&i.push(`${r}:${ju(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Oj(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===nt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==nt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===nt?[ju(n.children[nt],!1)]:[`${r}:${ju(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[nt]?`${np(n)}/${t[0]}`:`${np(n)}/(${t.join("//")})`}}function RI(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ip(n){return RI(n).replace(/%3B/gi,";")}function J_(n){return RI(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function rp(n){return decodeURIComponent(n)}function PI(n){return rp(n.replace(/\+/g,"%20"))}function NI(n){return`${J_(n.path)}${function kj(n){return Object.keys(n).map(e=>`;${J_(e)}=${J_(n[e])}`).join("")}(n.parameters)}`}const Vj=/^[^\/()?;#]+/;function Q_(n){const e=n.match(Vj);return e?e[0]:""}const Hj=/^[^\/()?;=#]+/,Gj=/^[^=?&#]+/,jj=/^[^&#]+/;class qj{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dt([],{}):new Dt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[nt]=new Dt(e,t)),i}parseSegment(){const e=Q_(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new Wu(rp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function zj(n){const e=n.match(Hj);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Q_(this.remaining);r&&(i=r,this.capture(i))}e[rp(t)]=rp(i)}parseQueryParam(e){const t=function Wj(n){const e=n.match(Gj);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function $j(n){const e=n.match(jj);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=PI(t),s=PI(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Q_(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new te(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=nt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[nt]:new Dt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}}function LI(n){return n.segments.length>0?new Dt([],{[nt]:n}):n}function OI(n){const e={};for(const i of Object.keys(n.children)){const s=OI(n.children[i]);if(i===nt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Xj(n){if(1===n.numberOfChildren&&n.children[nt]){const e=n.children[nt];return new Dt(n.segments.concat(e.segments),e.children)}return n}(new Dt(n.segments,e))}function Lo(n){return n instanceof Ec}function FI(n){let e;const r=LI(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new Dt(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function UI(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return e0(r,r,r,t,i);const s=function Zj(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new BI(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new BI(t,e,i)}(e);if(s.toRoot())return e0(r,r,new Dt([],{}),t,i);const o=function Kj(n,e,t){if(n.isAbsolute)return new op(e,!0,0);if(!t)return new op(e,!1,NaN);if(null===t.parent)return new op(t,!0,0);const i=sp(n.commands[0])?0:1;return function Jj(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new te(4005,!1);r=i.segments.length}return new op(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?qu(o.segmentGroup,o.index,s.commands):VI(o.segmentGroup,o.index,s.commands);return e0(r,o.segmentGroup,a,t,i)}function sp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function $u(n){return"object"==typeof n&&null!=n&&n.outlets}function e0(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:kI(n,e,t);const a=LI(OI(o));return new Ec(a,s,r)}function kI(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:kI(s,e,t)}),new Dt(n.segments,i)}class BI{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&sp(i[0]))throw new te(4003,!1);const r=i.find($u);if(r&&r!==bI(i))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class op{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function VI(n,e,t){if(n||(n=new Dt([],{})),0===n.segments.length&&n.hasChildren())return qu(n,e,t);const i=function e8(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if($u(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!zI(c,l,o))return s;i+=2}else{if(!zI(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Dt(n.segments.slice(0,i.pathIndex),{});return s.children[nt]=new Dt(n.segments.slice(i.pathIndex),n.children),qu(s,0,r)}return i.match&&0===r.length?new Dt(n.segments,{}):i.match&&!n.hasChildren()?t0(n,e,t):i.match?qu(n,0,r):t0(n,e,t)}function qu(n,e,t){if(0===t.length)return new Dt(n.segments,{});{const i=function Qj(n){return $u(n[0])?n[0].outlets:{[nt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==nt)&&n.children[nt]&&1===n.numberOfChildren&&0===n.children[nt].segments.length){const s=qu(n.children[nt],e,t);return new Dt(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=VI(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Dt(n.segments,r)}}function t0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if($u(s)){const c=t8(s.outlets);return new Dt(i,c)}if(0===r&&sp(t[0])){i.push(new Wu(n.segments[e].path,HI(t[0]))),r++;continue}const o=$u(s)?s.outlets[nt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&sp(a)?(i.push(new Wu(o,HI(a))),r+=2):(i.push(new Wu(o,{})),r++)}return new Dt(i,{})}function t8(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=t0(new Dt([],{}),0,i))}),e}function HI(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function zI(n,e,t){return n==t.path&&Lr(e,t.parameters)}const Xu="imperative";class Or{constructor(e,t){this.id=e,this.url=t}}class ap extends Or{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class os extends Or{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Tc extends Or{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Cc extends Or{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class cp extends Or{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class GI extends Or{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class n8 extends Or{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class i8 extends Or{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class r8 extends Or{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class s8 extends Or{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o8{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class a8{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class c8{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class l8{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class u8{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class d8{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class WI{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class n0{}class r0{constructor(e){this.url=e}}class h8{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Yu,this.attachRef=null}}let Yu=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new h8,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class jI{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=s0(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=s0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=o0(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return o0(e,this._root).map(t=>t.value)}}function s0(n,e){if(n===e.value)return e;for(const t of e.children){const i=s0(n,t);if(i)return i}return null}function o0(n,e){if(n===e.value)return[e];for(const t of e.children){const i=o0(n,t);if(i.length)return i.unshift(e),i}return[]}class ur{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ac(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class $I extends jI{constructor(e,t){super(e),this.snapshot=t,l0(this,e)}toString(){return this.snapshot.toString()}}function qI(n,e){const t=function f8(n,e){const o=new c0([],{},{},"",{},nt,e,null,{});return new XI("",new ur(o,[]))}(0,e),i=new Hi([new Wu("",{})]),r=new Hi({}),s=new Hi({}),o=new Hi({}),a=new Hi(""),c=new Dc(i,r,o,a,s,nt,e,t.root);return c.snapshot=t.root,new $I(new ur(c,[]),t)}class Dc{constructor(e,t,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(vt(l=>l[Gu]))??De(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(vt(e=>Sc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(vt(e=>Sc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function a0(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:n.params,data:n.data,resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&ZI(r)&&(i.resolve[Gu]=r.title),i}class c0{get title(){return this.data?.[Gu]}constructor(e,t,i,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Sc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Sc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class XI extends jI{constructor(e,t){super(t),this.url=e,l0(this,t)}toString(){return YI(this._root)}}function l0(n,e){e.value._routerState=n,e.children.forEach(t=>l0(n,t))}function YI(n){const e=n.children.length>0?` { ${n.children.map(YI).join(", ")} } `:"";return`${n.value}${e}`}function u0(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Lr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Lr(e.params,t.params)||n.paramsSubject.next(t.params),function Ij(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Lr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Lr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function d0(n,e){const t=Lr(n.params,e.params)&&function Lj(n,e){return No(n,e)&&n.every((t,i)=>Lr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||d0(n.parent,e.parent))}function ZI(n){return"string"==typeof n.title||null===n.title}let h0=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=nt,this.activateEvents=new an,this.deactivateEvents=new an,this.attachEvents=new an,this.detachEvents=new an,this.parentContexts=se(Yu),this.location=se(or),this.changeDetector=se(du),this.environmentInjector=se(Ai),this.inputBinder=se(lp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new p8(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=Kn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[mo]})}return n})();class p8{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Dc?this.route:e===Yu?this.childContexts:this.parent.get(e,t)}}const lp=new ve("");let KI=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=q_([i.queryParams,i.params,i.data]).pipe(di(([s,o,a],c)=>(a={...s,...o,...a},0===c?De(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function B4(n){const e=at(n);if(!e)return null;const t=new hu(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function Zu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function g8(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Zu(n,i,r);return Zu(n,i)})}(n,e,t);return new ur(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Zu(n,a)),o}}const i=function v8(n){return new Dc(new Hi(n.url),new Hi(n.params),new Hi(n.queryParams),new Hi(n.fragment),new Hi(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Zu(n,s));return new ur(i,r)}}const f0="ngNavigationCancelingError";function JI(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Lo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=QI(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function QI(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[f0]=!0,i.cancellationCode=e,t&&(i.url=t),i}function eR(n){return n&&n[f0]}let tR=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["ng-component"]],standalone:!0,features:[lA],decls:1,vars:0,template:function(i,r){1&i&&ln(0,"router-outlet")},dependencies:[h0],encapsulation:2})}return n})();function p0(n){const e=n.children&&n.children.map(p0),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==nt&&(t.component=tR),t}function Fr(n){return n.outlet||nt}function Ku(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class b8{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),u0(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Ac(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ac(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ac(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Ac(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new d8(s.value.snapshot))}),e.children.length&&this.forwardEvent(new l8(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(u0(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),u0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Ku(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class nR{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class up{constructor(e,t){this.component=e,this.route=t}}function T8(n,e,t){const i=n._root;return Ju(i,e?e._root:null,t,[i.value])}function Ic(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function FO(n){return null!==qd(n)}(n)?e.get(n):n:i}function Ju(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Ac(e);return n.children.forEach(o=>{(function A8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function D8(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!No(n.url,e.url);case"pathParamsOrQueryParamsChange":return!No(n.url,e.url)||!Lr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!d0(n,e)||!Lr(n.queryParams,e.queryParams);default:return!d0(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new nR(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Ju(n,e,s.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new up(a.outlet.component,o))}else o&&Qu(e,a,r),r.canActivateChecks.push(new nR(i)),Ju(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Qu(a,t.getContext(o),r)),r}function Qu(n,e,t){const i=Ac(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Qu(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new up(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function ed(n){return"function"==typeof n}function iR(n){return n instanceof Kf||"EmptyError"===n?.name}const dp=Symbol("INITIAL_VALUE");function Rc(){return di(n=>q_(n.map(e=>e.pipe(Nr(1),function Mj(...n){const e=Al(n);return wn((t,i)=>{(e?Hu(n,t,e):Hu(n,t)).subscribe(i)})}(dp)))).pipe(vt(e=>{for(const t of e)if(!0!==t){if(t===dp)return dp;if(!1===t||t instanceof Ec)return t}return!0}),ss(e=>e!==dp),Nr(1)))}function rR(n){return function UL(...n){return jM(n)}($n(e=>{if(Lo(e))throw JI(0,e)}),vt(e=>!0===e))}class m0{constructor(e){this.segmentGroup=e||null}}class g0 extends Error{constructor(e){super(),this.urlTree=e}}function Pc(n){return Qf(new m0(n))}class Y8{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return De(i);if(r.numberOfChildren>1||!r.children[nt])return Qf(new te(4e3,!1));r=r.children[nt]}}applyRedirectCommands(e,t,i){const r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new g0(r);return r}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ec(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new Dt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new te(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const v0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Z8(n,e,t,i,r){const s=y0(n,e,t);return s.matched?(i=function _8(n,e){return n.providers&&!n._injector&&(n._injector=zy(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function $8(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?De(r.map(o=>{const a=Ic(o,n);return Gs(function O8(n){return n&&ed(n.canMatch)}(a)?a.canMatch(e,t):Is(n,()=>a(e,t)))})).pipe(Rc(),rR()):De(!0)}(i,e,t).pipe(vt(o=>!0===o?s:{...v0}))):De(s)}function y0(n,e,t){if("**"===e.path)return function K8(n){return{matched:!0,parameters:n.length>0?bI(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...v0}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Dj)(t,n,e);if(!r)return{...v0};const s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function sR(n,e,t,i){return t.length>0&&function e$(n,e,t){return t.some(i=>hp(n,e,i)&&Fr(i)!==nt)}(n,t,i)?{segmentGroup:new Dt(e,Q8(i,new Dt(t,n.children))),slicedSegments:[]}:0===t.length&&function t$(n,e,t){return t.some(i=>hp(n,e,i))}(n,t,i)?{segmentGroup:new Dt(n.segments,J8(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Dt(n.segments,n.children),slicedSegments:t}}function J8(n,e,t,i,r){const s={};for(const o of i)if(hp(n,t,o)&&!r[Fr(o)]){const a=new Dt([],{});s[Fr(o)]=a}return{...r,...s}}function Q8(n,e){const t={};t[nt]=e;for(const i of n)if(""===i.path&&Fr(i)!==nt){const r=new Dt([],{});t[Fr(i)]=r}return t}function hp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class r${}class a${constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Y8(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){const e=sR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(vt(t=>{const i=new c0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nt,this.rootComponentType,null,{}),r=new ur(i,t),s=new XI("",r),o=function Yj(n,e,t=null,i=null){return UI(FI(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,nt).pipe(wc(i=>{if(i instanceof g0)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof m0?this.noMatchError(i):i}))}inheritParamsAndData(e,t){const i=e.value,r=a0(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(vt(s=>s instanceof ur?[s]:[]))}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Sn(r).pipe(Po(s=>{const o=i.children[s],a=function S8(n,e){const t=n.filter(i=>Fr(i)===e);return t.push(...n.filter(i=>Fr(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function Ej(n,e){return wn(function Sj(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(pn(o,u=>{const d=l++;c=a?n(c,u,d):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),ep(null),function bj(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ss((r,s)=>n(r,s,i)):ws,Y_(1),t?ep(e):SI(()=>new Kf))}(),Vn(s=>{if(null===s)return Pc(i);const o=oR(s);return function c$(n){n.sort((e,t)=>e.value.outlet===nt?-1:t.value.outlet===nt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),De(o)}))}processSegment(e,t,i,r,s,o){return Sn(t).pipe(Po(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(wc(c=>{if(c instanceof m0)return De(null);throw c}))),Ro(a=>!!a),wc(a=>{if(iR(a))return function i$(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?De(new r$):Pc(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function n$(n,e,t,i){return!!(Fr(n)===i||i!==nt&&hp(e,t,n))&&y0(e,n,t).matched}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Pc(r):Pc(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=y0(t,r,s);if(!a)return Pc(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const d=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,l);return this.applyRedirects.lineralizeSegments(r,d).pipe(Vn(h=>this.processSegment(e,i,t,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){const o=Z8(t,i,r,e);return"**"===i.path&&(t.children={}),o.pipe(di(a=>a.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(di(({routes:c})=>{const l=i._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new c0(u,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function u$(n){return n.data||{}}(i),Fr(i),i.component??i._loadedComponent??null,i,function d$(n){return n.resolve||{}}(i)),{segmentGroup:p,slicedSegments:v}=sR(t,u,d,c);if(0===v.length&&p.hasChildren())return this.processChildren(l,c,p).pipe(vt(m=>null===m?null:new ur(f,m)));if(0===c.length&&0===v.length)return De(new ur(f,[]));const g=Fr(i)===s;return this.processSegment(l,c,p,v,g?nt:s,!0).pipe(vt(m=>new ur(f,m instanceof ur?[m]:[])))})):Pc(t)))}getChildConfig(e,t,i){return t.children?De({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?De({routes:t._loadedRoutes,injector:t._loadedInjector}):function j8(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?De(!0):De(r.map(o=>{const a=Ic(o,n);return Gs(function R8(n){return n&&ed(n.canLoad)}(a)?a.canLoad(e,t):Is(n,()=>a(e,t)))})).pipe(Rc(),rR())}(e,t,i).pipe(Vn(r=>r?this.configLoader.loadChildren(e,t).pipe($n(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function X8(n){return Qf(QI(!1,3))}())):De({routes:[],injector:e})}}function l$(n){const e=n.value.routeConfig;return e&&""===e.path}function oR(n){const e=[],t=new Set;for(const i of n){if(!l$(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=oR(i.children);e.push(new ur(i.value,r))}return e.filter(i=>!t.has(i))}function aR(n){const e=n.children.map(t=>aR(t)).flat();return[n,...e]}function _0(n){return di(e=>{const t=n(e);return t?Sn(t).pipe(vt(()=>e)):De(e)})}let cR=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===nt);return i}getResolvedTitleForRoute(t){return t.data[Gu]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(v$),providedIn:"root"})}return n})(),v$=(()=>{class n extends cR{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(pI))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Nc=new ve("",{providedIn:"root",factory:()=>({})}),Lc=new ve("ROUTES");let x0=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=se(jA)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return De(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Gs(t.loadComponent()).pipe(vt(lR),$n(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),zu(()=>{this.componentLoaders.delete(t)})),r=new wI(i,()=>new Bi).pipe(X_());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return De({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function y$(n,e,t,i){return Gs(n.loadChildren()).pipe(vt(lR),Vn(r=>r instanceof aA||Array.isArray(r)?De(r):Sn(e.compileModuleAsync(r))),vt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Lc,[],{optional:!0,self:!0}).flat()),{routes:o.map(p0),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(zu(()=>{this.childrenLoaders.delete(i)})),o=new wI(s,()=>new Bi).pipe(X_());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lR(n){return function _$(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let M0=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(x$),providedIn:"root"})}return n})(),x$=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const uR=new ve(""),dR=new ve("");function M$(n,e,t){const i=n.get(dR),r=n.get(_i);return n.get(Et).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,Promise.resolve();let s;const o=new Promise(l=>{s=l}),a=r.startViewTransition(()=>(s(),function w$(n){return new Promise(e=>{Db(e,{injector:n})})}(n))),{onViewTransitionCreated:c}=i;return c&&Is(n,()=>c({transition:a,from:e,to:t})),o})}let fp=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Bi,this.transitionAbortSubject=new Bi,this.configLoader=se(x0),this.environmentInjector=se(Ai),this.urlSerializer=se(bc),this.rootContexts=se(Yu),this.location=se(Fu),this.inputBindingEnabled=null!==se(lp,{optional:!0}),this.titleStrategy=se(cR),this.options=se(Nc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=se(M0),this.createViewTransition=se(uR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>De(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new a8(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new o8(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Hi({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Xu,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ss(s=>0!==s.id),vt(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),di(s=>{this.currentTransition=s;let o=!1,a=!1;return De(s).pipe($n(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),di(c=>{const l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(c.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const d="";return this.events.next(new Cc(c.id,this.urlSerializer.serialize(c.rawUrl),d,0)),c.resolve(null),_r}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return De(c).pipe(di(d=>{const h=this.transitions?.getValue();return this.events.next(new ap(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions?.getValue()?_r:Promise.resolve(d)}),function h$(n,e,t,i,r,s){return Vn(o=>function s$(n,e,t,i,r,s,o="emptyOnly"){return new a$(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(vt(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),$n(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects};const h=new GI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:d,extractedUrl:h,source:f,restoredState:p,extras:v}=c,g=new ap(d,this.urlSerializer.serialize(h),f,p);this.events.next(g);const m=qI(0,this.rootComponentType).snapshot;return this.currentTransition=s={...c,targetSnapshot:m,urlAfterRedirects:h,extras:{...v,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=h,De(s)}{const d="";return this.events.next(new Cc(c.id,this.urlSerializer.serialize(c.extractedUrl),d,1)),c.resolve(null),_r}}),$n(c=>{const l=new n8(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),vt(c=>(this.currentTransition=s={...c,guards:T8(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},s)),function U8(n,e){return Vn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?De({...t,guardsResult:!0}):function k8(n,e,t,i){return Sn(n).pipe(Vn(r=>function W8(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?De(s.map(a=>{const c=Ku(e)??r,l=Ic(a,c);return Gs(function L8(n){return n&&ed(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):Is(c,()=>l(n,e,t,i))).pipe(Ro())})).pipe(Rc()):De(!0)}(r.component,r.route,t,e,i)),Ro(r=>!0!==r,!0))}(o,i,r,n).pipe(Vn(a=>a&&function I8(n){return"boolean"==typeof n}(a)?function B8(n,e,t,i){return Sn(e).pipe(Po(r=>Hu(function H8(n,e){return null!==n&&e&&e(new c8(n)),De(!0)}(r.route.parent,i),function V8(n,e){return null!==n&&e&&e(new u8(n)),De(!0)}(r.route,i),function G8(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function C8(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Jf(()=>De(o.guards.map(c=>{const l=Ku(o.node)??t,u=Ic(c,l);return Gs(function N8(n){return n&&ed(n.canActivateChild)}(u)?u.canActivateChild(i,n):Is(l,()=>u(i,n))).pipe(Ro())})).pipe(Rc())));return De(s).pipe(Rc())}(n,r.path,t),function z8(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return De(!0);const r=i.map(s=>Jf(()=>{const o=Ku(e)??t,a=Ic(s,o);return Gs(function P8(n){return n&&ed(n.canActivate)}(a)?a.canActivate(e,n):Is(o,()=>a(e,n))).pipe(Ro())}));return De(r).pipe(Rc())}(n,r.route,t))),Ro(r=>!0!==r,!0))}(i,s,n,e):De(a)),vt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,c=>this.events.next(c)),$n(c=>{if(s.guardsResult=c.guardsResult,Lo(c.guardsResult))throw JI(0,c.guardsResult);const l=new i8(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),ss(c=>!!c.guardsResult||(this.cancelNavigationTransition(c,"",3),!1)),_0(c=>{if(c.guards.canActivateChecks.length)return De(c).pipe($n(l=>{const u=new r8(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),di(l=>{let u=!1;return De(l).pipe(function f$(n,e){return Vn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return De(t);const s=new Set(r.map(c=>c.route)),o=new Set;for(const c of s)if(!o.has(c))for(const l of aR(c))o.add(l);let a=0;return Sn(o).pipe(Po(c=>s.has(c)?function p$(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!ZI(r)&&(s[Gu]=r.title),function m$(n,e,t,i){const r=Z_(n);if(0===r.length)return De({});const s={};return Sn(r).pipe(Vn(o=>function g$(n,e,t,i){const r=Ku(e)??i,s=Ic(n,r);return Gs(s.resolve?s.resolve(e,t):Is(r,()=>s(e,t)))}(n[o],e,t,i).pipe(Ro(),$n(a=>{s[o]=a}))),Y_(1),function Tj(n){return vt(()=>n)}(s),wc(o=>iR(o)?_r:Qf(o)))}(s,n,e,i).pipe(vt(o=>(n._resolvedData=o,n.data=a0(n,n.parent,t).resolve,null)))}(c,i,n,e):(c.data=a0(c,c.parent,n).resolve,De(void 0))),$n(()=>a++),Y_(1),Vn(c=>a===o.size?De(t):_r))})}(this.paramsInheritanceStrategy,this.environmentInjector),$n({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",2)}}))}),$n(l=>{const u=new s8(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),_0(c=>{const l=u=>{const d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe($n(h=>{u.component=h}),vt(()=>{})));for(const h of u.children)d.push(...l(h));return d};return q_(l(c.targetSnapshot.root)).pipe(ep(),Nr(1))}),_0(()=>this.afterPreactivation()),di(()=>{const{currentSnapshot:c,targetSnapshot:l}=s,u=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return u?Sn(u).pipe(vt(()=>s)):De(s)}),vt(c=>{const l=function m8(n,e,t){const i=Zu(n,e._root,t?t._root:void 0);return new $I(i,e)}(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s={...c,targetRouterState:l},this.currentNavigation.targetRouterState=l,s}),$n(()=>{this.events.next(new n0)}),((n,e,t,i)=>vt(r=>(new b8(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Nr(1),$n({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new os(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),function Cj(n){return wn((e,t)=>{Vi(n).subscribe(pn(t,()=>t.complete(),Km)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe($n(c=>{throw c}))),zu(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),wc(c=>{if(a=!0,eR(c))this.events.next(new Tc(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),function y8(n){return eR(n)&&Lo(n.url)}(c)?this.events.next(new r0(c.url)):s.resolve(!1);else{this.events.next(new cp(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(c))}catch(l){s.reject(l)}}return _r}))}))}cancelNavigationTransition(t,i,r){const s=new Tc(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function S$(n){return n!==Xu}let E$=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(T$),providedIn:"root"})}return n})();class b${shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let T$=(()=>{class n extends b${static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ia(n)))(r||n)}})();static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hR=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:()=>se(C$),providedIn:"root"})}return n})(),C$=(()=>{class n extends hR{constructor(){super(...arguments),this.location=se(Fu),this.urlSerializer=se(bc),this.options=se(Nc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=se(M0),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ec,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=qI(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof ap)this.stateMemento=this.createStateMemento();else if(t instanceof Cc)this.rawUrlTree=i.initialUrl;else if(t instanceof GI){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else t instanceof n0?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):t instanceof Tc&&(3===t.code||2===t.code)?this.restoreHistory(i):t instanceof cp?this.restoreHistory(i,!0):t instanceof os&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&0===s&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ia(n)))(r||n)}})();static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var td=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(td||{});function fR(n,e){n.events.pipe(ss(t=>t instanceof os||t instanceof Tc||t instanceof cp||t instanceof Cc),vt(t=>t instanceof os||t instanceof Cc?td.COMPLETE:t instanceof Tc&&(0===t.code||1===t.code)?td.REDIRECTING:td.FAILED),ss(t=>t!==td.REDIRECTING),Nr(1)).subscribe(()=>{e()})}function A$(n){throw n}const D$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},I$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let dr=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=se(WA),this.stateManager=se(hR),this.options=se(Nc,{optional:!0})||{},this.pendingTasks=se(Cf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=se(fp),this.urlSerializer=se(bc),this.location=se(Fu),this.urlHandlingStrategy=se(M0),this._events=new Bi,this.errorHandler=this.options.errorHandler||A$,this.navigated=!1,this.routeReuseStrategy=se(E$),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=se(Lc,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!se(lp,{optional:!0}),this.eventsSubscription=new Ei,this.isNgZoneEnabled=se(Et)instanceof Et&&Et.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof Tc&&0!==i.code&&1!==i.code)this.navigated=!0;else if(i instanceof os)this.navigated=!0;else if(i instanceof r0){const o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),a={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||S$(r.source)};this.scheduleNavigation(o,Xu,null,a,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function P$(n){return!(n instanceof n0||n instanceof r0)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Xu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const c={...r};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(p0),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:o;let d,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=FI(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return UI(d,t,u,l??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Lo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Xu,null,i)}navigate(t,i={skipLocationChange:!1}){return function R$(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new te(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...D$}:!1===i?{...I$}:i,Lo(t))return CI(this.currentUrlTree,t,r);const s=this.parseUrl(t);return CI(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,h)=>{a=d,c=h});const u=this.pendingTasks.add();return fR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class pR{}let O$=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ss(t=>t instanceof os),Po(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=zy(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Sn(r).pipe(ga())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):De(null);const s=r.pipe(Vn(o=>null===o?De(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Sn([s,this.loader.loadComponent(i)]).pipe(ga()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(Me(dr),Me(jA),Me(Ai),Me(pR),Me(x0))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const S0=new ve("");let mR=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ap?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof os?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Cc&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof WI&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new WI(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function rb(){throw new Error("invalid")}()};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function Ur(n,e){return{\u0275kind:n,\u0275providers:e}}function vR(){const n=se(Di);return e=>{const t=n.get(yc);if(e!==t.components[0])return;const i=n.get(dr),r=n.get(yR);1===n.get(E0)&&i.initialNavigation(),n.get(_R,null,dt.Optional)?.setUpPreloading(),n.get(S0,null,dt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const yR=new ve("",{factory:()=>new Bi}),E0=new ve("",{providedIn:"root",factory:()=>1}),_R=new ve("");function B$(n){return Ur(0,[{provide:_R,useExisting:O$},{provide:pR,useExisting:n}])}function H$(n){return Ur(9,[{provide:uR,useValue:M$},{provide:dR,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const xR=new ve("ROUTER_FORROOT_GUARD"),z$=[Fu,{provide:bc,useClass:K_},dr,Yu,{provide:Dc,useFactory:function gR(n){return n.routerState.root},deps:[dr]},x0,[]];let MR=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[z$,[],{provide:Lc,multi:!0,useValue:t},{provide:xR,useFactory:$$,deps:[[dr,new gh,new vh]]},{provide:Nc,useValue:i||{}},i?.useHash?{provide:Io,useClass:W4}:{provide:Io,useClass:PD},{provide:S0,useFactory:()=>{const n=se(hW),e=se(Et),t=se(Nc),i=se(fp),r=se(bc);return t.scrollOffset&&n.setOffset(t.scrollOffset),new mR(r,i,n,e,t)}},i?.preloadingStrategy?B$(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?q$(i):[],i?.bindToComponentInputs?Ur(8,[KI,{provide:lp,useExisting:KI}]).\u0275providers:[],i?.enableViewTransitions?H$().\u0275providers:[],[{provide:wR,useFactory:vR},{provide:c_,multi:!0,useExisting:wR}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Lc,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(Me(xR,8))};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({})}return n})();function $$(n){return"guarded"}function q$(n){return["disabled"===n.initialNavigation?Ur(3,[{provide:o_,multi:!0,useFactory:()=>{const e=se(dr);return()=>{e.setUpLocationChangeListener()}}},{provide:E0,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Ur(2,[{provide:E0,useValue:0},{provide:o_,multi:!0,deps:[Di],useFactory:e=>{const t=e.get(z4,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(dr),s=e.get(yR);fR(r,()=>{i(!0)}),e.get(fp).afterPreactivation=()=>(i(!0),s.closed?De(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const wR=new ve("");function SR(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}const bR=1,K$=2,as=3,mp=0,M6=1,w6=2,js=0,S6=1,E6=2,b6=3,T6=4,C6=5,RR="attached",$s=301,Fo=302,nd=306,Uo=1e3,qn=1001,dn=1003,Jt=1006,ls=1008,qs=1009,Xs=1014,us=1015,sd=1016,ko=1020,$i=1023,Bo=1026,Fc=1027,od=2300,Uc=2301,Vo=3001,Gt="srgb",Bn="srgb-linear",V0="display-p3",xp="display-p3-linear",Mp="linear",Wt="srgb",wp="rec709",Sp="p3",Vc=7680,f1="300 es",ds=2e3;class Hc{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Xn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const zo=Math.PI/180,zc=180/Math.PI;function Ni(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Xn[255&n]+Xn[n>>8&255]+Xn[n>>16&255]+Xn[n>>24&255]+"-"+Xn[255&e]+Xn[e>>8&255]+"-"+Xn[e>>16&15|64]+Xn[e>>24&255]+"-"+Xn[63&t|128]+Xn[t>>8&255]+"-"+Xn[t>>16&255]+Xn[t>>24&255]+Xn[255&i]+Xn[i>>8&255]+Xn[i>>16&255]+Xn[i>>24&255]).toLowerCase()}function Qt(n,e,t){return Math.max(e,Math.min(t,n))}function z0(n,e){return(n%e+e)%e}function ad(n,e,t){return(1-t)*n+t*e}function G0(n){return 0==(n&n-1)&&0!==n}function m1(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Tp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Mi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function it(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const hq_radToDeg=function uq(n){return n*zc};class K{constructor(e=0,t=0){K.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Qt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ct{constructor(e,t,i,r,s,o,a,c,l){ct.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l)}set(e,t,i,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],v=r[0],g=r[3],m=r[6],_=r[1],y=r[4],x=r[7],M=r[2],S=r[5],b=r[8];return s[0]=o*v+a*_+c*M,s[3]=o*g+a*y+c*S,s[6]=o*m+a*x+c*b,s[1]=l*v+u*_+d*M,s[4]=l*g+u*y+d*S,s[7]=l*m+u*x+d*b,s[2]=h*v+f*_+p*M,s[5]=h*g+f*y+p*S,s[8]=h*m+f*x+p*b,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*o-a*l,h=a*c-u*s,f=l*s-o*c,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=d*v,e[1]=(r*l-u*i)*v,e[2]=(a*i-r*o)*v,e[3]=h*v,e[4]=(u*t-r*c)*v,e[5]=(r*s-a*t)*v,e[6]=f*v,e[7]=(i*c-l*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(W0.makeScale(e,t)),this}rotate(e){return this.premultiply(W0.makeRotation(-e)),this}translate(e,t){return this.premultiply(W0.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const W0=new ct;function g1(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function cd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function pq(){const n=cd("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const v1={};function ld(n){n in v1||(v1[n]=!0,console.warn(n))}const y1=(new ct).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),_1=(new ct).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Cp={[Bn]:{transfer:Mp,primaries:wp,toReference:n=>n,fromReference:n=>n},[Gt]:{transfer:Wt,primaries:wp,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[xp]:{transfer:Mp,primaries:Sp,toReference:n=>n.applyMatrix3(_1),fromReference:n=>n.applyMatrix3(y1)},[V0]:{transfer:Wt,primaries:Sp,toReference:n=>n.convertSRGBToLinear().applyMatrix3(_1),fromReference:n=>n.applyMatrix3(y1).convertLinearToSRGB()}},mq=new Set([Bn,xp]),bt={enabled:!0,_workingColorSpace:Bn,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!mq.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,Cp[t].fromReference)((0,Cp[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Cp[n].primaries},getTransfer:function(n){return""===n?Mp:Cp[n].transfer}};function Wc(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function j0(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let jc;class x1{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jc&&(jc=cd("canvas")),jc.width=e.width,jc.height=e.height;const i=jc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=jc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=cd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Wc(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Wc(t[i]/255)):Wc(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let gq=0;class $c{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:gq++}),this.uuid=Ni(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push($0(r[o].isDataTexture?r[o].image:r[o]))}else s=$0(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function $0(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?x1.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let vq=0,hr=(()=>{class n extends Hc{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=qn,s=qn,o=Jt,a=ls,c=$i,l=qs,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:vq++}),this.uuid=Ni(),this.name="",this.source=new $c(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new K(0,0),this.repeat=new K(1,1),this.center=new K(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ct,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof d?this.colorSpace=d:(ld("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Vo?Gt:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Uo:t.x=t.x-Math.floor(t.x);break;case qn:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Uo:t.y=t.y-Math.floor(t.y);break;case qn:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return ld("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Gt?Vo:3e3}set encoding(t){ld("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Vo?Gt:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class It{constructor(e=0,t=0,i=0,r=1){It.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,l=c[0],u=c[4],d=c[8],h=c[1],f=c[5],p=c[9],v=c[2],g=c[6],m=c[10];if(Math.abs(u-h)<.01&&Math.abs(d-v)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+v)<.1&&Math.abs(p+g)<.1&&Math.abs(l+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(l+1)/2,x=(f+1)/2,M=(m+1)/2,S=(u+h)/4,b=(d+v)/4,I=(p+g)/4;return y>x&&y>M?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=b/i):x>M?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=S/r,s=I/r):M<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),i=b/s,r=I/s),this.set(i,r,s,t),this}let _=Math.sqrt((g-p)*(g-p)+(d-v)*(d-v)+(h-u)*(h-u));return Math.abs(_)<.001&&(_=1),this.x=(g-p)/_,this.y=(d-v)/_,this.z=(h-u)/_,this.w=Math.acos((l+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yq extends Hc{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new It(0,0,e,t),this.scissorTest=!1,this.viewport=new It(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(ld("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Vo?Gt:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Jt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new hr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new $c(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Go extends yq{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class q0 extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class M1 extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class oi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=v);if(d!==v||c!==h||l!==f||u!==p){let g=1-a;const m=c*h+l*f+u*p+d*v,_=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){const M=Math.sqrt(y),S=Math.atan2(M,m*_);g=Math.sin(g*S)/M,a=Math.sin(a*S)/M}const x=a*_;if(c=c*g+h*x,l=l*g+f*x,u=u*g+p*x,d=d*g+v*x,g===1-a){const M=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=M,l*=M,u*=M,d*=M}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+c*f-l*h,e[t+1]=c*p+u*h+l*d-a*f,e[t+2]=l*p+u*f+a*h-c*d,e[t+3]=u*p-a*d-c*h-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),d=a(s/2),h=c(i/2),f=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=h*u*d+l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d+h*f*p;break;case"YZX":this._x=h*u*d+l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d-h*f*p;break;case"XZY":this._x=h*u*d-l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),d=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(e=0,t=0,i=0){A.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(w1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(w1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=2*(o*r-a*i),u=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+c*l+o*d-a*u,this.y=i+c*u+a*l-s*d,this.z=r+c*d+s*u-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return X0.copy(this).projectOnVector(e),this.sub(X0)}reflect(e){return this.sub(X0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Qt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const X0=new A,w1=new oi;class fr{constructor(e=new A(1/0,1/0,1/0),t=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(pr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(pr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=pr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let o=0,a=s.count;o<a;o++)!0===e.isMesh?e.getVertexPosition(o,pr):pr.fromBufferAttribute(s,o),pr.applyMatrix4(e.matrixWorld),this.expandByPoint(pr);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Ap.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),Ap.copy(i.boundingBox)),Ap.applyMatrix4(e.matrixWorld),this.union(Ap)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,pr),pr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ud),Dp.subVectors(this.max,ud),qc.subVectors(e.a,ud),Xc.subVectors(e.b,ud),Yc.subVectors(e.c,ud),Ys.subVectors(Xc,qc),Zs.subVectors(Yc,Xc),Wo.subVectors(qc,Yc);let t=[0,-Ys.z,Ys.y,0,-Zs.z,Zs.y,0,-Wo.z,Wo.y,Ys.z,0,-Ys.x,Zs.z,0,-Zs.x,Wo.z,0,-Wo.x,-Ys.y,Ys.x,0,-Zs.y,Zs.x,0,-Wo.y,Wo.x,0];return!(!Y0(t,qc,Xc,Yc,Dp)||(t=[1,0,0,0,1,0,0,0,1],!Y0(t,qc,Xc,Yc,Dp)))&&(Ip.crossVectors(Ys,Zs),t=[Ip.x,Ip.y,Ip.z],Y0(t,qc,Xc,Yc,Dp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,pr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(pr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(hs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hs=[new A,new A,new A,new A,new A,new A,new A,new A],pr=new A,Ap=new fr,qc=new A,Xc=new A,Yc=new A,Ys=new A,Zs=new A,Wo=new A,ud=new A,Dp=new A,Ip=new A,jo=new A;function Y0(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){jo.fromArray(n,s);const a=r.x*Math.abs(jo.x)+r.y*Math.abs(jo.y)+r.z*Math.abs(jo.z),c=e.dot(jo),l=t.dot(jo),u=i.dot(jo);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const _q=new fr,dd=new A,Z0=new A;class mr{constructor(e=new A,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):_q.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;dd.subVectors(e,this.center);const t=dd.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(dd,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Z0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(dd.copy(e.center).add(Z0)),this.expandByPoint(dd.copy(e.center).sub(Z0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const fs=new A,K0=new A,Rp=new A,Ks=new A,J0=new A,Pp=new A,Q0=new A;class hd{constructor(e=new A,t=new A(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fs.copy(this.origin).addScaledVector(this.direction,t),fs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){K0.copy(e).add(t).multiplyScalar(.5),Rp.copy(t).sub(e).normalize(),Ks.copy(this.origin).sub(K0);const s=.5*e.distanceTo(t),o=-this.direction.dot(Rp),a=Ks.dot(this.direction),c=-Ks.dot(Rp),l=Ks.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*c-a,h=o*a-c,p=s*u,d>=0)if(h>=-p)if(h<=p){const v=1/u;d*=v,h*=v,f=d*(d+o*h+2*a)+h*(o*d+h+2*c)+l}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-c),s),f=-d*d+h*(h+2*c)+l):h<=p?(d=0,h=Math.min(Math.max(-s,-c),s),f=h*(h+2*c)+l):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-c),s),f=-d*d+h*(h+2*c)+l);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(K0).addScaledVector(Rp,h),f}intersectSphere(e,t){fs.subVectors(e.center,this.origin);const i=fs.dot(this.direction),r=fs.dot(fs)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,c=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,c=(e.min.z-h.z)*d),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,fs)}intersectTriangle(e,t,i,r,s){J0.subVectors(t,e),Pp.subVectors(i,e),Q0.crossVectors(J0,Pp);let a,o=this.direction.dot(Q0);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Ks.subVectors(this.origin,e);const c=a*this.direction.dot(Pp.crossVectors(Ks,Pp));if(c<0)return null;const l=a*this.direction.dot(J0.cross(Ks));if(l<0||c+l>o)return null;const u=-a*Ks.dot(Q0);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class We{constructor(e,t,i,r,s,o,a,c,l,u,d,h,f,p,v,g){We.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l,u,d,h,f,p,v,g)}set(e,t,i,r,s,o,a,c,l,u,d,h,f,p,v,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=c,m[2]=l,m[6]=u,m[10]=d,m[14]=h,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new We).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Zc.setFromMatrixColumn(e,0).length(),s=1/Zc.setFromMatrixColumn(e,1).length(),o=1/Zc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,v=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=f+p*l,t[5]=h-v*l,t[9]=-a*c,t[2]=v-h*l,t[6]=p+f*l,t[10]=o*c}else if("YXZ"===e.order){const h=c*u,f=c*d,p=l*u,v=l*d;t[0]=h+v*a,t[4]=p*a-f,t[8]=o*l,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=v+h*a,t[10]=o*c}else if("ZXY"===e.order){const h=c*u,f=c*d,p=l*u,v=l*d;t[0]=h-v*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=v-h*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,v=a*d;t[0]=c*u,t[4]=p*l-f,t[8]=h*l+v,t[1]=c*d,t[5]=v*l+h,t[9]=f*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const h=o*c,f=o*l,p=a*c,v=a*l;t[0]=c*u,t[4]=v-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*d+p,t[10]=h-v*d}else if("XZY"===e.order){const h=o*c,f=o*l,p=a*c,v=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=h*d+v,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=v*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(xq,e,Mq)}lookAt(e,t,i){const r=this.elements;return Li.subVectors(e,t),0===Li.lengthSq()&&(Li.z=1),Li.normalize(),Js.crossVectors(i,Li),0===Js.lengthSq()&&(1===Math.abs(i.z)?Li.x+=1e-4:Li.z+=1e-4,Li.normalize(),Js.crossVectors(i,Li)),Js.normalize(),Np.crossVectors(Li,Js),r[0]=Js.x,r[4]=Np.x,r[8]=Li.x,r[1]=Js.y,r[5]=Np.y,r[9]=Li.y,r[2]=Js.z,r[6]=Np.z,r[10]=Li.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],v=i[6],g=i[10],m=i[14],_=i[3],y=i[7],x=i[11],M=i[15],S=r[0],b=r[4],I=r[8],w=r[12],T=r[1],F=r[5],W=r[9],Y=r[13],P=r[2],U=r[6],G=r[10],j=r[14],ie=r[3],Z=r[7],Q=r[11],L=r[15];return s[0]=o*S+a*T+c*P+l*ie,s[4]=o*b+a*F+c*U+l*Z,s[8]=o*I+a*W+c*G+l*Q,s[12]=o*w+a*Y+c*j+l*L,s[1]=u*S+d*T+h*P+f*ie,s[5]=u*b+d*F+h*U+f*Z,s[9]=u*I+d*W+h*G+f*Q,s[13]=u*w+d*Y+h*j+f*L,s[2]=p*S+v*T+g*P+m*ie,s[6]=p*b+v*F+g*U+m*Z,s[10]=p*I+v*W+g*G+m*Q,s[14]=p*w+v*Y+g*j+m*L,s[3]=_*S+y*T+x*P+M*ie,s[7]=_*b+y*F+x*U+M*Z,s[11]=_*I+y*W+x*G+M*Q,s[15]=_*w+y*Y+x*j+M*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*c*d-r*l*d-s*a*h+i*l*h+r*a*f-i*c*f)+e[7]*(+t*c*f-t*l*h+s*o*h-r*o*f+r*l*u-s*c*u)+e[11]*(+t*l*d-t*a*f-s*o*d+i*o*f+s*a*u-i*l*u)+e[15]*(-r*a*u-t*c*d+t*a*h+r*o*d-i*o*h+i*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],_=d*g*l-v*h*l+v*c*f-a*g*f-d*c*m+a*h*m,y=p*h*l-u*g*l-p*c*f+o*g*f+u*c*m-o*h*m,x=u*v*l-p*d*l+p*a*f-o*v*f-u*a*m+o*d*m,M=p*d*c-u*v*c-p*a*h+o*v*h+u*a*g-o*d*g,S=t*_+i*y+r*x+s*M;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/S;return e[0]=_*b,e[1]=(v*h*s-d*g*s-v*r*f+i*g*f+d*r*m-i*h*m)*b,e[2]=(a*g*s-v*c*s+v*r*l-i*g*l-a*r*m+i*c*m)*b,e[3]=(d*c*s-a*h*s-d*r*l+i*h*l+a*r*f-i*c*f)*b,e[4]=y*b,e[5]=(u*g*s-p*h*s+p*r*f-t*g*f-u*r*m+t*h*m)*b,e[6]=(p*c*s-o*g*s-p*r*l+t*g*l+o*r*m-t*c*m)*b,e[7]=(o*h*s-u*c*s+u*r*l-t*h*l-o*r*f+t*c*f)*b,e[8]=x*b,e[9]=(p*d*s-u*v*s-p*i*f+t*v*f+u*i*m-t*d*m)*b,e[10]=(o*v*s-p*a*s+p*i*l-t*v*l-o*i*m+t*a*m)*b,e[11]=(u*a*s-o*d*s-u*i*l+t*d*l+o*i*f-t*a*f)*b,e[12]=M*b,e[13]=(u*v*r-p*d*r+p*i*h-t*v*h-u*i*g+t*d*g)*b,e[14]=(p*a*r-o*v*r-p*i*c+t*v*c+o*i*g-t*a*g)*b,e[15]=(o*d*r-u*a*r+u*i*c-t*d*c-o*i*h+t*a*h)*b,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,d=a+a,h=s*l,f=s*u,p=s*d,v=o*u,g=o*d,m=a*d,_=c*l,y=c*u,x=c*d,M=i.x,S=i.y,b=i.z;return r[0]=(1-(v+m))*M,r[1]=(f+x)*M,r[2]=(p-y)*M,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(h+m))*S,r[6]=(g+_)*S,r[7]=0,r[8]=(p+y)*b,r[9]=(g-_)*b,r[10]=(1-(h+v))*b,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Zc.set(r[0],r[1],r[2]).length();const o=Zc.set(r[4],r[5],r[6]).length(),a=Zc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],gr.copy(this);const l=1/s,u=1/o,d=1/a;return gr.elements[0]*=l,gr.elements[1]*=l,gr.elements[2]*=l,gr.elements[4]*=u,gr.elements[5]*=u,gr.elements[6]*=u,gr.elements[8]*=d,gr.elements[9]*=d,gr.elements[10]*=d,t.setFromRotationMatrix(gr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=ds){const c=this.elements,l=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),h=(i+r)/(i-r);let f,p;if(a===ds)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return c[0]=l,c[4]=0,c[8]=d,c[12]=0,c[1]=0,c[5]=u,c[9]=h,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=ds){const c=this.elements,l=1/(t-e),u=1/(i-r),d=1/(o-s),h=(t+e)*l,f=(i+r)*u;let p,v;if(a===ds)p=(o+s)*d,v=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*d,v=-1*d}return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-h,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=v,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Zc=new A,gr=new We,xq=new A(0,0,0),Mq=new A(1,1,1),Js=new A,Np=new A,Li=new A,S1=new We,E1=new oi;let wq=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(Qt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Qt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Qt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Qt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Qt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-Qt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return S1.makeRotationFromQuaternion(t),this.setFromRotationMatrix(S1,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return E1.setFromEuler(this),this.setFromQuaternion(E1,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class ex{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Sq=0;const b1=new A,Kc=new oi,ps=new We,Lp=new A,fd=new A,Eq=new A,bq=new oi,T1=new A(1,0,0),C1=new A(0,1,0),A1=new A(0,0,1),Tq={type:"added"},Cq={type:"removed"};let Nn=(()=>{class n extends Hc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Sq++}),this.uuid=Ni(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new A,i=new wq,r=new oi,s=new A(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new We},normalMatrix:{value:new ct}}),this.matrix=new We,this.matrixWorld=new We,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ex,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Kc.setFromAxisAngle(t,i),this.quaternion.multiply(Kc),this}rotateOnWorldAxis(t,i){return Kc.setFromAxisAngle(t,i),this.quaternion.premultiply(Kc),this}rotateX(t){return this.rotateOnAxis(T1,t)}rotateY(t){return this.rotateOnAxis(C1,t)}rotateZ(t){return this.rotateOnAxis(A1,t)}translateOnAxis(t,i){return b1.copy(t).applyQuaternion(this.quaternion),this.position.add(b1.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(T1,t)}translateY(t){return this.translateOnAxis(C1,t)}translateZ(t){return this.translateOnAxis(A1,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(ps.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?Lp.copy(t):Lp.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),fd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ps.lookAt(fd,Lp,this.up):ps.lookAt(Lp,fd,this.up),this.quaternion.setFromRotationMatrix(ps),s&&(ps.extractRotation(s.matrixWorld),Kc.setFromRotationMatrix(ps),this.quaternion.premultiply(Kc.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Tq)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Cq)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),ps.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ps.multiply(t.parent.matrixWorld)),t.applyMatrix4(ps),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fd,t,Eq),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fd,bq,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),v=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(c){const l=[];for(const u in c){const d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new A(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const vr=new A,ms=new A,tx=new A,gs=new A,Jc=new A,Qc=new A,D1=new A,nx=new A,ix=new A,rx=new A;let Op=!1;class Oi{constructor(e=new A,t=new A,i=new A){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),vr.subVectors(e,t),r.cross(vr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){vr.subVectors(r,t),ms.subVectors(i,t),tx.subVectors(e,t);const o=vr.dot(vr),a=vr.dot(ms),c=vr.dot(tx),l=ms.dot(ms),u=ms.dot(tx),d=o*l-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(l*c-a*u)*h,p=(o*u-a*c)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,gs),gs.x>=0&&gs.y>=0&&gs.x+gs.y<=1}static getUV(e,t,i,r,s,o,a,c){return!1===Op&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Op=!0),this.getInterpolation(e,t,i,r,s,o,a,c)}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,gs),c.setScalar(0),c.addScaledVector(s,gs.x),c.addScaledVector(o,gs.y),c.addScaledVector(a,gs.z),c}static isFrontFacing(e,t,i,r){return vr.subVectors(i,t),ms.subVectors(e,t),vr.cross(ms).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vr.subVectors(this.c,this.b),ms.subVectors(this.a,this.b),.5*vr.cross(ms).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Oi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Oi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===Op&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Op=!0),Oi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Oi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Oi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Oi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Jc.subVectors(r,i),Qc.subVectors(s,i),nx.subVectors(e,i);const c=Jc.dot(nx),l=Qc.dot(nx);if(c<=0&&l<=0)return t.copy(i);ix.subVectors(e,r);const u=Jc.dot(ix),d=Qc.dot(ix);if(u>=0&&d<=u)return t.copy(r);const h=c*d-u*l;if(h<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(Jc,o);rx.subVectors(e,s);const f=Jc.dot(rx),p=Qc.dot(rx);if(p>=0&&f<=p)return t.copy(s);const v=f*l-c*p;if(v<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(Qc,a);const g=u*p-f*d;if(g<=0&&d-u>=0&&f-p>=0)return D1.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(D1,a);const m=1/(g+v+h);return o=v*m,a=h*m,t.copy(i).addScaledVector(Jc,o).addScaledVector(Qc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const I1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Qs={h:0,s:0,l:0},Fp={h:0,s:0,l:0};function sx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class me{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Gt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,bt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=bt.workingColorSpace){return this.r=e,this.g=t,this.b=i,bt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=bt.workingColorSpace){if(e=z0(e,1),t=Qt(t,0,1),i=Qt(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=sx(o,s,e+1/3),this.g=sx(o,s,e),this.b=sx(o,s,e-1/3)}return bt.toWorkingColorSpace(this,r),this}setStyle(e,t=Gt){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Gt){const i=I1[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wc(e.r),this.g=Wc(e.g),this.b=Wc(e.b),this}copyLinearToSRGB(e){return this.r=j0(e.r),this.g=j0(e.g),this.b=j0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Gt){return bt.fromWorkingColorSpace(Yn.copy(this),e),65536*Math.round(Qt(255*Yn.r,0,255))+256*Math.round(Qt(255*Yn.g,0,255))+Math.round(Qt(255*Yn.b,0,255))}getHexString(e=Gt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=bt.workingColorSpace){bt.fromWorkingColorSpace(Yn.copy(this),t);const i=Yn.r,r=Yn.g,s=Yn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,l;const u=(a+o)/2;if(a===o)c=0,l=0;else{const d=o-a;switch(l=u<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=bt.workingColorSpace){return bt.fromWorkingColorSpace(Yn.copy(this),t),e.r=Yn.r,e.g=Yn.g,e.b=Yn.b,e}getStyle(e=Gt){bt.fromWorkingColorSpace(Yn.copy(this),e);const t=Yn.r,i=Yn.g,r=Yn.b;return e!==Gt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Qs),this.setHSL(Qs.h+e,Qs.s+t,Qs.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Qs),e.getHSL(Fp);const i=ad(Qs.h,Fp.h,t),r=ad(Qs.s,Fp.s,t),s=ad(Qs.l,Fp.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Yn=new me;me.NAMES=I1;let Aq=0;class yr extends Hc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Aq++}),this.uuid=Ni(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new me(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Vc,this.stencilZFail=Vc,this.stencilZPass=Vc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Vc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Vc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Vc&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Xi extends yr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=mp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _n=new A,Up=new K;class en{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=us,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Up.fromBufferAttribute(this,t),Up.applyMatrix3(e),this.setXY(t,Up.x,Up.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix3(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix4(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyNormalMatrix(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.transformDirection(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Mi(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=it(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Mi(t,this.array)),t}setX(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Mi(t,this.array)),t}setY(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Mi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Mi(t,this.array)),t}setW(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array),s=it(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class R1 extends en{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class P1 extends en{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ce extends en{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Iq=0;const Yi=new We,ox=new Nn,el=new A,Fi=new fr,md=new fr,Ln=new A;class ut extends Hc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Iq++}),this.uuid=Ni(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(g1(e)?P1:R1)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new ct).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Yi.makeRotationFromQuaternion(e),this.applyMatrix4(Yi),this}rotateX(e){return Yi.makeRotationX(e),this.applyMatrix4(Yi),this}rotateY(e){return Yi.makeRotationY(e),this.applyMatrix4(Yi),this}rotateZ(e){return Yi.makeRotationZ(e),this.applyMatrix4(Yi),this}translate(e,t,i){return Yi.makeTranslation(e,t,i),this.applyMatrix4(Yi),this}scale(e,t,i){return Yi.makeScale(e,t,i),this.applyMatrix4(Yi),this}lookAt(e){return ox.lookAt(e),ox.updateMatrix(),this.applyMatrix4(ox.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(el).negate(),this.translate(el.x,el.y,el.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ce(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Fi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Ln.addVectors(this.boundingBox.min,Fi.min),this.boundingBox.expandByPoint(Ln),Ln.addVectors(this.boundingBox.max,Fi.max),this.boundingBox.expandByPoint(Ln)):(this.boundingBox.expandByPoint(Fi.min),this.boundingBox.expandByPoint(Fi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new mr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new A,1/0);if(e){const i=this.boundingSphere.center;if(Fi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)md.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Ln.addVectors(Fi.min,md.min),Fi.expandByPoint(Ln),Ln.addVectors(Fi.max,md.max),Fi.expandByPoint(Ln)):(Fi.expandByPoint(md.min),Fi.expandByPoint(md.max));Fi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ln.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ln));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Ln.fromBufferAttribute(a,l),c&&(el.fromBufferAttribute(e,l),Ln.add(el)),r=Math.max(r,i.distanceToSquared(Ln))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new en(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let T=0;T<a;T++)l[T]=new A,u[T]=new A;const d=new A,h=new A,f=new A,p=new K,v=new K,g=new K,m=new A,_=new A;function y(T,F,W){d.fromArray(r,3*T),h.fromArray(r,3*F),f.fromArray(r,3*W),p.fromArray(o,2*T),v.fromArray(o,2*F),g.fromArray(o,2*W),h.sub(d),f.sub(d),v.sub(p),g.sub(p);const Y=1/(v.x*g.y-g.x*v.y);isFinite(Y)&&(m.copy(h).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(Y),_.copy(f).multiplyScalar(v.x).addScaledVector(h,-g.x).multiplyScalar(Y),l[T].add(m),l[F].add(m),l[W].add(m),u[T].add(_),u[F].add(_),u[W].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:i.length}]);for(let T=0,F=x.length;T<F;++T){const W=x[T],Y=W.start;for(let U=Y,G=Y+W.count;U<G;U+=3)y(i[U+0],i[U+1],i[U+2])}const M=new A,S=new A,b=new A,I=new A;function w(T){b.fromArray(s,3*T),I.copy(b);const F=l[T];M.copy(F),M.sub(b.multiplyScalar(b.dot(F))).normalize(),S.crossVectors(I,F);const Y=S.dot(u[T])<0?-1:1;c[4*T]=M.x,c[4*T+1]=M.y,c[4*T+2]=M.z,c[4*T+3]=Y}for(let T=0,F=x.length;T<F;++T){const W=x[T],Y=W.start;for(let U=Y,G=Y+W.count;U<G;U+=3)w(i[U+0]),w(i[U+1]),w(i[U+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new en(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new A,s=new A,o=new A,a=new A,c=new A,l=new A,u=new A,d=new A;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),v=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,v),l.fromBufferAttribute(i,g),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,c.x,c.y,c.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ln.fromBufferAttribute(e,t),Ln.normalize(),e.setXYZ(t,Ln.x,Ln.y,Ln.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,d=a.normalized,h=new l.constructor(c.length*u);let f=0,p=0;for(let v=0,g=c.length;v<g;v++){f=a.isInterleavedBufferAttribute?c[v]*a.data.stride+a.offset:c[v]*u;for(let m=0;m<u;m++)h[p++]=l[f++]}return new en(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ut,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,d=l.length;u<d;u++){const f=e(l[u],i);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let d=0,h=l.length;d<h;d++)u.push(l[d].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],d=s[l];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const d=o[l];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const N1=new We,$o=new hd,kp=new mr,L1=new A,tl=new A,nl=new A,il=new A,ax=new A,Bp=new A,Vp=new K,Hp=new K,zp=new K,O1=new A,F1=new A,U1=new A,Gp=new A,Wp=new A;class Zn extends Nn{constructor(e=new ut,t=new Xi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Bp.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=a[c];0!==u&&(ax.fromBufferAttribute(s[c],e),Bp.addScaledVector(o?ax:ax.sub(t),u))}t.add(Bp)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),kp.copy(i.boundingSphere),kp.applyMatrix4(s),$o.copy(e.ray).recast(e.near),(!1!==kp.containsPoint($o.origin)||!(null===$o.intersectSphere(kp,L1)||$o.origin.distanceToSquared(L1)>(e.far-e.near)**2))&&(N1.copy(s).invert(),$o.copy(e.ray).applyMatrix4(N1),(null===i.boundingBox||!1!==$o.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,$o)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){const g=h[p],m=o[g.materialIndex];for(let x=Math.max(g.start,f.start),M=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));x<M;x+=3)r=jp(this,m,e,i,l,u,d,a.getX(x),a.getX(x+1),a.getX(x+2)),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);g<m;g+=3)r=jp(this,o,e,i,l,u,d,a.getX(g),a.getX(g+1),a.getX(g+2)),r&&(r.faceIndex=Math.floor(g/3),t.push(r));else if(void 0!==c)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){const g=h[p],m=o[g.materialIndex];for(let x=Math.max(g.start,f.start),M=Math.min(c.count,Math.min(g.start+g.count,f.start+f.count));x<M;x+=3)r=jp(this,m,e,i,l,u,d,x,x+1,x+2),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(c.count,f.start+f.count);g<m;g+=3)r=jp(this,o,e,i,l,u,d,g,g+1,g+2),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}function jp(n,e,t,i,r,s,o,a,c,l){n.getVertexPosition(a,tl),n.getVertexPosition(c,nl),n.getVertexPosition(l,il);const u=function Rq(n,e,t,i,r,s,o,a){let c;if(c=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===c)return null;Wp.copy(a),Wp.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(Wp);return l<t.near||l>t.far?null:{distance:l,point:Wp.clone(),object:n}}(n,e,t,i,tl,nl,il,Gp);if(u){r&&(Vp.fromBufferAttribute(r,a),Hp.fromBufferAttribute(r,c),zp.fromBufferAttribute(r,l),u.uv=Oi.getInterpolation(Gp,tl,nl,il,Vp,Hp,zp,new K)),s&&(Vp.fromBufferAttribute(s,a),Hp.fromBufferAttribute(s,c),zp.fromBufferAttribute(s,l),u.uv1=Oi.getInterpolation(Gp,tl,nl,il,Vp,Hp,zp,new K),u.uv2=u.uv1),o&&(O1.fromBufferAttribute(o,a),F1.fromBufferAttribute(o,c),U1.fromBufferAttribute(o,l),u.normal=Oi.getInterpolation(Gp,tl,nl,il,O1,F1,U1,new A),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:c,c:l,normal:new A,materialIndex:0};Oi.getNormal(tl,nl,il,d.normal),u.face=d}return u}class rl extends ut{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],d=[];let h=0,f=0;function p(v,g,m,_,y,x,M,S,b,I,w){const T=x/b,F=M/I,W=x/2,Y=M/2,P=S/2,U=b+1,G=I+1;let j=0,ie=0;const Z=new A;for(let Q=0;Q<G;Q++){const L=Q*F-Y;for(let $=0;$<U;$++)Z[v]=($*T-W)*_,Z[g]=L*y,Z[m]=P,l.push(Z.x,Z.y,Z.z),Z[v]=0,Z[g]=0,Z[m]=S>0?1:-1,u.push(Z.x,Z.y,Z.z),d.push($/b),d.push(1-Q/I),j+=1}for(let Q=0;Q<I;Q++)for(let L=0;L<b;L++){const de=h+L+U*(Q+1),ge=h+(L+1)+U*(Q+1),ye=h+(L+1)+U*Q;c.push(h+L+U*Q,de,ye),c.push(de,ge,ye),ie+=6}a.addGroup(f,ie,w),f+=ie,h+=j}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Ce(l,3)),this.setAttribute("normal",new Ce(u,3)),this.setAttribute("uv",new Ce(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function sl(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ai(n){const e={};for(let t=0;t<n.length;t++){const i=sl(n[t]);for(const r in i)e[r]=i[r]}return e}function k1(n){return null===n.getRenderTarget()?n.outputColorSpace:bt.workingColorSpace}const Nq={clone:sl,merge:ai};class eo extends yr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sl(e.uniforms),this.uniformsGroups=function Pq(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class cx extends Nn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new We,this.projectionMatrix=new We,this.projectionMatrixInverse=new We,this.coordinateSystem=ds}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class On extends cx{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*zc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*zo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*zc*Math.atan(Math.tan(.5*zo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*zo*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Fq extends Nn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new On(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new On(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new On(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new On(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new On(-90,1,e,t);c.layers=this.layers,this.add(c);const l=new On(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const l of t)this.remove(l);if(e===ds)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,c,l,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,l),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,h,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class $p extends hr{constructor(e,t,i,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:$s,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Uq extends Go{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(ld("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Vo?Gt:""),this.texture=new $p(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Jt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new rl(5,5,5),s=new eo({name:"CubemapFromEquirect",uniforms:sl(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Zn(r,s),a=t.minFilter;return t.minFilter===ls&&(t.minFilter=Jt),new Fq(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const lx=new A,kq=new A,Bq=new ct;class qo{constructor(e=new A(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=lx.subVectors(i,t).cross(kq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(lx),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Bq.getNormalMatrix(e),r=this.coplanarPoint(lx).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Xo=new mr,qp=new A;class ux{constructor(e=new qo,t=new qo,i=new qo,r=new qo,s=new qo,o=new qo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ds){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],v=r[10],g=r[11],m=r[12],_=r[13],y=r[14],x=r[15];if(i[0].setComponents(c-s,h-l,g-f,x-m).normalize(),i[1].setComponents(c+s,h+l,g+f,x+m).normalize(),i[2].setComponents(c+o,h+u,g+p,x+_).normalize(),i[3].setComponents(c-o,h-u,g-p,x-_).normalize(),i[4].setComponents(c-a,h-d,g-v,x-y).normalize(),t===ds)i[5].setComponents(c+a,h+d,g+v,x+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,v,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Xo.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Xo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Xo)}intersectsSprite(e){return Xo.center.set(0,0,0),Xo.radius=.7071067811865476,Xo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Xo)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(qp.x=r.normal.x>0?e.max.x:e.min.x,qp.y=r.normal.y>0?e.max.y:e.min.y,qp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(qp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function B1(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Vq(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(n.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const h=i.get(l);return void((!h||h.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const d=i.get(l);void 0===d?i.set(l,function r(l,u){const d=l.array,h=l.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),l.onUploadCallback(),d instanceof Float32Array)p=n.FLOAT;else if(d instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=n.HALF_FLOAT}else p=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)p=n.SHORT;else if(d instanceof Uint32Array)p=n.UNSIGNED_INT;else if(d instanceof Int32Array)p=n.INT;else if(d instanceof Int8Array)p=n.BYTE;else if(d instanceof Uint8Array)p=n.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=n.UNSIGNED_BYTE}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:l.version}}(l,u)):d.version<l.version&&(function s(l,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,l),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,l,u),d.version=l.version)}}}class Xp extends ut{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,d=e/a,h=t/c,f=[],p=[],v=[],g=[];for(let m=0;m<u;m++){const _=m*h-o;for(let y=0;y<l;y++)p.push(y*d-s,-_,0),v.push(0,0,1),g.push(y/a),g.push(1-m/c)}for(let m=0;m<c;m++)for(let _=0;_<a;_++){const x=_+l*(m+1),M=_+1+l*(m+1),S=_+1+l*m;f.push(_+l*m,x,S),f.push(x,M,S)}this.setIndex(f),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(v,3)),this.setAttribute("uv",new Ce(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xp(e.width,e.height,e.widthSegments,e.heightSegments)}}const st={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},pe={common:{diffuse:{value:new me(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ct}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ct}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ct}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ct},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ct},normalScale:{value:new K(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ct},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ct}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ct}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ct}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new me(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new me(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0},uvTransform:{value:new ct}},sprite:{diffuse:{value:new me(16777215)},opacity:{value:1},center:{value:new K(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}}},Br={basic:{uniforms:ai([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.fog]),vertexShader:st.meshbasic_vert,fragmentShader:st.meshbasic_frag},lambert:{uniforms:ai([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,pe.lights,{emissive:{value:new me(0)}}]),vertexShader:st.meshlambert_vert,fragmentShader:st.meshlambert_frag},phong:{uniforms:ai([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,pe.lights,{emissive:{value:new me(0)},specular:{value:new me(1118481)},shininess:{value:30}}]),vertexShader:st.meshphong_vert,fragmentShader:st.meshphong_frag},standard:{uniforms:ai([pe.common,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.roughnessmap,pe.metalnessmap,pe.fog,pe.lights,{emissive:{value:new me(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:st.meshphysical_vert,fragmentShader:st.meshphysical_frag},toon:{uniforms:ai([pe.common,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.gradientmap,pe.fog,pe.lights,{emissive:{value:new me(0)}}]),vertexShader:st.meshtoon_vert,fragmentShader:st.meshtoon_frag},matcap:{uniforms:ai([pe.common,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,{matcap:{value:null}}]),vertexShader:st.meshmatcap_vert,fragmentShader:st.meshmatcap_frag},points:{uniforms:ai([pe.points,pe.fog]),vertexShader:st.points_vert,fragmentShader:st.points_frag},dashed:{uniforms:ai([pe.common,pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:st.linedashed_vert,fragmentShader:st.linedashed_frag},depth:{uniforms:ai([pe.common,pe.displacementmap]),vertexShader:st.depth_vert,fragmentShader:st.depth_frag},normal:{uniforms:ai([pe.common,pe.bumpmap,pe.normalmap,pe.displacementmap,{opacity:{value:1}}]),vertexShader:st.meshnormal_vert,fragmentShader:st.meshnormal_frag},sprite:{uniforms:ai([pe.sprite,pe.fog]),vertexShader:st.sprite_vert,fragmentShader:st.sprite_frag},background:{uniforms:{uvTransform:{value:new ct},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:st.background_vert,fragmentShader:st.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:st.backgroundCube_vert,fragmentShader:st.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:st.cube_vert,fragmentShader:st.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:st.equirect_vert,fragmentShader:st.equirect_frag},distanceRGBA:{uniforms:ai([pe.common,pe.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:st.distanceRGBA_vert,fragmentShader:st.distanceRGBA_frag},shadow:{uniforms:ai([pe.lights,pe.fog,{color:{value:new me(0)},opacity:{value:1}}]),vertexShader:st.shadow_vert,fragmentShader:st.shadow_frag}};Br.physical={uniforms:ai([Br.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ct},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ct},clearcoatNormalScale:{value:new K(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ct},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ct},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ct},sheen:{value:0},sheenColor:{value:new me(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ct},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ct},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ct},transmissionSamplerSize:{value:new K},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ct},attenuationDistance:{value:0},attenuationColor:{value:new me(0)},specularColor:{value:new me(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ct},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ct},anisotropyVector:{value:new K},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ct}}]),vertexShader:st.meshphysical_vert,fragmentShader:st.meshphysical_frag};const Yp={r:0,b:0,g:0};function kX(n,e,t,i,r,s,o){const a=new me(0);let l,u,c=!0===s?0:1,d=null,h=0,f=null;function v(g,m){g.getRGB(Yp,k1(n)),i.buffers.color.setClear(Yp.r,Yp.g,Yp.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),c=m,v(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(g){c=g,v(a,c)},render:function p(g,m){let _=!1,y=!0===m.isScene?m.background:null;y&&y.isTexture&&(y=(m.backgroundBlurriness>0?t:e).get(y)),null===y?v(a,c):y&&y.isColor&&(v(y,1),_=!0);const x=n.xr.getEnvironmentBlendMode();"additive"===x?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===x&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===nd)?(void 0===u&&(u=new Zn(new rl(1,1,1),new eo({name:"BackgroundCubeMaterial",uniforms:sl(Br.backgroundCube.uniforms),vertexShader:Br.backgroundCube.vertexShader,fragmentShader:Br.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,S,b){this.matrixWorld.copyPosition(b.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=bt.getTransfer(y.colorSpace)!==Wt,(d!==y||h!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new Zn(new Xp(2,2),new eo({name:"BackgroundMaterial",uniforms:sl(Br.background.uniforms),vertexShader:Br.background.vertexShader,fragmentShader:Br.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=bt.getTransfer(y.colorSpace)!==Wt,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||h!==y.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),l.layers.enableAll(),g.unshift(l,l.geometry,l.material,0,0,null))}}}function BX(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},c=g(null);let l=c,u=!1;function f(P){return i.isWebGL2?n.bindVertexArray(P):s.bindVertexArrayOES(P)}function p(P){return i.isWebGL2?n.deleteVertexArray(P):s.deleteVertexArrayOES(P)}function g(P){const U=[],G=[],j=[];for(let ie=0;ie<r;ie++)U[ie]=0,G[ie]=0,j[ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:G,attributeDivisors:j,object:P,attributes:{},index:null}}function y(){const P=l.newAttributes;for(let U=0,G=P.length;U<G;U++)P[U]=0}function x(P){M(P,0)}function M(P,U){const j=l.enabledAttributes,ie=l.attributeDivisors;l.newAttributes[P]=1,0===j[P]&&(n.enableVertexAttribArray(P),j[P]=1),ie[P]!==U&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,U),ie[P]=U)}function S(){const P=l.newAttributes,U=l.enabledAttributes;for(let G=0,j=U.length;G<j;G++)U[G]!==P[G]&&(n.disableVertexAttribArray(G),U[G]=0)}function b(P,U,G,j,ie,Z,Q){!0===Q?n.vertexAttribIPointer(P,U,G,ie,Z):n.vertexAttribPointer(P,U,G,j,ie,Z)}function W(){Y(),u=!0,l!==c&&(l=c,f(l.object))}function Y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function d(P,U,G,j,ie){let Z=!1;if(o){const Q=function v(P,U,G){const j=!0===G.wireframe;let ie=a[P.id];void 0===ie&&(ie={},a[P.id]=ie);let Z=ie[U.id];void 0===Z&&(Z={},ie[U.id]=Z);let Q=Z[j];return void 0===Q&&(Q=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),Z[j]=Q),Q}(j,G,U);l!==Q&&(l=Q,f(l.object)),Z=function m(P,U,G,j){const ie=l.attributes,Z=U.attributes;let Q=0;const L=G.getAttributes();for(const $ in L)if(L[$].location>=0){const ge=ie[$];let ye=Z[$];if(void 0===ye&&("instanceMatrix"===$&&P.instanceMatrix&&(ye=P.instanceMatrix),"instanceColor"===$&&P.instanceColor&&(ye=P.instanceColor)),void 0===ge||ge.attribute!==ye||ye&&ge.data!==ye.data)return!0;Q++}return l.attributesNum!==Q||l.index!==j}(P,j,G,ie),Z&&function _(P,U,G,j){const ie={},Z=U.attributes;let Q=0;const L=G.getAttributes();for(const $ in L)if(L[$].location>=0){let ge=Z[$];void 0===ge&&("instanceMatrix"===$&&P.instanceMatrix&&(ge=P.instanceMatrix),"instanceColor"===$&&P.instanceColor&&(ge=P.instanceColor));const ye={};ye.attribute=ge,ge&&ge.data&&(ye.data=ge.data),ie[$]=ye,Q++}l.attributes=ie,l.attributesNum=Q,l.index=j}(P,j,G,ie)}else{const Q=!0===U.wireframe;(l.geometry!==j.id||l.program!==G.id||l.wireframe!==Q)&&(l.geometry=j.id,l.program=G.id,l.wireframe=Q,Z=!0)}null!==ie&&t.update(ie,n.ELEMENT_ARRAY_BUFFER),(Z||u)&&(u=!1,function I(P,U,G,j){if(!1===i.isWebGL2&&(P.isInstancedMesh||j.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const ie=j.attributes,Z=G.getAttributes(),Q=U.defaultAttributeValues;for(const L in Z){const $=Z[L];if($.location>=0){let de=ie[L];if(void 0===de&&("instanceMatrix"===L&&P.instanceMatrix&&(de=P.instanceMatrix),"instanceColor"===L&&P.instanceColor&&(de=P.instanceColor)),void 0!==de){const ge=de.normalized,ye=de.itemSize,Ae=t.get(de);if(void 0===Ae)continue;const Ue=Ae.buffer,Ne=Ae.type,Je=Ae.bytesPerElement,ot=!0===i.isWebGL2&&(Ne===n.INT||Ne===n.UNSIGNED_INT||1013===de.gpuType);if(de.isInterleavedBufferAttribute){const Fe=de.data,R=Fe.stride,fe=de.offset;if(Fe.isInstancedInterleavedBuffer){for(let X=0;X<$.locationSize;X++)M($.location+X,Fe.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===j._maxInstanceCount&&(j._maxInstanceCount=Fe.meshPerAttribute*Fe.count)}else for(let X=0;X<$.locationSize;X++)x($.location+X);n.bindBuffer(n.ARRAY_BUFFER,Ue);for(let X=0;X<$.locationSize;X++)b($.location+X,ye/$.locationSize,Ne,ge,R*Je,(fe+ye/$.locationSize*X)*Je,ot)}else{if(de.isInstancedBufferAttribute){for(let Fe=0;Fe<$.locationSize;Fe++)M($.location+Fe,de.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===j._maxInstanceCount&&(j._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Fe=0;Fe<$.locationSize;Fe++)x($.location+Fe);n.bindBuffer(n.ARRAY_BUFFER,Ue);for(let Fe=0;Fe<$.locationSize;Fe++)b($.location+Fe,ye/$.locationSize,Ne,ge,ye*Je,ye/$.locationSize*Fe*Je,ot)}}else if(void 0!==Q){const ge=Q[L];if(void 0!==ge)switch(ge.length){case 2:n.vertexAttrib2fv($.location,ge);break;case 3:n.vertexAttrib3fv($.location,ge);break;case 4:n.vertexAttrib4fv($.location,ge);break;default:n.vertexAttrib1fv($.location,ge)}}}}S()}(P,U,G,j),null!==ie&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(ie).buffer))},reset:W,resetDefaultState:Y,dispose:function w(){W();for(const P in a){const U=a[P];for(const G in U){const j=U[G];for(const ie in j)p(j[ie].object),delete j[ie];delete U[G]}delete a[P]}},releaseStatesOfGeometry:function T(P){if(void 0===a[P.id])return;const U=a[P.id];for(const G in U){const j=U[G];for(const ie in j)p(j[ie].object),delete j[ie];delete U[G]}delete a[P.id]},releaseStatesOfProgram:function F(P){for(const U in a){const G=a[U];if(void 0===G[P.id])continue;const j=G[P.id];for(const ie in j)p(j[ie].object),delete j[ie];delete G[P.id]}},initAttributes:y,enableAttribute:x,disableUnusedAttributes:S}}function VX(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(l){s=l},this.render=function a(l,u){n.drawArrays(s,l,u),t.update(u,s,1)},this.renderInstances=function c(l,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,l,u,d),t.update(u,s,d)}}function HX(n,e,t){let i;function s(b){if("highp"===b){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";b="mediump"}return"mediump"===b&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),_=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const b=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:_,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function zX(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new qo,a=new ct,c={value:null,needsUpdate:!1};function u(d,h,f,p){const v=null!==d?d.length:0;let g=null;if(0!==v){if(g=c.value,!0!==p||null===g){const m=f+4*v,_=h.matrixWorldInverse;a.getNormalMatrix(_),(null===g||g.length<m)&&(g=new Float32Array(m));for(let y=0,x=f;y!==v;++y,x+=4)o.copy(d[y]).applyMatrix4(_,a),o.normal.toArray(g,x),g[x+3]=o.constant}c.value=g,c.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,v=d.clipIntersection,g=d.clipShadows,m=n.get(d);if(!r||null===p||0===p.length||s&&!g)s?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const _=s?0:i,y=4*_;let x=m.clippingState||null;c.value=x,x=u(p,h,y,f);for(let M=0;M!==y;++M)x[M]=t[M];m.clippingState=x,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=_}}}function GX(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=$s:304===a&&(o.mapping=Fo),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new Uq(c.height/2);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Zp extends cx{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const V1=[.125,.215,.35,.446,.526,.582],dx=new Zp,H1=new me;let hx=null,fx=0,px=0;const Zo=(1+Math.sqrt(5))/2,ll=1/Zo,z1=[new A(1,1,1),new A(-1,1,1),new A(1,1,-1),new A(-1,1,-1),new A(0,Zo,ll),new A(0,Zo,-ll),new A(ll,0,Zo),new A(-ll,0,Zo),new A(Zo,ll,0),new A(-Zo,ll,0)];class G1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){hx=this._renderer.getRenderTarget(),fx=this._renderer.getActiveCubeFace(),px=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=$1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=j1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hx,fx,px),e.scissorTest=!1,Kp(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===$s||e.mapping===Fo?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),hx=this._renderer.getRenderTarget(),fx=this._renderer.getActiveCubeFace(),px=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Jt,minFilter:Jt,generateMipmaps:!1,type:sd,format:$i,colorSpace:Bn,depthBuffer:!1},r=W1(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=W1(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function WX(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+V1.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-4?c=V1[o-n+4-1]:0===o&&(c=0),i.push(c);const l=1/(a-2),u=-l,d=1+l,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,v=3,g=2,m=1,_=new Float32Array(v*p*f),y=new Float32Array(g*p*f),x=new Float32Array(m*p*f);for(let S=0;S<f;S++){const b=S%3*2/3-1,I=S>2?0:-1;_.set([b,I,0,b+2/3,I,0,b+2/3,I+1,0,b,I,0,b+2/3,I+1,0,b,I+1,0],v*p*S),y.set(h,g*p*S),x.set([S,S,S,S,S,S],m*p*S)}const M=new ut;M.setAttribute("position",new en(_,v)),M.setAttribute("uv",new en(y,g)),M.setAttribute("faceIndex",new en(x,m)),e.push(M),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function jX(n,e,t){const i=new Float32Array(20),r=new A(0,1,0);return new eo({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Zn(this._lodPlanes[0],e);this._renderer.compile(t,dx)}_sceneToCubeUV(e,t,i,r){const a=new On(90,1,t,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(H1),u.toneMapping=js,u.autoClear=!1;const f=new Xi({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Zn(new rl,f);let v=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,v=!0):(f.color.copy(H1),v=!0);for(let m=0;m<6;m++){const _=m%3;0===_?(a.up.set(0,c[m],0),a.lookAt(l[m],0,0)):1===_?(a.up.set(0,0,c[m]),a.lookAt(0,l[m],0)):(a.up.set(0,c[m],0),a.lookAt(0,0,l[m]));const y=this._cubeSize;Kp(r,_*y,m>2?y:0,y,y),u.setRenderTarget(r),v&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===$s||e.mapping===Fo;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=$1()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=j1());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Zn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;Kp(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,dx)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,z1[(r-1)%z1.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Zn(this._lodPlanes[r],l),h=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,v=s/p,g=isFinite(s)?1+Math.floor(3*v):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let _=0;for(let b=0;b<20;++b){const I=b/v,w=Math.exp(-I*I/2);m.push(w),0===b?_+=w:b<g&&(_+=2*w)}for(let b=0;b<m.length;b++)m[b]=m[b]/_;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-i;const x=this._sizeLods[r];Kp(t,3*x*(r>y-4?r-y+4:0),4*(this._cubeSize-x),3*x,2*x),c.setRenderTarget(t),c.render(d,dx)}}function W1(n,e,t){const i=new Go(n,e,t);return i.texture.mapping=nd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Kp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function j1(){return new eo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $1(){return new eo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $X(n){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=c===$s||c===Fo;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new G1(n)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(l&&d&&d.height>0||u&&d&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(d)){null===t&&(t=new G1(n));const h=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function qX(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function XX(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const v=h.morphAttributes[p];for(let g=0,m=v.length;g<m;g++)e.remove(v[g])}h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function l(d){const h=[],f=d.index,p=d.attributes.position;let v=0;if(null!==f){const _=f.array;v=f.version;for(let y=0,x=_.length;y<x;y+=3){const M=_[y+0],S=_[y+1],b=_[y+2];h.push(M,S,S,b,b,M)}}else{if(void 0===p)return;v=p.version;for(let y=0,x=p.array.length/3-1;y<x;y+=3){const M=y+0,S=y+1,b=y+2;h.push(M,S,S,b,b,M)}}const g=new(g1(h)?P1:R1)(h,1);g.version=v;const m=s.get(d);m&&e.remove(m),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function c(d){const h=d.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&l(d)}else l(d);return s.get(d)}}}function YX(n,e,t,i){const r=i.isWebGL2;let s,a,c;this.setMode=function o(h){s=h},this.setIndex=function l(h){a=h.type,c=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*c),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let v,g;if(r)v=n,g="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===v)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");v[g](s,f,a,h*c,p),t.update(f,s,p)}}function ZX(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function KX(n,e){return n[0]-e[0]}function JX(n,e){return Math.abs(e[1])-Math.abs(n[1])}function QX(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new It,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,d){const h=l.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let v=s.get(u);if(void 0===v||v.count!==p){let P=function(){W.dispose(),s.delete(u),u.removeEventListener("dispose",P)};void 0!==v&&v.texture.dispose();const _=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,x=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],b=u.morphAttributes.color||[];let I=0;!0===_&&(I=1),!0===y&&(I=2),!0===x&&(I=3);let w=u.attributes.position.count*I,T=1;w>e.maxTextureSize&&(T=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const F=new Float32Array(w*T*4*p),W=new q0(F,w,T,p);W.type=us,W.needsUpdate=!0;const Y=4*I;for(let U=0;U<p;U++){const G=M[U],j=S[U],ie=b[U],Z=w*T*4*U;for(let Q=0;Q<G.count;Q++){const L=Q*Y;!0===_&&(o.fromBufferAttribute(G,Q),F[Z+L+0]=o.x,F[Z+L+1]=o.y,F[Z+L+2]=o.z,F[Z+L+3]=0),!0===y&&(o.fromBufferAttribute(j,Q),F[Z+L+4]=o.x,F[Z+L+5]=o.y,F[Z+L+6]=o.z,F[Z+L+7]=0),!0===x&&(o.fromBufferAttribute(ie,Q),F[Z+L+8]=o.x,F[Z+L+9]=o.y,F[Z+L+10]=o.z,F[Z+L+11]=4===ie.itemSize?o.w:1)}}v={count:p,texture:W,size:new K(w,T)},s.set(u,v),u.addEventListener("dispose",P)}let g=0;for(let _=0;_<h.length;_++)g+=h[_];const m=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",m),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const f=void 0===h?0:h.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const x=p[y];x[0]=y,x[1]=h[y]}p.sort(JX);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(KX);const v=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let y=0;y<8;y++){const x=a[y],M=x[0],S=x[1];M!==Number.MAX_SAFE_INTEGER&&S?(v&&u.getAttribute("morphTarget"+y)!==v[M]&&u.setAttribute("morphTarget"+y,v[M]),g&&u.getAttribute("morphNormal"+y)!==g[M]&&u.setAttribute("morphNormal"+y,g[M]),r[y]=S,m+=S):(v&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),g&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const _=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(n,"morphTargetBaseInfluence",_),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function e7(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,d=e.get(c,c.geometry);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),null!==c.instanceColor&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const h=c.skeleton;r.get(h)!==l&&(h.update(),r.set(h,l))}return d},dispose:function o(){r=new WeakMap}}}const q1=new hr,X1=new q0,Y1=new M1,Z1=new $p,K1=[],J1=[],Q1=new Float32Array(16),eP=new Float32Array(9),tP=new Float32Array(4);function ul(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=K1[r];if(void 0===s&&(s=new Float32Array(r),K1[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Dn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function In(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Jp(n,e){let t=J1[e];void 0===t&&(t=new Int32Array(e),J1[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function t7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function n7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2fv(this.addr,e),In(t,e)}}function i7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Dn(t,e))return;n.uniform3fv(this.addr,e),In(t,e)}}function r7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4fv(this.addr,e),In(t,e)}}function s7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;tP.set(i),n.uniformMatrix2fv(this.addr,!1,tP),In(t,i)}}function o7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;eP.set(i),n.uniformMatrix3fv(this.addr,!1,eP),In(t,i)}}function a7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),In(t,e)}else{if(Dn(t,i))return;Q1.set(i),n.uniformMatrix4fv(this.addr,!1,Q1),In(t,i)}}function c7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function l7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2iv(this.addr,e),In(t,e)}}function u7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Dn(t,e))return;n.uniform3iv(this.addr,e),In(t,e)}}function d7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4iv(this.addr,e),In(t,e)}}function h7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function f7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dn(t,e))return;n.uniform2uiv(this.addr,e),In(t,e)}}function p7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Dn(t,e))return;n.uniform3uiv(this.addr,e),In(t,e)}}function m7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dn(t,e))return;n.uniform4uiv(this.addr,e),In(t,e)}}function g7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||q1,r)}function v7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Y1,r)}function y7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Z1,r)}function _7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||X1,r)}function M7(n,e){n.uniform1fv(this.addr,e)}function w7(n,e){const t=ul(e,this.size,2);n.uniform2fv(this.addr,t)}function S7(n,e){const t=ul(e,this.size,3);n.uniform3fv(this.addr,t)}function E7(n,e){const t=ul(e,this.size,4);n.uniform4fv(this.addr,t)}function b7(n,e){const t=ul(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function T7(n,e){const t=ul(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function C7(n,e){const t=ul(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function A7(n,e){n.uniform1iv(this.addr,e)}function D7(n,e){n.uniform2iv(this.addr,e)}function I7(n,e){n.uniform3iv(this.addr,e)}function R7(n,e){n.uniform4iv(this.addr,e)}function P7(n,e){n.uniform1uiv(this.addr,e)}function N7(n,e){n.uniform2uiv(this.addr,e)}function L7(n,e){n.uniform3uiv(this.addr,e)}function O7(n,e){n.uniform4uiv(this.addr,e)}function F7(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||q1,s[o])}function U7(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Y1,s[o])}function k7(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Z1,s[o])}function B7(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Dn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||X1,s[o])}class H7{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function x7(n){switch(n){case 5126:return t7;case 35664:return n7;case 35665:return i7;case 35666:return r7;case 35674:return s7;case 35675:return o7;case 35676:return a7;case 5124:case 35670:return c7;case 35667:case 35671:return l7;case 35668:case 35672:return u7;case 35669:case 35673:return d7;case 5125:return h7;case 36294:return f7;case 36295:return p7;case 36296:return m7;case 35678:case 36198:case 36298:case 36306:case 35682:return g7;case 35679:case 36299:case 36307:return v7;case 35680:case 36300:case 36308:case 36293:return y7;case 36289:case 36303:case 36311:case 36292:return _7}}(t.type)}}class z7{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function V7(n){switch(n){case 5126:return M7;case 35664:return w7;case 35665:return S7;case 35666:return E7;case 35674:return b7;case 35675:return T7;case 35676:return C7;case 5124:case 35670:return A7;case 35667:case 35671:return D7;case 35668:case 35672:return I7;case 35669:case 35673:return R7;case 5125:return P7;case 36294:return N7;case 36295:return L7;case 36296:return O7;case 35678:case 36198:case 36298:case 36306:case 35682:return F7;case 35679:case 36299:case 36307:return U7;case 35680:case 36300:case 36308:case 36293:return k7;case 36289:case 36303:case 36311:case 36292:return B7}}(t.type)}}class G7{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const gx=/(\w+)(\])?(\[|\.)?/g;function nP(n,e){n.seq.push(e),n.map[e.id]=e}function W7(n,e,t){const i=n.name,r=i.length;for(gx.lastIndex=0;;){const s=gx.exec(i);let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&gx.lastIndex+2===r){nP(t,void 0===l?new H7(a,n,e):new z7(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new G7(a),nP(t,d)),t=d}}}class Qp{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);W7(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function iP(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const j7=37297;let $7=0;function rP(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function q7(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Y7(n,e){const t=function X7(n){const e=bt.getPrimaries(bt.workingColorSpace),t=bt.getPrimaries(n);let i;switch(e===t?i="":e===Sp&&t===wp?i="LinearDisplayP3ToLinearSRGB":e===wp&&t===Sp&&(i="LinearSRGBToLinearDisplayP3"),n){case Bn:case xp:return[i,"LinearTransferOETF"];case Gt:case V0:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Z7(n,e){let t;switch(e){case S6:t="Linear";break;case E6:t="Reinhard";break;case b6:t="OptimizedCineon";break;case T6:t="ACESFilmic";break;case C6:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function gd(n){return""!==n}function sP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function oP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const eY=/^[ \t]*#include +<([\w\d./]+)>/gm;function vx(n){return n.replace(eY,nY)}const tY=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function nY(n,e){let t=st[e];if(void 0===t){const i=tY.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=st[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return vx(t)}const iY=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function aP(n){return n.replace(iY,rY)}function rY(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function cP(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function uY(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function sY(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===bR?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===K$?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===as&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function oY(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case $s:case Fo:e="ENVMAP_TYPE_CUBE";break;case nd:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function aY(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Fo&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function cY(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case mp:e="ENVMAP_BLENDING_MULTIPLY";break;case M6:e="ENVMAP_BLENDING_MIX";break;case w6:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function lY(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function K7(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(gd).join("\n")}(t),p=function J7(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),v=r.createProgram();let g,m,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(gd).join("\n"),g.length>0&&(g+="\n"),m=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(gd).join("\n"),m.length>0&&(m+="\n")):(g=[cP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(gd).join("\n"),m=[f,cP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==js?"#define TONE_MAPPING":"",t.toneMapping!==js?st.tonemapping_pars_fragment:"",t.toneMapping!==js?Z7("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",st.colorspace_pars_fragment,Y7("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(gd).join("\n")),o=vx(o),o=sP(o,t),o=oP(o,t),a=vx(a),a=sP(a,t),a=oP(a,t),o=aP(o),a=aP(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,m=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===f1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===f1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const x=_+m+a,M=iP(r,r.VERTEX_SHADER,_+g+o),S=iP(r,r.FRAGMENT_SHADER,x);function b(F){if(n.debug.checkShaderErrors){const W=r.getProgramInfoLog(v).trim(),Y=r.getShaderInfoLog(M).trim(),P=r.getShaderInfoLog(S).trim();let U=!0,G=!0;if(!1===r.getProgramParameter(v,r.LINK_STATUS))if(U=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,v,M,S);else{const j=rP(r,M,"vertex"),ie=rP(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+W+"\n"+j+"\n"+ie)}else""!==W?console.warn("THREE.WebGLProgram: Program Info Log:",W):(""===Y||""===P)&&(G=!1);G&&(F.diagnostics={runnable:U,programLog:W,vertexShader:{log:Y,prefix:g},fragmentShader:{log:P,prefix:m}})}r.deleteShader(M),r.deleteShader(S),I=new Qp(r,v),w=function Q7(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,v)}let I,w;r.attachShader(v,M),r.attachShader(v,S),void 0!==t.index0AttributeName?r.bindAttribLocation(v,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),this.getUniforms=function(){return void 0===I&&b(this),I},this.getAttributes=function(){return void 0===w&&b(this),w};let T=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===T&&(T=r.getProgramParameter(v,j7)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=$7++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=M,this.fragmentShader=S,this}let dY=0;class hY{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new fY(e),t.set(e,i)),i}}class fY{constructor(e){this.id=dY++,this.code=e,this.usedTimes=0}}function pY(n,e,t,i,r,s,o){const a=new ex,c=new hY,l=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(w){return 0===w?"uv":`uv${w}`}return{getParameters:function g(w,T,F,W,Y){const P=W.fog,U=Y.geometry,j=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?W.environment:null)),ie=j&&j.mapping===nd?j.image.height:null,Z=p[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const Q=U.morphAttributes.position||U.morphAttributes.normal||U.morphAttributes.color,L=void 0!==Q?Q.length:0;let de,ge,ye,Ae,$=0;if(void 0!==U.morphAttributes.position&&($=1),void 0!==U.morphAttributes.normal&&($=2),void 0!==U.morphAttributes.color&&($=3),Z){const xn=Br[Z];de=xn.vertexShader,ge=xn.fragmentShader}else de=w.vertexShader,ge=w.fragmentShader,c.update(w),ye=c.getVertexShaderID(w),Ae=c.getFragmentShaderID(w);const Ue=n.getRenderTarget(),Ne=!0===Y.isInstancedMesh,Je=!!w.map,Fe=!!j,R=!!w.aoMap,fe=!!w.lightMap,X=!!w.bumpMap,re=!!w.normalMap,J=!!w.displacementMap,Le=!!w.emissiveMap,we=!!w.metalnessMap,Te=!!w.roughnessMap,Qe=w.anisotropy>0,ht=w.clearcoat>0,nn=w.iridescence>0,D=w.sheen>0,E=w.transmission>0,k=Qe&&!!w.anisotropyMap,oe=ht&&!!w.clearcoatMap,ee=ht&&!!w.clearcoatNormalMap,ae=ht&&!!w.clearcoatRoughnessMap,Ie=nn&&!!w.iridescenceMap,ue=nn&&!!w.iridescenceThicknessMap,_e=D&&!!w.sheenColorMap,Xe=D&&!!w.sheenRoughnessMap,wt=!!w.specularMap,ce=!!w.specularColorMap,Rt=!!w.specularIntensityMap,et=E&&!!w.transmissionMap,Ye=E&&!!w.thicknessMap,be=!!w.alphaMap,xe=!!w.extensions,le=!!U.attributes.uv1,q=!!U.attributes.uv2,he=!!U.attributes.uv3;let ze=js;return w.toneMapped&&(null===Ue||!0===Ue.isXRRenderTarget)&&(ze=n.toneMapping),{isWebGL2:u,shaderID:Z,shaderType:w.type,shaderName:w.name,vertexShader:de,fragmentShader:ge,defines:w.defines,customVertexShaderID:ye,customFragmentShaderID:Ae,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:Ne,instancingColor:Ne&&null!==Y.instanceColor,supportsVertexTextures:h,outputColorSpace:null===Ue?n.outputColorSpace:!0===Ue.isXRRenderTarget?Ue.texture.colorSpace:Bn,map:Je,matcap:!!w.matcap,envMap:Fe,envMapMode:Fe&&j.mapping,envMapCubeUVHeight:ie,aoMap:R,lightMap:fe,bumpMap:X,normalMap:re,displacementMap:h&&J,emissiveMap:Le,normalMapObjectSpace:re&&1===w.normalMapType,normalMapTangentSpace:re&&0===w.normalMapType,metalnessMap:we,roughnessMap:Te,anisotropy:Qe,anisotropyMap:k,clearcoat:ht,clearcoatMap:oe,clearcoatNormalMap:ee,clearcoatRoughnessMap:ae,iridescence:nn,iridescenceMap:Ie,iridescenceThicknessMap:ue,sheen:D,sheenColorMap:_e,sheenRoughnessMap:Xe,specularMap:wt,specularColorMap:ce,specularIntensityMap:Rt,transmission:E,transmissionMap:et,thicknessMap:Ye,gradientMap:!!w.gradientMap,opaque:!1===w.transparent&&1===w.blending,alphaMap:be,alphaTest:w.alphaTest>0,alphaHash:!!w.alphaHash,combine:w.combine,mapUv:Je&&v(w.map.channel),aoMapUv:R&&v(w.aoMap.channel),lightMapUv:fe&&v(w.lightMap.channel),bumpMapUv:X&&v(w.bumpMap.channel),normalMapUv:re&&v(w.normalMap.channel),displacementMapUv:J&&v(w.displacementMap.channel),emissiveMapUv:Le&&v(w.emissiveMap.channel),metalnessMapUv:we&&v(w.metalnessMap.channel),roughnessMapUv:Te&&v(w.roughnessMap.channel),anisotropyMapUv:k&&v(w.anisotropyMap.channel),clearcoatMapUv:oe&&v(w.clearcoatMap.channel),clearcoatNormalMapUv:ee&&v(w.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ae&&v(w.clearcoatRoughnessMap.channel),iridescenceMapUv:Ie&&v(w.iridescenceMap.channel),iridescenceThicknessMapUv:ue&&v(w.iridescenceThicknessMap.channel),sheenColorMapUv:_e&&v(w.sheenColorMap.channel),sheenRoughnessMapUv:Xe&&v(w.sheenRoughnessMap.channel),specularMapUv:wt&&v(w.specularMap.channel),specularColorMapUv:ce&&v(w.specularColorMap.channel),specularIntensityMapUv:Rt&&v(w.specularIntensityMap.channel),transmissionMapUv:et&&v(w.transmissionMap.channel),thicknessMapUv:Ye&&v(w.thicknessMap.channel),alphaMapUv:be&&v(w.alphaMap.channel),vertexTangents:!!U.attributes.tangent&&(re||Qe),vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!U.attributes.color&&4===U.attributes.color.itemSize,vertexUv1s:le,vertexUv2s:q,vertexUv3s:he,pointsUvs:!0===Y.isPoints&&!!U.attributes.uv&&(Je||be),fog:!!P,useFog:!0===w.fog,fogExp2:P&&P.isFogExp2,flatShading:!0===w.flatShading,sizeAttenuation:!0===w.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===Y.isSkinnedMesh,morphTargets:void 0!==U.morphAttributes.position,morphNormals:void 0!==U.morphAttributes.normal,morphColors:void 0!==U.morphAttributes.color,morphTargetsCount:L,morphTextureStride:$,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:n.shadowMap.enabled&&F.length>0,shadowMapType:n.shadowMap.type,toneMapping:ze,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Je&&!0===w.map.isVideoTexture&&bt.getTransfer(w.map.colorSpace)===Wt,premultipliedAlpha:w.premultipliedAlpha,doubleSided:2===w.side,flipSided:1===w.side,useDepthPacking:w.depthPacking>=0,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:xe&&!0===w.extensions.derivatives,extensionFragDepth:xe&&!0===w.extensions.fragDepth,extensionDrawBuffers:xe&&!0===w.extensions.drawBuffers,extensionShaderTextureLOD:xe&&!0===w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function m(w){const T=[];if(w.shaderID?T.push(w.shaderID):(T.push(w.customVertexShaderID),T.push(w.customFragmentShaderID)),void 0!==w.defines)for(const F in w.defines)T.push(F),T.push(w.defines[F]);return!1===w.isRawShaderMaterial&&(function _(w,T){w.push(T.precision),w.push(T.outputColorSpace),w.push(T.envMapMode),w.push(T.envMapCubeUVHeight),w.push(T.mapUv),w.push(T.alphaMapUv),w.push(T.lightMapUv),w.push(T.aoMapUv),w.push(T.bumpMapUv),w.push(T.normalMapUv),w.push(T.displacementMapUv),w.push(T.emissiveMapUv),w.push(T.metalnessMapUv),w.push(T.roughnessMapUv),w.push(T.anisotropyMapUv),w.push(T.clearcoatMapUv),w.push(T.clearcoatNormalMapUv),w.push(T.clearcoatRoughnessMapUv),w.push(T.iridescenceMapUv),w.push(T.iridescenceThicknessMapUv),w.push(T.sheenColorMapUv),w.push(T.sheenRoughnessMapUv),w.push(T.specularMapUv),w.push(T.specularColorMapUv),w.push(T.specularIntensityMapUv),w.push(T.transmissionMapUv),w.push(T.thicknessMapUv),w.push(T.combine),w.push(T.fogExp2),w.push(T.sizeAttenuation),w.push(T.morphTargetsCount),w.push(T.morphAttributeCount),w.push(T.numDirLights),w.push(T.numPointLights),w.push(T.numSpotLights),w.push(T.numSpotLightMaps),w.push(T.numHemiLights),w.push(T.numRectAreaLights),w.push(T.numDirLightShadows),w.push(T.numPointLightShadows),w.push(T.numSpotLightShadows),w.push(T.numSpotLightShadowsWithMaps),w.push(T.numLightProbes),w.push(T.shadowMapType),w.push(T.toneMapping),w.push(T.numClippingPlanes),w.push(T.numClipIntersection),w.push(T.depthPacking)}(T,w),function y(w,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),w.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.useLegacyLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),w.push(a.mask)}(T,w),T.push(n.outputColorSpace)),T.push(w.customProgramCacheKey),T.join()},getUniforms:function x(w){const T=p[w.type];let F;return F=T?Nq.clone(Br[T].uniforms):w.uniforms,F},acquireProgram:function M(w,T){let F;for(let W=0,Y=l.length;W<Y;W++){const P=l[W];if(P.cacheKey===T){F=P,++F.usedTimes;break}}return void 0===F&&(F=new uY(n,T,w,s),l.push(F)),F},releaseProgram:function S(w){if(0==--w.usedTimes){const T=l.indexOf(w);l[T]=l[l.length-1],l.pop(),w.destroy()}},releaseShaderCache:function b(w){c.remove(w)},programs:l,dispose:function I(){c.dispose()}}}function mY(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function gY(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function lP(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function uP(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,v,g){let m=n[e];return void 0===m?(m={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:v,group:g},n[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=f,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=v,m.group=g),e++,m}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,v,g){const m=o(d,h,f,p,v,g);f.transmission>0?i.push(m):!0===f.transparent?r.push(m):t.push(m)},unshift:function c(d,h,f,p,v,g){const m=o(d,h,f,p,v,g);f.transmission>0?i.unshift(m):!0===f.transparent?r.unshift(m):t.unshift(m)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function l(d,h){t.length>1&&t.sort(d||gY),i.length>1&&i.sort(h||lP),r.length>1&&r.sort(h||lP)}}}function vY(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new uP,n.set(i,[o])):r>=s.length?(o=new uP,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function yY(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new A,color:new me};break;case"SpotLight":t={position:new A,direction:new A,color:new me,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new A,color:new me,distance:0,decay:0};break;case"HemisphereLight":t={direction:new A,skyColor:new me,groundColor:new me};break;case"RectAreaLight":t={color:new me,position:new A,halfWidth:new A,halfHeight:new A}}return n[e.id]=t,t}}}let xY=0;function MY(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function wY(n,e){const t=new yY,i=function _Y(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new A);const s=new A,o=new We,a=new We;return{setup:function c(u,d){let h=0,f=0,p=0;for(let W=0;W<9;W++)r.probe[W].set(0,0,0);let v=0,g=0,m=0,_=0,y=0,x=0,M=0,S=0,b=0,I=0,w=0;u.sort(MY);const T=!0===d?Math.PI:1;for(let W=0,Y=u.length;W<Y;W++){const P=u[W],U=P.color,G=P.intensity,j=P.distance,ie=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)h+=U.r*G*T,f+=U.g*G*T,p+=U.b*G*T;else if(P.isLightProbe){for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(P.sh.coefficients[Z],G);w++}else if(P.isDirectionalLight){const Z=t.get(P);if(Z.color.copy(P.color).multiplyScalar(P.intensity*T),P.castShadow){const Q=P.shadow,L=i.get(P);L.shadowBias=Q.bias,L.shadowNormalBias=Q.normalBias,L.shadowRadius=Q.radius,L.shadowMapSize=Q.mapSize,r.directionalShadow[v]=L,r.directionalShadowMap[v]=ie,r.directionalShadowMatrix[v]=P.shadow.matrix,x++}r.directional[v]=Z,v++}else if(P.isSpotLight){const Z=t.get(P);Z.position.setFromMatrixPosition(P.matrixWorld),Z.color.copy(U).multiplyScalar(G*T),Z.distance=j,Z.coneCos=Math.cos(P.angle),Z.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),Z.decay=P.decay,r.spot[m]=Z;const Q=P.shadow;if(P.map&&(r.spotLightMap[b]=P.map,b++,Q.updateMatrices(P),P.castShadow&&I++),r.spotLightMatrix[m]=Q.matrix,P.castShadow){const L=i.get(P);L.shadowBias=Q.bias,L.shadowNormalBias=Q.normalBias,L.shadowRadius=Q.radius,L.shadowMapSize=Q.mapSize,r.spotShadow[m]=L,r.spotShadowMap[m]=ie,S++}m++}else if(P.isRectAreaLight){const Z=t.get(P);Z.color.copy(U).multiplyScalar(G),Z.halfWidth.set(.5*P.width,0,0),Z.halfHeight.set(0,.5*P.height,0),r.rectArea[_]=Z,_++}else if(P.isPointLight){const Z=t.get(P);if(Z.color.copy(P.color).multiplyScalar(P.intensity*T),Z.distance=P.distance,Z.decay=P.decay,P.castShadow){const Q=P.shadow,L=i.get(P);L.shadowBias=Q.bias,L.shadowNormalBias=Q.normalBias,L.shadowRadius=Q.radius,L.shadowMapSize=Q.mapSize,L.shadowCameraNear=Q.camera.near,L.shadowCameraFar=Q.camera.far,r.pointShadow[g]=L,r.pointShadowMap[g]=ie,r.pointShadowMatrix[g]=P.shadow.matrix,M++}r.point[g]=Z,g++}else if(P.isHemisphereLight){const Z=t.get(P);Z.skyColor.copy(P.color).multiplyScalar(G*T),Z.groundColor.copy(P.groundColor).multiplyScalar(G*T),r.hemi[y]=Z,y++}}_>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=pe.LTC_FLOAT_1,r.rectAreaLTC2=pe.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=pe.LTC_HALF_1,r.rectAreaLTC2=pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const F=r.hash;(F.directionalLength!==v||F.pointLength!==g||F.spotLength!==m||F.rectAreaLength!==_||F.hemiLength!==y||F.numDirectionalShadows!==x||F.numPointShadows!==M||F.numSpotShadows!==S||F.numSpotMaps!==b||F.numLightProbes!==w)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=_,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=M,r.pointShadowMap.length=M,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=M,r.spotLightMatrix.length=S+b-I,r.spotLightMap.length=b,r.numSpotLightShadowsWithMaps=I,r.numLightProbes=w,F.directionalLength=v,F.pointLength=g,F.spotLength=m,F.rectAreaLength=_,F.hemiLength=y,F.numDirectionalShadows=x,F.numPointShadows=M,F.numSpotShadows=S,F.numSpotMaps=b,F.numLightProbes=w,r.version=xY++)},setupView:function l(u,d){let h=0,f=0,p=0,v=0,g=0;const m=d.matrixWorldInverse;for(let _=0,y=u.length;_<y;_++){const x=u[_];if(x.isDirectionalLight){const M=r.directional[h];M.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(m),h++}else if(x.isSpotLight){const M=r.spot[p];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(m),M.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(m),p++}else if(x.isRectAreaLight){const M=r.rectArea[v];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(m),a.identity(),o.copy(x.matrixWorld),o.premultiply(m),a.extractRotation(o),M.halfWidth.set(.5*x.width,0,0),M.halfHeight.set(0,.5*x.height,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),v++}else if(x.isPointLight){const M=r.point[f];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(m),f++}else if(x.isHemisphereLight){const M=r.hemi[g];M.direction.setFromMatrixPosition(x.matrixWorld),M.direction.transformDirection(m),g++}}},state:r}}function dP(n,e){const t=new wY(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function c(d){t.setup(i,d)},setupLightsView:function l(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function SY(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new dP(n,e),t.set(s,[c])):o>=a.length?(c=new dP(n,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class hP extends yr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class fP extends yr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function TY(n,e,t){let i=new ux;const r=new K,s=new K,o=new It,a=new hP({depthPacking:3201}),c=new fP,l={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new eo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new K},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new ut;p.setAttribute("position",new en(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Zn(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bR;let m=this.type;function _(M,S){const b=e.update(v);h.defines.VSM_SAMPLES!==M.blurSamples&&(h.defines.VSM_SAMPLES=M.blurSamples,f.defines.VSM_SAMPLES=M.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===M.mapPass&&(M.mapPass=new Go(r.x,r.y)),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(S,null,b,h,v,null),f.uniforms.shadow_pass.value=M.mapPass.texture,f.uniforms.resolution.value=M.mapSize,f.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(S,null,b,f,v,null)}function y(M,S,b,I){let w=null;const T=!0===b.isPointLight?M.customDistanceMaterial:M.customDepthMaterial;if(void 0!==T)w=T;else if(w=!0===b.isPointLight?c:a,n.localClippingEnabled&&!0===S.clipShadows&&Array.isArray(S.clippingPlanes)&&0!==S.clippingPlanes.length||S.displacementMap&&0!==S.displacementScale||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const F=w.uuid,W=S.uuid;let Y=l[F];void 0===Y&&(Y={},l[F]=Y);let P=Y[W];void 0===P&&(P=w.clone(),Y[W]=P),w=P}return w.visible=S.visible,w.wireframe=S.wireframe,w.side=I===as?null!==S.shadowSide?S.shadowSide:S.side:null!==S.shadowSide?S.shadowSide:d[S.side],w.alphaMap=S.alphaMap,w.alphaTest=S.alphaTest,w.map=S.map,w.clipShadows=S.clipShadows,w.clippingPlanes=S.clippingPlanes,w.clipIntersection=S.clipIntersection,w.displacementMap=S.displacementMap,w.displacementScale=S.displacementScale,w.displacementBias=S.displacementBias,w.wireframeLinewidth=S.wireframeLinewidth,w.linewidth=S.linewidth,!0===b.isPointLight&&!0===w.isMeshDistanceMaterial&&(n.properties.get(w).light=b),w}function x(M,S,b,I,w){if(!1===M.visible)return;if(M.layers.test(S.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&w===as)&&(!M.frustumCulled||i.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,M.matrixWorld);const W=e.update(M),Y=M.material;if(Array.isArray(Y)){const P=W.groups;for(let U=0,G=P.length;U<G;U++){const j=P[U],ie=Y[j.materialIndex];if(ie&&ie.visible){const Z=y(M,ie,I,w);n.renderBufferDirect(b,null,W,Z,M,j)}}}else if(Y.visible){const P=y(M,Y,I,w);n.renderBufferDirect(b,null,W,P,M,null)}}const F=M.children;for(let W=0,Y=F.length;W<Y;W++)x(F[W],S,b,I,w)}this.render=function(M,S,b){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===M.length)return;const I=n.getRenderTarget(),w=n.getActiveCubeFace(),T=n.getActiveMipmapLevel(),F=n.state;F.setBlending(0),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);const W=m!==as&&this.type===as,Y=m===as&&this.type!==as;for(let P=0,U=M.length;P<U;P++){const G=M[P],j=G.shadow;if(void 0===j){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(!1===j.autoUpdate&&!1===j.needsUpdate)continue;r.copy(j.mapSize);const ie=j.getFrameExtents();if(r.multiply(ie),s.copy(j.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/ie.x),r.x=s.x*ie.x,j.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/ie.y),r.y=s.y*ie.y,j.mapSize.y=s.y)),null===j.map||!0===W||!0===Y){const Q=this.type!==as?{minFilter:dn,magFilter:dn}:{};null!==j.map&&j.map.dispose(),j.map=new Go(r.x,r.y,Q),j.map.texture.name=G.name+".shadowMap",j.camera.updateProjectionMatrix()}n.setRenderTarget(j.map),n.clear();const Z=j.getViewportCount();for(let Q=0;Q<Z;Q++){const L=j.getViewport(Q);o.set(s.x*L.x,s.y*L.y,s.x*L.z,s.y*L.w),F.viewport(o),j.updateMatrices(G,Q),i=j.getFrustum(),x(S,b,j.camera,G,this.type)}!0!==j.isPointLightShadow&&this.type===as&&_(j,b),j.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(I,w,T)}}function CY(n,e,t){const i=t.isWebGL2,a=new function r(){let N=!1;const xe=new It;let le=null;const q=new It(0,0,0,0);return{setMask:function(he){le!==he&&!N&&(n.colorMask(he,he,he,he),le=he)},setLocked:function(he){N=he},setClear:function(he,ze,St,xn,Ji){!0===Ji&&(he*=xn,ze*=xn,St*=xn),xe.set(he,ze,St,xn),!1===q.equals(xe)&&(n.clearColor(he,ze,St,xn),q.copy(xe))},reset:function(){N=!1,le=null,q.set(-1,0,0,0)}}},c=new function s(){let N=!1,xe=null,le=null,q=null;return{setTest:function(he){he?Je(n.DEPTH_TEST):ot(n.DEPTH_TEST)},setMask:function(he){xe!==he&&!N&&(n.depthMask(he),xe=he)},setFunc:function(he){if(le!==he){switch(he){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}le=he}},setLocked:function(he){N=he},setClear:function(he){q!==he&&(n.clearDepth(he),q=he)},reset:function(){N=!1,xe=null,le=null,q=null}}},l=new function o(){let N=!1,xe=null,le=null,q=null,he=null,ze=null,St=null,xn=null,Ji=null;return{setTest:function(Vt){N||(Vt?Je(n.STENCIL_TEST):ot(n.STENCIL_TEST))},setMask:function(Vt){xe!==Vt&&!N&&(n.stencilMask(Vt),xe=Vt)},setFunc:function(Vt,li,Gr){(le!==Vt||q!==li||he!==Gr)&&(n.stencilFunc(Vt,li,Gr),le=Vt,q=li,he=Gr)},setOp:function(Vt,li,Gr){(ze!==Vt||St!==li||xn!==Gr)&&(n.stencilOp(Vt,li,Gr),ze=Vt,St=li,xn=Gr)},setLocked:function(Vt){N=Vt},setClear:function(Vt){Ji!==Vt&&(n.clearStencil(Vt),Ji=Vt)},reset:function(){N=!1,xe=null,le=null,q=null,he=null,ze=null,St=null,xn=null,Ji=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,v=[],g=null,m=!1,_=null,y=null,x=null,M=null,S=null,b=null,I=null,w=new me(0,0,0),T=0,F=!1,W=null,Y=null,P=null,U=null,G=null;const j=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ie=!1,Z=0;const Q=n.getParameter(n.VERSION);-1!==Q.indexOf("WebGL")?(Z=parseFloat(/^WebGL (\d)/.exec(Q)[1]),ie=Z>=1):-1!==Q.indexOf("OpenGL ES")&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),ie=Z>=2);let L=null,$={};const de=n.getParameter(n.SCISSOR_BOX),ge=n.getParameter(n.VIEWPORT),ye=(new It).fromArray(de),Ae=(new It).fromArray(ge);function Ue(N,xe,le,q){const he=new Uint8Array(4),ze=n.createTexture();n.bindTexture(N,ze),n.texParameteri(N,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(N,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let St=0;St<le;St++)!i||N!==n.TEXTURE_3D&&N!==n.TEXTURE_2D_ARRAY?n.texImage2D(xe+St,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,he):n.texImage3D(xe,0,n.RGBA,1,1,q,0,n.RGBA,n.UNSIGNED_BYTE,he);return ze}const Ne={};function Je(N){!0!==h[N]&&(n.enable(N),h[N]=!0)}function ot(N){!1!==h[N]&&(n.disable(N),h[N]=!1)}Ne[n.TEXTURE_2D]=Ue(n.TEXTURE_2D,n.TEXTURE_2D,1),Ne[n.TEXTURE_CUBE_MAP]=Ue(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ne[n.TEXTURE_2D_ARRAY]=Ue(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ne[n.TEXTURE_3D]=Ue(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Je(n.DEPTH_TEST),c.setFunc(3),we(!1),Te(1),Je(n.CULL_FACE),J(0);const X={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)X[103]=n.MIN,X[104]=n.MAX;else{const N=e.get("EXT_blend_minmax");null!==N&&(X[103]=N.MIN_EXT,X[104]=N.MAX_EXT)}const re={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA,211:n.CONSTANT_COLOR,212:n.ONE_MINUS_CONSTANT_COLOR,213:n.CONSTANT_ALPHA,214:n.ONE_MINUS_CONSTANT_ALPHA};function J(N,xe,le,q,he,ze,St,xn,Ji,Vt){if(0!==N){if(!1===m&&(Je(n.BLEND),m=!0),5===N)he=he||xe,ze=ze||le,St=St||q,(xe!==y||he!==S)&&(n.blendEquationSeparate(X[xe],X[he]),y=xe,S=he),(le!==x||q!==M||ze!==b||St!==I)&&(n.blendFuncSeparate(re[le],re[q],re[ze],re[St]),x=le,M=q,b=ze,I=St),(!1===xn.equals(w)||Ji!==T)&&(n.blendColor(xn.r,xn.g,xn.b,Ji),w.copy(xn),T=Ji),_=N,F=!1;else if(N!==_||Vt!==F){if((100!==y||100!==S)&&(n.blendEquation(n.FUNC_ADD),y=100,S=100),Vt)switch(N){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}else switch(N){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}x=null,M=null,b=null,I=null,w.set(0,0,0),T=0,_=N,F=Vt}}else!0===m&&(ot(n.BLEND),m=!1)}function we(N){W!==N&&(n.frontFace(N?n.CW:n.CCW),W=N)}function Te(N){0!==N?(Je(n.CULL_FACE),N!==Y&&n.cullFace(1===N?n.BACK:2===N?n.FRONT:n.FRONT_AND_BACK)):ot(n.CULL_FACE),Y=N}function ht(N,xe,le){N?(Je(n.POLYGON_OFFSET_FILL),(U!==xe||G!==le)&&(n.polygonOffset(xe,le),U=xe,G=le)):ot(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:c,stencil:l},enable:Je,disable:ot,bindFramebuffer:function Fe(N,xe){return f[N]!==xe&&(n.bindFramebuffer(N,xe),f[N]=xe,i&&(N===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=xe),N===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=xe)),!0)},drawBuffers:function R(N,xe){let le=v,q=!1;if(N)if(le=p.get(xe),void 0===le&&(le=[],p.set(xe,le)),N.isWebGLMultipleRenderTargets){const he=N.texture;if(le.length!==he.length||le[0]!==n.COLOR_ATTACHMENT0){for(let ze=0,St=he.length;ze<St;ze++)le[ze]=n.COLOR_ATTACHMENT0+ze;le.length=he.length,q=!0}}else le[0]!==n.COLOR_ATTACHMENT0&&(le[0]=n.COLOR_ATTACHMENT0,q=!0);else le[0]!==n.BACK&&(le[0]=n.BACK,q=!0);q&&(t.isWebGL2?n.drawBuffers(le):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(le))},useProgram:function fe(N){return g!==N&&(n.useProgram(N),g=N,!0)},setBlending:J,setMaterial:function Le(N,xe){2===N.side?ot(n.CULL_FACE):Je(n.CULL_FACE);let le=1===N.side;xe&&(le=!le),we(le),1===N.blending&&!1===N.transparent?J(0):J(N.blending,N.blendEquation,N.blendSrc,N.blendDst,N.blendEquationAlpha,N.blendSrcAlpha,N.blendDstAlpha,N.blendColor,N.blendAlpha,N.premultipliedAlpha),c.setFunc(N.depthFunc),c.setTest(N.depthTest),c.setMask(N.depthWrite),a.setMask(N.colorWrite);const q=N.stencilWrite;l.setTest(q),q&&(l.setMask(N.stencilWriteMask),l.setFunc(N.stencilFunc,N.stencilRef,N.stencilFuncMask),l.setOp(N.stencilFail,N.stencilZFail,N.stencilZPass)),ht(N.polygonOffset,N.polygonOffsetFactor,N.polygonOffsetUnits),!0===N.alphaToCoverage?Je(n.SAMPLE_ALPHA_TO_COVERAGE):ot(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:we,setCullFace:Te,setLineWidth:function Qe(N){N!==P&&(ie&&n.lineWidth(N),P=N)},setPolygonOffset:ht,setScissorTest:function nn(N){N?Je(n.SCISSOR_TEST):ot(n.SCISSOR_TEST)},activeTexture:function D(N){void 0===N&&(N=n.TEXTURE0+j-1),L!==N&&(n.activeTexture(N),L=N)},bindTexture:function E(N,xe,le){void 0===le&&(le=null===L?n.TEXTURE0+j-1:L);let q=$[le];void 0===q&&(q={type:void 0,texture:void 0},$[le]=q),(q.type!==N||q.texture!==xe)&&(L!==le&&(n.activeTexture(le),L=le),n.bindTexture(N,xe||Ne[N]),q.type=N,q.texture=xe)},unbindTexture:function k(){const N=$[L];void 0!==N&&void 0!==N.type&&(n.bindTexture(N.type,null),N.type=void 0,N.texture=void 0)},compressedTexImage2D:function oe(){try{n.compressedTexImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexImage3D:function ee(){try{n.compressedTexImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage2D:function ce(){try{n.texImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage3D:function Rt(){try{n.texImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},updateUBOMapping:function Ve(N,xe){let le=d.get(xe);void 0===le&&(le=new WeakMap,d.set(xe,le));let q=le.get(N);void 0===q&&(q=n.getUniformBlockIndex(xe,N.name),le.set(N,q))},uniformBlockBinding:function be(N,xe){const q=d.get(xe).get(N);u.get(xe)!==q&&(n.uniformBlockBinding(xe,q,N.__bindingPointIndex),u.set(xe,q))},texStorage2D:function Xe(){try{n.texStorage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texStorage3D:function wt(){try{n.texStorage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage2D:function ae(){try{n.texSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage3D:function Ie(){try{n.texSubImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexSubImage2D:function ue(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexSubImage3D:function _e(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},scissor:function et(N){!1===ye.equals(N)&&(n.scissor(N.x,N.y,N.z,N.w),ye.copy(N))},viewport:function Ye(N){!1===Ae.equals(N)&&(n.viewport(N.x,N.y,N.z,N.w),Ae.copy(N))},reset:function gt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},L=null,$={},f={},p=new WeakMap,v=[],g=null,m=!1,_=null,y=null,x=null,M=null,S=null,b=null,I=null,w=new me(0,0,0),T=0,F=!1,W=null,Y=null,P=null,U=null,G=null,ye.set(0,0,n.canvas.width,n.canvas.height),Ae.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),l.reset()}}}function AY(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let v;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(D,E){return m?new OffscreenCanvas(D,E):cd("canvas")}function y(D,E,k,oe){let ee=1;if((D.width>oe||D.height>oe)&&(ee=oe/Math.max(D.width,D.height)),ee<1||!0===E){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){const ae=E?Tp:Math.floor,Ie=ae(ee*D.width),ue=ae(ee*D.height);void 0===v&&(v=_(Ie,ue));const _e=k?_(Ie,ue):v;return _e.width=Ie,_e.height=ue,_e.getContext("2d").drawImage(D,0,0,Ie,ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+Ie+"x"+ue+")."),_e}return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D}return D}function x(D){return G0(D.width)&&G0(D.height)}function S(D,E){return D.generateMipmaps&&E&&D.minFilter!==dn&&D.minFilter!==Jt}function b(D){n.generateMipmap(D)}function I(D,E,k,oe,ee=!1){if(!1===a)return E;if(null!==D){if(void 0!==n[D])return n[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let ae=E;if(E===n.RED&&(k===n.FLOAT&&(ae=n.R32F),k===n.HALF_FLOAT&&(ae=n.R16F),k===n.UNSIGNED_BYTE&&(ae=n.R8)),E===n.RED_INTEGER&&(k===n.UNSIGNED_BYTE&&(ae=n.R8UI),k===n.UNSIGNED_SHORT&&(ae=n.R16UI),k===n.UNSIGNED_INT&&(ae=n.R32UI),k===n.BYTE&&(ae=n.R8I),k===n.SHORT&&(ae=n.R16I),k===n.INT&&(ae=n.R32I)),E===n.RG&&(k===n.FLOAT&&(ae=n.RG32F),k===n.HALF_FLOAT&&(ae=n.RG16F),k===n.UNSIGNED_BYTE&&(ae=n.RG8)),E===n.RGBA){const Ie=ee?Mp:bt.getTransfer(oe);k===n.FLOAT&&(ae=n.RGBA32F),k===n.HALF_FLOAT&&(ae=n.RGBA16F),k===n.UNSIGNED_BYTE&&(ae=Ie===Wt?n.SRGB8_ALPHA8:n.RGBA8),k===n.UNSIGNED_SHORT_4_4_4_4&&(ae=n.RGBA4),k===n.UNSIGNED_SHORT_5_5_5_1&&(ae=n.RGB5_A1)}return(ae===n.R16F||ae===n.R32F||ae===n.RG16F||ae===n.RG32F||ae===n.RGBA16F||ae===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ae}function w(D,E,k){return!0===S(D,k)||D.isFramebufferTexture&&D.minFilter!==dn&&D.minFilter!==Jt?Math.log2(Math.max(E.width,E.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?E.mipmaps.length:1}function T(D){return D===dn||1004===D||1005===D?n.NEAREST:n.LINEAR}function F(D){const E=D.target;E.removeEventListener("dispose",F),function Y(D){const E=i.get(D);if(void 0===E.__webglInit)return;const k=D.source,oe=g.get(k);if(oe){const ee=oe[E.__cacheKey];ee.usedTimes--,0===ee.usedTimes&&P(D),0===Object.keys(oe).length&&g.delete(k)}i.remove(D)}(E),E.isVideoTexture&&p.delete(E)}function W(D){const E=D.target;E.removeEventListener("dispose",W),function U(D){const E=D.texture,k=i.get(D),oe=i.get(E);if(void 0!==oe.__webglTexture&&(n.deleteTexture(oe.__webglTexture),o.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let ee=0;ee<6;ee++){if(Array.isArray(k.__webglFramebuffer[ee]))for(let ae=0;ae<k.__webglFramebuffer[ee].length;ae++)n.deleteFramebuffer(k.__webglFramebuffer[ee][ae]);else n.deleteFramebuffer(k.__webglFramebuffer[ee]);k.__webglDepthbuffer&&n.deleteRenderbuffer(k.__webglDepthbuffer[ee])}else{if(Array.isArray(k.__webglFramebuffer))for(let ee=0;ee<k.__webglFramebuffer.length;ee++)n.deleteFramebuffer(k.__webglFramebuffer[ee]);else n.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&n.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&n.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let ee=0;ee<k.__webglColorRenderbuffer.length;ee++)k.__webglColorRenderbuffer[ee]&&n.deleteRenderbuffer(k.__webglColorRenderbuffer[ee]);k.__webglDepthRenderbuffer&&n.deleteRenderbuffer(k.__webglDepthRenderbuffer)}if(D.isWebGLMultipleRenderTargets)for(let ee=0,ae=E.length;ee<ae;ee++){const Ie=i.get(E[ee]);Ie.__webglTexture&&(n.deleteTexture(Ie.__webglTexture),o.memory.textures--),i.remove(E[ee])}i.remove(E),i.remove(D)}(E)}function P(D){const E=i.get(D);n.deleteTexture(E.__webglTexture),delete g.get(D.source)[E.__cacheKey],o.memory.textures--}let G=0;function Q(D,E){const k=i.get(D);if(D.isVideoTexture&&function ht(D){const E=o.render.frame;p.get(D)!==E&&(p.set(D,E),D.update())}(D),!1===D.isRenderTargetTexture&&D.version>0&&k.__version!==D.version){const oe=D.image;if(null===oe)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==oe.complete)return void Je(k,D,E);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,k.__webglTexture,n.TEXTURE0+E)}const ge={[Uo]:n.REPEAT,[qn]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},ye={[dn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[Jt]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[ls]:n.LINEAR_MIPMAP_LINEAR},Ae={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Ue(D,E,k){if(k?(n.texParameteri(D,n.TEXTURE_WRAP_S,ge[E.wrapS]),n.texParameteri(D,n.TEXTURE_WRAP_T,ge[E.wrapT]),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,ge[E.wrapR]),n.texParameteri(D,n.TEXTURE_MAG_FILTER,ye[E.magFilter]),n.texParameteri(D,n.TEXTURE_MIN_FILTER,ye[E.minFilter])):(n.texParameteri(D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(E.wrapS!==qn||E.wrapT!==qn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(D,n.TEXTURE_MAG_FILTER,T(E.magFilter)),n.texParameteri(D,n.TEXTURE_MIN_FILTER,T(E.minFilter)),E.minFilter!==dn&&E.minFilter!==Jt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),E.compareFunction&&(n.texParameteri(D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(D,n.TEXTURE_COMPARE_FUNC,Ae[E.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const oe=e.get("EXT_texture_filter_anisotropic");if(E.magFilter===dn||1005!==E.minFilter&&E.minFilter!==ls||E.type===us&&!1===e.has("OES_texture_float_linear")||!1===a&&E.type===sd&&!1===e.has("OES_texture_half_float_linear"))return;(E.anisotropy>1||i.get(E).__currentAnisotropy)&&(n.texParameterf(D,oe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,r.getMaxAnisotropy())),i.get(E).__currentAnisotropy=E.anisotropy)}}function Ne(D,E){let k=!1;void 0===D.__webglInit&&(D.__webglInit=!0,E.addEventListener("dispose",F));const oe=E.source;let ee=g.get(oe);void 0===ee&&(ee={},g.set(oe,ee));const ae=function Z(D){const E=[];return E.push(D.wrapS),E.push(D.wrapT),E.push(D.wrapR||0),E.push(D.magFilter),E.push(D.minFilter),E.push(D.anisotropy),E.push(D.internalFormat),E.push(D.format),E.push(D.type),E.push(D.generateMipmaps),E.push(D.premultiplyAlpha),E.push(D.flipY),E.push(D.unpackAlignment),E.push(D.colorSpace),E.join()}(E);if(ae!==D.__cacheKey){void 0===ee[ae]&&(ee[ae]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,k=!0),ee[ae].usedTimes++;const Ie=ee[D.__cacheKey];void 0!==Ie&&(ee[D.__cacheKey].usedTimes--,0===Ie.usedTimes&&P(E)),D.__cacheKey=ae,D.__webglTexture=ee[ae].texture}return k}function Je(D,E,k){let oe=n.TEXTURE_2D;(E.isDataArrayTexture||E.isCompressedArrayTexture)&&(oe=n.TEXTURE_2D_ARRAY),E.isData3DTexture&&(oe=n.TEXTURE_3D);const ee=Ne(D,E),ae=E.source;t.bindTexture(oe,D.__webglTexture,n.TEXTURE0+k);const Ie=i.get(ae);if(ae.version!==Ie.__version||!0===ee){t.activeTexture(n.TEXTURE0+k);const ue=bt.getPrimaries(bt.workingColorSpace),_e=""===E.colorSpace?null:bt.getPrimaries(E.colorSpace),Xe=""===E.colorSpace||ue===_e?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,E.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,E.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Xe);const wt=function M(D){return!a&&(D.wrapS!==qn||D.wrapT!==qn||D.minFilter!==dn&&D.minFilter!==Jt)}(E)&&!1===x(E.image);let ce=y(E.image,wt,!1,u);ce=nn(E,ce);const Rt=x(ce)||a,et=s.convert(E.format,E.colorSpace);let be,Ye=s.convert(E.type),Ve=I(E.internalFormat,et,Ye,E.colorSpace,E.isVideoTexture);Ue(oe,E,Rt);const gt=E.mipmaps,N=a&&!0!==E.isVideoTexture,xe=void 0===Ie.__version||!0===ee,le=w(E,ce,Rt);if(E.isDepthTexture)Ve=n.DEPTH_COMPONENT,a?Ve=E.type===us?n.DEPTH_COMPONENT32F:E.type===Xs?n.DEPTH_COMPONENT24:E.type===ko?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:E.type===us&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===Bo&&Ve===n.DEPTH_COMPONENT&&1012!==E.type&&E.type!==Xs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=Xs,Ye=s.convert(E.type)),E.format===Fc&&Ve===n.DEPTH_COMPONENT&&(Ve=n.DEPTH_STENCIL,E.type!==ko&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=ko,Ye=s.convert(E.type))),xe&&(N?t.texStorage2D(n.TEXTURE_2D,1,Ve,ce.width,ce.height):t.texImage2D(n.TEXTURE_2D,0,Ve,ce.width,ce.height,0,et,Ye,null));else if(E.isDataTexture)if(gt.length>0&&Rt){N&&xe&&t.texStorage2D(n.TEXTURE_2D,le,Ve,gt[0].width,gt[0].height);for(let q=0,he=gt.length;q<he;q++)be=gt[q],N?t.texSubImage2D(n.TEXTURE_2D,q,0,0,be.width,be.height,et,Ye,be.data):t.texImage2D(n.TEXTURE_2D,q,Ve,be.width,be.height,0,et,Ye,be.data);E.generateMipmaps=!1}else N?(xe&&t.texStorage2D(n.TEXTURE_2D,le,Ve,ce.width,ce.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ce.width,ce.height,et,Ye,ce.data)):t.texImage2D(n.TEXTURE_2D,0,Ve,ce.width,ce.height,0,et,Ye,ce.data);else if(E.isCompressedTexture)if(E.isCompressedArrayTexture){N&&xe&&t.texStorage3D(n.TEXTURE_2D_ARRAY,le,Ve,gt[0].width,gt[0].height,ce.depth);for(let q=0,he=gt.length;q<he;q++)be=gt[q],E.format!==$i?null!==et?N?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,be.width,be.height,ce.depth,et,be.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,q,Ve,be.width,be.height,ce.depth,0,be.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):N?t.texSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,be.width,be.height,ce.depth,et,Ye,be.data):t.texImage3D(n.TEXTURE_2D_ARRAY,q,Ve,be.width,be.height,ce.depth,0,et,Ye,be.data)}else{N&&xe&&t.texStorage2D(n.TEXTURE_2D,le,Ve,gt[0].width,gt[0].height);for(let q=0,he=gt.length;q<he;q++)be=gt[q],E.format!==$i?null!==et?N?t.compressedTexSubImage2D(n.TEXTURE_2D,q,0,0,be.width,be.height,et,be.data):t.compressedTexImage2D(n.TEXTURE_2D,q,Ve,be.width,be.height,0,be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):N?t.texSubImage2D(n.TEXTURE_2D,q,0,0,be.width,be.height,et,Ye,be.data):t.texImage2D(n.TEXTURE_2D,q,Ve,be.width,be.height,0,et,Ye,be.data)}else if(E.isDataArrayTexture)N?(xe&&t.texStorage3D(n.TEXTURE_2D_ARRAY,le,Ve,ce.width,ce.height,ce.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ce.width,ce.height,ce.depth,et,Ye,ce.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ve,ce.width,ce.height,ce.depth,0,et,Ye,ce.data);else if(E.isData3DTexture)N?(xe&&t.texStorage3D(n.TEXTURE_3D,le,Ve,ce.width,ce.height,ce.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ce.width,ce.height,ce.depth,et,Ye,ce.data)):t.texImage3D(n.TEXTURE_3D,0,Ve,ce.width,ce.height,ce.depth,0,et,Ye,ce.data);else if(E.isFramebufferTexture){if(xe)if(N)t.texStorage2D(n.TEXTURE_2D,le,Ve,ce.width,ce.height);else{let q=ce.width,he=ce.height;for(let ze=0;ze<le;ze++)t.texImage2D(n.TEXTURE_2D,ze,Ve,q,he,0,et,Ye,null),q>>=1,he>>=1}}else if(gt.length>0&&Rt){N&&xe&&t.texStorage2D(n.TEXTURE_2D,le,Ve,gt[0].width,gt[0].height);for(let q=0,he=gt.length;q<he;q++)be=gt[q],N?t.texSubImage2D(n.TEXTURE_2D,q,0,0,et,Ye,be):t.texImage2D(n.TEXTURE_2D,q,Ve,et,Ye,be);E.generateMipmaps=!1}else N?(xe&&t.texStorage2D(n.TEXTURE_2D,le,Ve,ce.width,ce.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,et,Ye,ce)):t.texImage2D(n.TEXTURE_2D,0,Ve,et,Ye,ce);S(E,Rt)&&b(oe),Ie.__version=ae.version,E.onUpdate&&E.onUpdate(E)}D.__version=E.version}function Fe(D,E,k,oe,ee,ae){const Ie=s.convert(k.format,k.colorSpace),ue=s.convert(k.type),_e=I(k.internalFormat,Ie,ue,k.colorSpace);if(!i.get(E).__hasExternalTextures){const wt=Math.max(1,E.width>>ae),ce=Math.max(1,E.height>>ae);ee===n.TEXTURE_3D||ee===n.TEXTURE_2D_ARRAY?t.texImage3D(ee,ae,_e,wt,ce,E.depth,0,Ie,ue,null):t.texImage2D(ee,ae,_e,wt,ce,0,Ie,ue,null)}t.bindFramebuffer(n.FRAMEBUFFER,D),Qe(E)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,oe,ee,i.get(k).__webglTexture,0,Te(E)):(ee===n.TEXTURE_2D||ee>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ee<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,oe,ee,i.get(k).__webglTexture,ae),t.bindFramebuffer(n.FRAMEBUFFER,null)}function R(D,E,k){if(n.bindRenderbuffer(n.RENDERBUFFER,D),E.depthBuffer&&!E.stencilBuffer){let oe=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(k||Qe(E)){const ee=E.depthTexture;ee&&ee.isDepthTexture&&(ee.type===us?oe=n.DEPTH_COMPONENT32F:ee.type===Xs&&(oe=n.DEPTH_COMPONENT24));const ae=Te(E);Qe(E)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ae,oe,E.width,E.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ae,oe,E.width,E.height)}else n.renderbufferStorage(n.RENDERBUFFER,oe,E.width,E.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,D)}else if(E.depthBuffer&&E.stencilBuffer){const oe=Te(E);k&&!1===Qe(E)?n.renderbufferStorageMultisample(n.RENDERBUFFER,oe,n.DEPTH24_STENCIL8,E.width,E.height):Qe(E)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,oe,n.DEPTH24_STENCIL8,E.width,E.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,E.width,E.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,D)}else{const oe=!0===E.isWebGLMultipleRenderTargets?E.texture:[E.texture];for(let ee=0;ee<oe.length;ee++){const ae=oe[ee],Ie=s.convert(ae.format,ae.colorSpace),ue=s.convert(ae.type),_e=I(ae.internalFormat,Ie,ue,ae.colorSpace),Xe=Te(E);k&&!1===Qe(E)?n.renderbufferStorageMultisample(n.RENDERBUFFER,Xe,_e,E.width,E.height):Qe(E)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Xe,_e,E.width,E.height):n.renderbufferStorage(n.RENDERBUFFER,_e,E.width,E.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function X(D){const E=i.get(D),k=!0===D.isWebGLCubeRenderTarget;if(D.depthTexture&&!E.__autoAllocateDepthBuffer){if(k)throw new Error("target.depthTexture not supported in Cube render targets");!function fe(D,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,D),!E.depthTexture||!E.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),Q(E.depthTexture,0);const oe=i.get(E.depthTexture).__webglTexture,ee=Te(E);if(E.depthTexture.format===Bo)Qe(E)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,oe,0,ee):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,oe,0);else{if(E.depthTexture.format!==Fc)throw new Error("Unknown depthTexture format");Qe(E)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,oe,0,ee):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,oe,0)}}(E.__webglFramebuffer,D)}else if(k){E.__webglDepthbuffer=[];for(let oe=0;oe<6;oe++)t.bindFramebuffer(n.FRAMEBUFFER,E.__webglFramebuffer[oe]),E.__webglDepthbuffer[oe]=n.createRenderbuffer(),R(E.__webglDepthbuffer[oe],D,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),R(E.__webglDepthbuffer,D,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Te(D){return Math.min(d,D.samples)}function Qe(D){const E=i.get(D);return a&&D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==E.__useRenderToTexture}function nn(D,E){const k=D.colorSpace,oe=D.format,ee=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||1035===D.format||k!==Bn&&""!==k&&(bt.getTransfer(k)===Wt?!1===a?!0===e.has("EXT_sRGB")&&oe===$i?(D.format=1035,D.minFilter=Jt,D.generateMipmaps=!1):E=x1.sRGBToLinear(E):(oe!==$i||ee!==qs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",k)),E}this.allocateTextureUnit=function ie(){const D=G;return D>=c&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+c),G+=1,D},this.resetTextureUnits=function j(){G=0},this.setTexture2D=Q,this.setTexture2DArray=function L(D,E){const k=i.get(D);D.version>0&&k.__version!==D.version?Je(k,D,E):t.bindTexture(n.TEXTURE_2D_ARRAY,k.__webglTexture,n.TEXTURE0+E)},this.setTexture3D=function $(D,E){const k=i.get(D);D.version>0&&k.__version!==D.version?Je(k,D,E):t.bindTexture(n.TEXTURE_3D,k.__webglTexture,n.TEXTURE0+E)},this.setTextureCube=function de(D,E){const k=i.get(D);D.version>0&&k.__version!==D.version?function ot(D,E,k){if(6!==E.image.length)return;const oe=Ne(D,E),ee=E.source;t.bindTexture(n.TEXTURE_CUBE_MAP,D.__webglTexture,n.TEXTURE0+k);const ae=i.get(ee);if(ee.version!==ae.__version||!0===oe){t.activeTexture(n.TEXTURE0+k);const Ie=bt.getPrimaries(bt.workingColorSpace),ue=""===E.colorSpace?null:bt.getPrimaries(E.colorSpace),_e=""===E.colorSpace||Ie===ue?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,E.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,E.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,_e);const Xe=E.isCompressedTexture||E.image[0].isCompressedTexture,wt=E.image[0]&&E.image[0].isDataTexture,ce=[];for(let q=0;q<6;q++)ce[q]=Xe||wt?wt?E.image[q].image:E.image[q]:y(E.image[q],!1,!0,l),ce[q]=nn(E,ce[q]);const Rt=ce[0],et=x(Rt)||a,Ye=s.convert(E.format,E.colorSpace),Ve=s.convert(E.type),be=I(E.internalFormat,Ye,Ve,E.colorSpace),gt=a&&!0!==E.isVideoTexture,N=void 0===ae.__version||!0===oe;let le,xe=w(E,Rt,et);if(Ue(n.TEXTURE_CUBE_MAP,E,et),Xe){gt&&N&&t.texStorage2D(n.TEXTURE_CUBE_MAP,xe,be,Rt.width,Rt.height);for(let q=0;q<6;q++){le=ce[q].mipmaps;for(let he=0;he<le.length;he++){const ze=le[he];E.format!==$i?null!==Ye?gt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he,0,0,ze.width,ze.height,Ye,ze.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he,be,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he,0,0,ze.width,ze.height,Ye,Ve,ze.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he,be,ze.width,ze.height,0,Ye,Ve,ze.data)}}}else{le=E.mipmaps,gt&&N&&(le.length>0&&xe++,t.texStorage2D(n.TEXTURE_CUBE_MAP,xe,be,ce[0].width,ce[0].height));for(let q=0;q<6;q++)if(wt){gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,ce[q].width,ce[q].height,Ye,Ve,ce[q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,be,ce[q].width,ce[q].height,0,Ye,Ve,ce[q].data);for(let he=0;he<le.length;he++){const St=le[he].image[q].image;gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he+1,0,0,St.width,St.height,Ye,Ve,St.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he+1,be,St.width,St.height,0,Ye,Ve,St.data)}}else{gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,Ye,Ve,ce[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,be,Ye,Ve,ce[q]);for(let he=0;he<le.length;he++){const ze=le[he];gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he+1,0,0,Ye,Ve,ze.image[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,he+1,be,Ye,Ve,ze.image[q])}}}S(E,et)&&b(n.TEXTURE_CUBE_MAP),ae.__version=ee.version,E.onUpdate&&E.onUpdate(E)}D.__version=E.version}(k,D,E):t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+E)},this.rebindTextures=function re(D,E,k){const oe=i.get(D);void 0!==E&&Fe(oe.__webglFramebuffer,D,D.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==k&&X(D)},this.setupRenderTarget=function J(D){const E=D.texture,k=i.get(D),oe=i.get(E);D.addEventListener("dispose",W),!0!==D.isWebGLMultipleRenderTargets&&(void 0===oe.__webglTexture&&(oe.__webglTexture=n.createTexture()),oe.__version=E.version,o.memory.textures++);const ee=!0===D.isWebGLCubeRenderTarget,ae=!0===D.isWebGLMultipleRenderTargets,Ie=x(D)||a;if(ee){k.__webglFramebuffer=[];for(let ue=0;ue<6;ue++)if(a&&E.mipmaps&&E.mipmaps.length>0){k.__webglFramebuffer[ue]=[];for(let _e=0;_e<E.mipmaps.length;_e++)k.__webglFramebuffer[ue][_e]=n.createFramebuffer()}else k.__webglFramebuffer[ue]=n.createFramebuffer()}else{if(a&&E.mipmaps&&E.mipmaps.length>0){k.__webglFramebuffer=[];for(let ue=0;ue<E.mipmaps.length;ue++)k.__webglFramebuffer[ue]=n.createFramebuffer()}else k.__webglFramebuffer=n.createFramebuffer();if(ae)if(r.drawBuffers){const ue=D.texture;for(let _e=0,Xe=ue.length;_e<Xe;_e++){const wt=i.get(ue[_e]);void 0===wt.__webglTexture&&(wt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&D.samples>0&&!1===Qe(D)){const ue=ae?E:[E];k.__webglMultisampledFramebuffer=n.createFramebuffer(),k.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,k.__webglMultisampledFramebuffer);for(let _e=0;_e<ue.length;_e++){const Xe=ue[_e];k.__webglColorRenderbuffer[_e]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,k.__webglColorRenderbuffer[_e]);const wt=s.convert(Xe.format,Xe.colorSpace),ce=s.convert(Xe.type),Rt=I(Xe.internalFormat,wt,ce,Xe.colorSpace,!0===D.isXRRenderTarget),et=Te(D);n.renderbufferStorageMultisample(n.RENDERBUFFER,et,Rt,D.width,D.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+_e,n.RENDERBUFFER,k.__webglColorRenderbuffer[_e])}n.bindRenderbuffer(n.RENDERBUFFER,null),D.depthBuffer&&(k.__webglDepthRenderbuffer=n.createRenderbuffer(),R(k.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ee){t.bindTexture(n.TEXTURE_CUBE_MAP,oe.__webglTexture),Ue(n.TEXTURE_CUBE_MAP,E,Ie);for(let ue=0;ue<6;ue++)if(a&&E.mipmaps&&E.mipmaps.length>0)for(let _e=0;_e<E.mipmaps.length;_e++)Fe(k.__webglFramebuffer[ue][_e],D,E,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ue,_e);else Fe(k.__webglFramebuffer[ue],D,E,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ue,0);S(E,Ie)&&b(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ae){const ue=D.texture;for(let _e=0,Xe=ue.length;_e<Xe;_e++){const wt=ue[_e],ce=i.get(wt);t.bindTexture(n.TEXTURE_2D,ce.__webglTexture),Ue(n.TEXTURE_2D,wt,Ie),Fe(k.__webglFramebuffer,D,wt,n.COLOR_ATTACHMENT0+_e,n.TEXTURE_2D,0),S(wt,Ie)&&b(n.TEXTURE_2D)}t.unbindTexture()}else{let ue=n.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(a?ue=D.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ue,oe.__webglTexture),Ue(ue,E,Ie),a&&E.mipmaps&&E.mipmaps.length>0)for(let _e=0;_e<E.mipmaps.length;_e++)Fe(k.__webglFramebuffer[_e],D,E,n.COLOR_ATTACHMENT0,ue,_e);else Fe(k.__webglFramebuffer,D,E,n.COLOR_ATTACHMENT0,ue,0);S(E,Ie)&&b(ue),t.unbindTexture()}D.depthBuffer&&X(D)},this.updateRenderTargetMipmap=function Le(D){const E=x(D)||a,k=!0===D.isWebGLMultipleRenderTargets?D.texture:[D.texture];for(let oe=0,ee=k.length;oe<ee;oe++){const ae=k[oe];if(S(ae,E)){const Ie=D.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,ue=i.get(ae).__webglTexture;t.bindTexture(Ie,ue),b(Ie),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function we(D){if(a&&D.samples>0&&!1===Qe(D)){const E=D.isWebGLMultipleRenderTargets?D.texture:[D.texture],k=D.width,oe=D.height;let ee=n.COLOR_BUFFER_BIT;const ae=[],Ie=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ue=i.get(D),_e=!0===D.isWebGLMultipleRenderTargets;if(_e)for(let Xe=0;Xe<E.length;Xe++)t.bindFramebuffer(n.FRAMEBUFFER,ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Xe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,ue.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Xe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,ue.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ue.__webglFramebuffer);for(let Xe=0;Xe<E.length;Xe++){ae.push(n.COLOR_ATTACHMENT0+Xe),D.depthBuffer&&ae.push(Ie);const wt=void 0!==ue.__ignoreDepthValues&&ue.__ignoreDepthValues;if(!1===wt&&(D.depthBuffer&&(ee|=n.DEPTH_BUFFER_BIT),D.stencilBuffer&&(ee|=n.STENCIL_BUFFER_BIT)),_e&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,ue.__webglColorRenderbuffer[Xe]),!0===wt&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ie]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ie])),_e){const ce=i.get(E[Xe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ce,0)}n.blitFramebuffer(0,0,k,oe,0,0,k,oe,ee,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ae)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),_e)for(let Xe=0;Xe<E.length;Xe++){t.bindFramebuffer(n.FRAMEBUFFER,ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Xe,n.RENDERBUFFER,ue.__webglColorRenderbuffer[Xe]);const wt=i.get(E[Xe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,ue.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Xe,n.TEXTURE_2D,wt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ue.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=X,this.setupFrameBufferTexture=Fe,this.useMultisampledRTT=Qe}function DY(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const c=bt.getTransfer(o);if(s===qs)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===Xs)return n.UNSIGNED_INT;if(s===us)return n.FLOAT;if(s===sd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===$i)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===Bo)return n.DEPTH_COMPONENT;if(s===Fc)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(c===Wt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return c===Wt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return c===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return c===Wt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===ko?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class IY extends On{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class to extends Nn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RY={type:"move"};class yx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new to,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new to,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new A,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new A),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new to,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new A,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new A),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const v of e.hand.values()){const g=t.getJointPose(v,i),m=this._getHandJoint(l,v);null!==g&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=null!==g}const h=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),f=.02,p=.005;l.inputState.pinching&&h>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(RY)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new to;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class PY extends hr{constructor(e,t,i,r,s,o,a,c,l,u){if((u=void 0!==u?u:Bo)!==Bo&&u!==Fc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Bo&&(i=Xs),void 0===i&&u===Fc&&(i=ko),super(null,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:dn,this.minFilter=void 0!==c?c:dn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class NY extends Hc{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,d=null,h=null,f=null,p=null;const v=t.getContextAttributes();let g=null,m=null;const _=[],y=[],x=new On;x.layers.enable(1),x.viewport=new It;const M=new On;M.layers.enable(2),M.viewport=new It;const S=[x,M],b=new IY;b.layers.enable(1),b.layers.enable(2);let I=null,w=null;function T(L){const $=y.indexOf(L.inputSource);if(-1===$)return;const de=_[$];void 0!==de&&(de.update(L.inputSource,L.frame,l||o),de.dispatchEvent({type:L.type,data:L.inputSource}))}function F(){r.removeEventListener("select",T),r.removeEventListener("selectstart",T),r.removeEventListener("selectend",T),r.removeEventListener("squeeze",T),r.removeEventListener("squeezestart",T),r.removeEventListener("squeezeend",T),r.removeEventListener("end",F),r.removeEventListener("inputsourceschange",W);for(let L=0;L<_.length;L++){const $=y[L];null!==$&&(y[L]=null,_[L].disconnect($))}I=null,w=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,m=null,Q.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function W(L){for(let $=0;$<L.removed.length;$++){const de=L.removed[$],ge=y.indexOf(de);ge>=0&&(y[ge]=null,_[ge].disconnect(de))}for(let $=0;$<L.added.length;$++){const de=L.added[$];let ge=y.indexOf(de);if(-1===ge){for(let Ae=0;Ae<_.length;Ae++){if(Ae>=y.length){y.push(de),ge=Ae;break}if(null===y[Ae]){y[Ae]=de,ge=Ae;break}}if(-1===ge)break}const ye=_[ge];ye&&ye.connect(de)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(L){let $=_[L];return void 0===$&&($=new yx,_[L]=$),$.getTargetRaySpace()},this.getControllerGrip=function(L){let $=_[L];return void 0===$&&($=new yx,_[L]=$),$.getGripSpace()},this.getHand=function(L){let $=_[L];return void 0===$&&($=new yx,_[L]=$),$.getHandSpace()},this.setFramebufferScaleFactor=function(L){s=L,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(L){a=L,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(L){l=L},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var L=function b0(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){SR(s,i,r,o,a,"next",c)}function a(c){SR(s,i,r,o,a,"throw",c)}o(void 0)})}}(function*($){if(r=$,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",F),r.addEventListener("inputsourceschange",W),!0!==v.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),m=new Go(f.framebufferWidth,f.framebufferHeight,{format:$i,type:qs,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil});else{let de=null,ge=null,ye=null;v.depth&&(ye=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,de=v.stencil?Fc:Bo,ge=v.stencil?ko:Xs);const Ae={colorFormat:t.RGBA8,depthFormat:ye,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(Ae),r.updateRenderState({layers:[h]}),m=new Go(h.textureWidth,h.textureHeight,{format:$i,type:qs,depthTexture:new PY(h.textureWidth,h.textureHeight,ge,void 0,void 0,void 0,void 0,void 0,void 0,de),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),Q.setContext(r),Q.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function($){return L.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const Y=new A,P=new A;function G(L,$){null===$?L.matrixWorld.copy(L.matrix):L.matrixWorld.multiplyMatrices($.matrixWorld,L.matrix),L.matrixWorldInverse.copy(L.matrixWorld).invert()}this.updateCamera=function(L){if(null===r)return;b.near=M.near=x.near=L.near,b.far=M.far=x.far=L.far,(I!==b.near||w!==b.far)&&(r.updateRenderState({depthNear:b.near,depthFar:b.far}),I=b.near,w=b.far);const $=L.parent,de=b.cameras;G(b,$);for(let ge=0;ge<de.length;ge++)G(de[ge],$);2===de.length?function U(L,$,de){Y.setFromMatrixPosition($.matrixWorld),P.setFromMatrixPosition(de.matrixWorld);const ge=Y.distanceTo(P),ye=$.projectionMatrix.elements,Ae=de.projectionMatrix.elements,Ue=ye[14]/(ye[10]-1),Ne=ye[14]/(ye[10]+1),Je=(ye[9]+1)/ye[5],ot=(ye[9]-1)/ye[5],Fe=(ye[8]-1)/ye[0],R=(Ae[8]+1)/Ae[0],fe=Ue*Fe,X=Ue*R,re=ge/(-Fe+R),J=re*-Fe;$.matrixWorld.decompose(L.position,L.quaternion,L.scale),L.translateX(J),L.translateZ(re),L.matrixWorld.compose(L.position,L.quaternion,L.scale),L.matrixWorldInverse.copy(L.matrixWorld).invert();const Le=Ue+re,we=Ne+re;L.projectionMatrix.makePerspective(fe-J,X+(ge-J),Je*Ne/we*Le,ot*Ne/we*Le,Le,we),L.projectionMatrixInverse.copy(L.projectionMatrix).invert()}(b,x,M):b.projectionMatrix.copy(x.projectionMatrix),function j(L,$,de){null===de?L.matrix.copy($.matrixWorld):(L.matrix.copy(de.matrixWorld),L.matrix.invert(),L.matrix.multiply($.matrixWorld)),L.matrix.decompose(L.position,L.quaternion,L.scale),L.updateMatrixWorld(!0),L.projectionMatrix.copy($.projectionMatrix),L.projectionMatrixInverse.copy($.projectionMatrixInverse),L.isPerspectiveCamera&&(L.fov=2*zc*Math.atan(1/L.projectionMatrix.elements[5]),L.zoom=1)}(L,b,$)},this.getCamera=function(){return b},this.getFoveation=function(){if(null!==h||null!==f)return c},this.setFoveation=function(L){c=L,null!==h&&(h.fixedFoveation=L),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=L)};let ie=null;const Q=new B1;Q.setAnimationLoop(function Z(L,$){if(u=$.getViewerPose(l||o),p=$,null!==u){const de=u.views;null!==f&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let ge=!1;de.length!==b.cameras.length&&(b.cameras.length=0,ge=!0);for(let ye=0;ye<de.length;ye++){const Ae=de[ye];let Ue=null;if(null!==f)Ue=f.getViewport(Ae);else{const Je=d.getViewSubImage(h,Ae);Ue=Je.viewport,0===ye&&(e.setRenderTargetTextures(m,Je.colorTexture,h.ignoreDepthValues?void 0:Je.depthStencilTexture),e.setRenderTarget(m))}let Ne=S[ye];void 0===Ne&&(Ne=new On,Ne.layers.enable(ye),Ne.viewport=new It,S[ye]=Ne),Ne.matrix.fromArray(Ae.transform.matrix),Ne.matrix.decompose(Ne.position,Ne.quaternion,Ne.scale),Ne.projectionMatrix.fromArray(Ae.projectionMatrix),Ne.projectionMatrixInverse.copy(Ne.projectionMatrix).invert(),Ne.viewport.set(Ue.x,Ue.y,Ue.width,Ue.height),0===ye&&(b.matrix.copy(Ne.matrix),b.matrix.decompose(b.position,b.quaternion,b.scale)),!0===ge&&b.cameras.push(Ne)}}for(let de=0;de<_.length;de++){const ge=y[de],ye=_[de];null!==ge&&void 0!==ye&&ye.update(ge,$,l||o)}ie&&ie(L,$),$.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:$}),p=null}),this.setAnimationLoop=function(L){ie=L},this.dispose=function(){}}}function LY(n,e){function t(g,m){!0===g.matrixAutoUpdate&&g.updateMatrix(),m.value.copy(g.matrix)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const _=e.get(m).envMap;if(_&&(g.envMap.value=_,g.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const y=!0===n._useLegacyLights?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*y,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}return{refreshFogUniforms:function i(g,m){m.color.getRGB(g.fogColor.value,k1(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function r(g,m,_,y,x){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}(g,m)):m.isMeshPhongMaterial?(s(g,m),function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}(g,m)):m.isMeshStandardMaterial?(s(g,m),function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}(g,m),m.isMeshPhysicalMaterial&&function f(g,m,_){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),1===m.side&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=_.texture,g.transmissionSamplerSize.value.set(_.width,_.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}(g,m,x)):m.isMeshMatcapMaterial?(s(g,m),function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),function v(g,m){const _=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(_.matrixWorld),g.nearDistance.value=_.shadow.camera.near,g.farDistance.value=_.shadow.camera.far}(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}(g,m),m.isLineDashedMaterial&&function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function c(g,m,_,y){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*_,g.scale.value=.5*y,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m,_,y):m.isSpriteMaterial?function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function OY(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(_,y,x){const M=_.value;if(void 0===x[y]){if("number"==typeof M)x[y]=M;else{const S=Array.isArray(M)?M:[M],b=[];for(let I=0;I<S.length;I++)b.push(S[I].clone());x[y]=b}return!0}if("number"==typeof M){if(x[y]!==M)return x[y]=M,!0}else{const S=Array.isArray(x[y])?x[y]:[x[y]],b=Array.isArray(M)?M:[M];for(let I=0;I<S.length;I++){const w=S[I];if(!1===w.equals(b[I]))return w.copy(b[I]),!0}}return!1}function v(_){const y={boundary:0,storage:0};return"number"==typeof _?(y.boundary=4,y.storage=4):_.isVector2?(y.boundary=8,y.storage=8):_.isVector3||_.isColor?(y.boundary=16,y.storage=12):_.isVector4?(y.boundary=16,y.storage=16):_.isMatrix3?(y.boundary=48,y.storage=48):_.isMatrix4?(y.boundary=64,y.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),y}function g(_){const y=_.target;y.removeEventListener("dispose",g);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function c(_,y){i.uniformBlockBinding(_,y.program)},update:function l(_,y){let x=r[_.id];void 0===x&&(function p(_){const y=_.uniforms;let x=0;let S=0;for(let b=0,I=y.length;b<I;b++){const w=y[b],T={boundary:0,storage:0},F=Array.isArray(w.value)?w.value:[w.value];for(let W=0,Y=F.length;W<Y;W++){const U=v(F[W]);T.boundary+=U.boundary,T.storage+=U.storage}w.__data=new Float32Array(T.storage/Float32Array.BYTES_PER_ELEMENT),w.__offset=x,b>0&&(S=x%16,0!==S&&16-S-T.boundary<0&&(x+=16-S,w.__offset=x)),x+=T.storage}S=x%16,S>0&&(x+=16-S),_.__size=x,_.__cache={}}(_),x=function u(_){const y=function d(){for(let _=0;_<a;_++)if(-1===o.indexOf(_))return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();_.__bindingPointIndex=y;const x=n.createBuffer(),M=_.__size,S=_.usage;return n.bindBuffer(n.UNIFORM_BUFFER,x),n.bufferData(n.UNIFORM_BUFFER,M,S),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,x),x}(_),r[_.id]=x,_.addEventListener("dispose",g)),i.updateUBOMapping(_,y.program);const S=e.render.frame;s[_.id]!==S&&(function h(_){const x=_.uniforms,M=_.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[_.id]);for(let S=0,b=x.length;S<b;S++){const I=x[S];if(!0===f(I,S,M)){const w=I.__offset,T=Array.isArray(I.value)?I.value:[I.value];let F=0;for(let W=0;W<T.length;W++){const Y=T[W],P=v(Y);"number"==typeof Y?(I.__data[0]=Y,n.bufferSubData(n.UNIFORM_BUFFER,w+F,I.__data)):Y.isMatrix3?(I.__data[0]=Y.elements[0],I.__data[1]=Y.elements[1],I.__data[2]=Y.elements[2],I.__data[3]=Y.elements[0],I.__data[4]=Y.elements[3],I.__data[5]=Y.elements[4],I.__data[6]=Y.elements[5],I.__data[7]=Y.elements[0],I.__data[8]=Y.elements[6],I.__data[9]=Y.elements[7],I.__data[10]=Y.elements[8],I.__data[11]=Y.elements[0]):(Y.toArray(I.__data,F),F+=P.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,w,I.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(_),s[_.id]=S)},dispose:function m(){for(const _ in r)n.deleteBuffer(r[_]);o=[],r={},s={}}}}class pP{constructor(e={}){const{canvas:t=pq(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;let h;this.isWebGLRenderer=!0,h=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let v=null,g=null;const m=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Gt,this._useLegacyLights=!1,this.toneMapping=js,this.toneMappingExposure=1;const y=this;let x=!1,M=0,S=0,b=null,I=-1,w=null;const T=new It,F=new It;let W=null;const Y=new me(0);let P=0,U=t.width,G=t.height,j=1,ie=null,Z=null;const Q=new It(0,0,U,G),L=new It(0,0,U,G);let $=!1;const de=new ux;let ge=!1,ye=!1,Ae=null;const Ue=new We,Ne=new K,Je=new A,ot={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Fe(){return null===b?j:1}let X,re,J,Le,we,Te,Qe,ht,nn,D,E,k,oe,ee,ae,Ie,ue,_e,Xe,wt,ce,Rt,et,Ye,R=i;function fe(C,O){for(let B=0;B<C.length;B++){const H=t.getContext(C[B],O);if(null!==H)return H}return null}try{const C={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r158"),t.addEventListener("webglcontextlost",gt,!1),t.addEventListener("webglcontextrestored",N,!1),t.addEventListener("webglcontextcreationerror",xe,!1),null===R){const O=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&O.shift(),R=fe(O,C),null===R)throw fe(O)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&R instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===R.getShaderPrecisionFormat&&(R.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(C){throw console.error("THREE.WebGLRenderer: "+C.message),C}function Ve(){X=new qX(R),re=new HX(R,X,e),X.init(re),Rt=new DY(R,X,re),J=new CY(R,X,re),Le=new ZX(R),we=new mY,Te=new AY(R,X,J,we,re,Rt,Le),Qe=new GX(y),ht=new $X(y),nn=new Vq(R,re),et=new BX(R,X,nn,re),D=new XX(R,nn,Le,et),E=new e7(R,D,nn,Le),Xe=new QX(R,re,Te),Ie=new zX(we),k=new pY(y,Qe,ht,X,re,et,Ie),oe=new LY(y,we),ee=new vY,ae=new SY(X,re),_e=new kX(y,Qe,ht,J,E,h,c),ue=new TY(y,E,re),Ye=new OY(R,Le,re,J),wt=new VX(R,X,Le,re),ce=new YX(R,X,Le,re),Le.programs=k.programs,y.capabilities=re,y.extensions=X,y.properties=we,y.renderLists=ee,y.shadowMap=ue,y.state=J,y.info=Le}Ve();const be=new NY(y,R);function gt(C){C.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function N(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const C=Le.autoReset,O=ue.enabled,B=ue.autoUpdate,V=ue.needsUpdate,H=ue.type;Ve(),Le.autoReset=C,ue.enabled=O,ue.autoUpdate=B,ue.needsUpdate=V,ue.type=H}function xe(C){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",C.statusMessage)}function le(C){const O=C.target;O.removeEventListener("dispose",le),function q(C){(function he(C){const O=we.get(C).programs;void 0!==O&&(O.forEach(function(B){k.releaseProgram(B)}),C.isShaderMaterial&&k.releaseShaderCache(C))})(C),we.remove(C)}(O)}function ze(C,O,B){!0===C.transparent&&2===C.side&&!1===C.forceSinglePass?(C.side=1,C.needsUpdate=!0,Hm(C,O,B),C.side=0,C.needsUpdate=!0,Hm(C,O,B),C.side=2):Hm(C,O,B)}this.xr=be,this.getContext=function(){return R},this.getContextAttributes=function(){return R.getContextAttributes()},this.forceContextLoss=function(){const C=X.get("WEBGL_lose_context");C&&C.loseContext()},this.forceContextRestore=function(){const C=X.get("WEBGL_lose_context");C&&C.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(C){void 0!==C&&(j=C,this.setSize(U,G,!1))},this.getSize=function(C){return C.set(U,G)},this.setSize=function(C,O,B=!0){be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(U=C,G=O,t.width=Math.floor(C*j),t.height=Math.floor(O*j),!0===B&&(t.style.width=C+"px",t.style.height=O+"px"),this.setViewport(0,0,C,O))},this.getDrawingBufferSize=function(C){return C.set(U*j,G*j).floor()},this.setDrawingBufferSize=function(C,O,B){U=C,G=O,j=B,t.width=Math.floor(C*B),t.height=Math.floor(O*B),this.setViewport(0,0,C,O)},this.getCurrentViewport=function(C){return C.copy(T)},this.getViewport=function(C){return C.copy(Q)},this.setViewport=function(C,O,B,V){C.isVector4?Q.set(C.x,C.y,C.z,C.w):Q.set(C,O,B,V),J.viewport(T.copy(Q).multiplyScalar(j).floor())},this.getScissor=function(C){return C.copy(L)},this.setScissor=function(C,O,B,V){C.isVector4?L.set(C.x,C.y,C.z,C.w):L.set(C,O,B,V),J.scissor(F.copy(L).multiplyScalar(j).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(C){J.setScissorTest($=C)},this.setOpaqueSort=function(C){ie=C},this.setTransparentSort=function(C){Z=C},this.getClearColor=function(C){return C.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor.apply(_e,arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha.apply(_e,arguments)},this.clear=function(C=!0,O=!0,B=!0){let V=0;if(C){let H=!1;if(null!==b){const Ee=b.texture.format;H=1033===Ee||1031===Ee||1029===Ee}if(H){const Ee=b.texture.type,Re=Ee===qs||Ee===Xs||1012===Ee||Ee===ko||1017===Ee||1018===Ee,Ge=_e.getClearColor(),Ze=_e.getClearAlpha(),lt=Ge.r,tt=Ge.g,rt=Ge.b;Re?(f[0]=lt,f[1]=tt,f[2]=rt,f[3]=Ze,R.clearBufferuiv(R.COLOR,0,f)):(p[0]=lt,p[1]=tt,p[2]=rt,p[3]=Ze,R.clearBufferiv(R.COLOR,0,p))}else V|=R.COLOR_BUFFER_BIT}O&&(V|=R.DEPTH_BUFFER_BIT),B&&(V|=R.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),R.clear(V)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",gt,!1),t.removeEventListener("webglcontextrestored",N,!1),t.removeEventListener("webglcontextcreationerror",xe,!1),ee.dispose(),ae.dispose(),we.dispose(),Qe.dispose(),ht.dispose(),E.dispose(),et.dispose(),Ye.dispose(),k.dispose(),be.dispose(),be.removeEventListener("sessionstart",Ji),be.removeEventListener("sessionend",Vt),Ae&&(Ae.dispose(),Ae=null),li.stop()},this.renderBufferDirect=function(C,O,B,V,H,Ee){null===O&&(O=ot);const Re=H.isMesh&&H.matrixWorld.determinant()<0,Ge=function WJ(C,O,B,V,H){!0!==O.isScene&&(O=ot),Te.resetTextureUnits();const Ee=O.fog,Ge=null===b?y.outputColorSpace:!0===b.isXRRenderTarget?b.texture.colorSpace:Bn,Ze=(V.isMeshStandardMaterial?ht:Qe).get(V.envMap||(V.isMeshStandardMaterial?O.environment:null)),lt=!0===V.vertexColors&&!!B.attributes.color&&4===B.attributes.color.itemSize,tt=!!B.attributes.tangent&&(!!V.normalMap||V.anisotropy>0),rt=!!B.morphAttributes.position,fn=!!B.morphAttributes.normal,Ui=!!B.morphAttributes.color;let Fn=js;V.toneMapped&&(null===b||!0===b.isXRRenderTarget)&&(Fn=y.toneMapping);const Ms=B.morphAttributes.position||B.morphAttributes.normal||B.morphAttributes.color,rn=void 0!==Ms?Ms.length:0,ft=we.get(V),TM=g.state.lights;!0!==ge||!0!==ye&&C===w||Ie.setState(V,C,C===w&&V.id===I);let Mn=!1;V.version===ft.__version?(ft.needsLights&&ft.lightsStateVersion!==TM.state.version||ft.outputColorSpace!==Ge||H.isInstancedMesh&&!1===ft.instancing||!H.isInstancedMesh&&!0===ft.instancing||H.isSkinnedMesh&&!1===ft.skinning||!H.isSkinnedMesh&&!0===ft.skinning||H.isInstancedMesh&&!0===ft.instancingColor&&null===H.instanceColor||H.isInstancedMesh&&!1===ft.instancingColor&&null!==H.instanceColor||ft.envMap!==Ze||!0===V.fog&&ft.fog!==Ee||void 0!==ft.numClippingPlanes&&(ft.numClippingPlanes!==Ie.numPlanes||ft.numIntersection!==Ie.numIntersection)||ft.vertexAlphas!==lt||ft.vertexTangents!==tt||ft.morphTargets!==rt||ft.morphNormals!==fn||ft.morphColors!==Ui||ft.toneMapping!==Fn||!0===re.isWebGL2&&ft.morphTargetsCount!==rn)&&(Mn=!0):(Mn=!0,ft.__version=V.version);let da=ft.currentProgram;!0===Mn&&(da=Hm(V,O,H));let yL=!1,Bd=!1,CM=!1;const ui=da.getUniforms(),ha=ft.uniforms;if(J.useProgram(da.program)&&(yL=!0,Bd=!0,CM=!0),V.id!==I&&(I=V.id,Bd=!0),yL||w!==C){ui.setValue(R,"projectionMatrix",C.projectionMatrix),ui.setValue(R,"viewMatrix",C.matrixWorldInverse);const ki=ui.map.cameraPosition;void 0!==ki&&ki.setValue(R,Je.setFromMatrixPosition(C.matrixWorld)),re.logarithmicDepthBuffer&&ui.setValue(R,"logDepthBufFC",2/(Math.log(C.far+1)/Math.LN2)),(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial)&&ui.setValue(R,"isOrthographic",!0===C.isOrthographicCamera),w!==C&&(w=C,Bd=!0,CM=!0)}if(H.isSkinnedMesh){ui.setOptional(R,H,"bindMatrix"),ui.setOptional(R,H,"bindMatrixInverse");const ki=H.skeleton;ki&&(re.floatVertexTextures?(null===ki.boneTexture&&ki.computeBoneTexture(),ui.setValue(R,"boneTexture",ki.boneTexture,Te),ui.setValue(R,"boneTextureSize",ki.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const AM=B.morphAttributes;if((void 0!==AM.position||void 0!==AM.normal||void 0!==AM.color&&!0===re.isWebGL2)&&Xe.update(H,B,da),(Bd||ft.receiveShadow!==H.receiveShadow)&&(ft.receiveShadow=H.receiveShadow,ui.setValue(R,"receiveShadow",H.receiveShadow)),V.isMeshGouraudMaterial&&null!==V.envMap&&(ha.envMap.value=Ze,ha.flipEnvMap.value=Ze.isCubeTexture&&!1===Ze.isRenderTargetTexture?-1:1),Bd&&(ui.setValue(R,"toneMappingExposure",y.toneMappingExposure),ft.needsLights&&function jJ(C,O){C.ambientLightColor.needsUpdate=O,C.lightProbe.needsUpdate=O,C.directionalLights.needsUpdate=O,C.directionalLightShadows.needsUpdate=O,C.pointLights.needsUpdate=O,C.pointLightShadows.needsUpdate=O,C.spotLights.needsUpdate=O,C.spotLightShadows.needsUpdate=O,C.rectAreaLights.needsUpdate=O,C.hemisphereLights.needsUpdate=O}(ha,CM),Ee&&!0===V.fog&&oe.refreshFogUniforms(ha,Ee),oe.refreshMaterialUniforms(ha,V,j,G,Ae),Qp.upload(R,gL(ft),ha,Te)),V.isShaderMaterial&&!0===V.uniformsNeedUpdate&&(Qp.upload(R,gL(ft),ha,Te),V.uniformsNeedUpdate=!1),V.isSpriteMaterial&&ui.setValue(R,"center",H.center),ui.setValue(R,"modelViewMatrix",H.modelViewMatrix),ui.setValue(R,"normalMatrix",H.normalMatrix),ui.setValue(R,"modelMatrix",H.matrixWorld),V.isShaderMaterial||V.isRawShaderMaterial){const ki=V.uniformsGroups;for(let DM=0,qJ=ki.length;DM<qJ;DM++)if(re.isWebGL2){const _L=ki[DM];Ye.update(_L,da),Ye.bind(_L,da)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return da}(C,O,B,V,H);J.setMaterial(V,Re);let Ze=B.index,lt=1;if(!0===V.wireframe){if(Ze=D.getWireframeAttribute(B),void 0===Ze)return;lt=2}const tt=B.drawRange,rt=B.attributes.position;let fn=tt.start*lt,Ui=(tt.start+tt.count)*lt;null!==Ee&&(fn=Math.max(fn,Ee.start*lt),Ui=Math.min(Ui,(Ee.start+Ee.count)*lt)),null!==Ze?(fn=Math.max(fn,0),Ui=Math.min(Ui,Ze.count)):null!=rt&&(fn=Math.max(fn,0),Ui=Math.min(Ui,rt.count));const Fn=Ui-fn;if(Fn<0||Fn===1/0)return;et.setup(H,V,Ge,B,Ze);let Ms,rn=wt;if(null!==Ze&&(Ms=nn.get(Ze),rn=ce,rn.setIndex(Ms)),H.isMesh)!0===V.wireframe?(J.setLineWidth(V.wireframeLinewidth*Fe()),rn.setMode(R.LINES)):rn.setMode(R.TRIANGLES);else if(H.isLine){let ft=V.linewidth;void 0===ft&&(ft=1),J.setLineWidth(ft*Fe()),rn.setMode(H.isLineSegments?R.LINES:H.isLineLoop?R.LINE_LOOP:R.LINE_STRIP)}else H.isPoints?rn.setMode(R.POINTS):H.isSprite&&rn.setMode(R.TRIANGLES);if(H.isInstancedMesh)rn.renderInstances(fn,Fn,H.count);else if(B.isInstancedBufferGeometry){const TM=Math.min(B.instanceCount,void 0!==B._maxInstanceCount?B._maxInstanceCount:1/0);rn.renderInstances(fn,Fn,TM)}else rn.render(fn,Fn)},this.compile=function(C,O,B=null){null===B&&(B=C),g=ae.get(B),g.init(),_.push(g),B.traverseVisible(function(H){H.isLight&&H.layers.test(O.layers)&&(g.pushLight(H),H.castShadow&&g.pushShadow(H))}),C!==B&&C.traverseVisible(function(H){H.isLight&&H.layers.test(O.layers)&&(g.pushLight(H),H.castShadow&&g.pushShadow(H))}),g.setupLights(y._useLegacyLights);const V=new Set;return C.traverse(function(H){const Ee=H.material;if(Ee)if(Array.isArray(Ee))for(let Re=0;Re<Ee.length;Re++){const Ge=Ee[Re];ze(Ge,B,H),V.add(Ge)}else ze(Ee,B,H),V.add(Ee)}),_.pop(),g=null,V},this.compileAsync=function(C,O,B=null){const V=this.compile(C,O,B);return new Promise(H=>{function Ee(){V.forEach(function(Re){we.get(Re).currentProgram.isReady()&&V.delete(Re)}),0!==V.size?setTimeout(Ee,10):H(C)}null!==X.get("KHR_parallel_shader_compile")?Ee():setTimeout(Ee,10)})};let St=null;function Ji(){li.stop()}function Vt(){li.start()}const li=new B1;function Gr(C,O,B,V){if(!1===C.visible)return;if(C.layers.test(O.layers))if(C.isGroup)B=C.renderOrder;else if(C.isLOD)!0===C.autoUpdate&&C.update(O);else if(C.isLight)g.pushLight(C),C.castShadow&&g.pushShadow(C);else if(C.isSprite){if(!C.frustumCulled||de.intersectsSprite(C)){V&&Je.setFromMatrixPosition(C.matrixWorld).applyMatrix4(Ue);const Re=E.update(C),Ge=C.material;Ge.visible&&v.push(C,Re,Ge,B,Je.z,null)}}else if((C.isMesh||C.isLine||C.isPoints)&&(!C.frustumCulled||de.intersectsObject(C))){const Re=E.update(C),Ge=C.material;if(V&&(void 0!==C.boundingSphere?(null===C.boundingSphere&&C.computeBoundingSphere(),Je.copy(C.boundingSphere.center)):(null===Re.boundingSphere&&Re.computeBoundingSphere(),Je.copy(Re.boundingSphere.center)),Je.applyMatrix4(C.matrixWorld).applyMatrix4(Ue)),Array.isArray(Ge)){const Ze=Re.groups;for(let lt=0,tt=Ze.length;lt<tt;lt++){const rt=Ze[lt],fn=Ge[rt.materialIndex];fn&&fn.visible&&v.push(C,Re,fn,B,Je.z,rt)}}else Ge.visible&&v.push(C,Re,Ge,B,Je.z,null)}const Ee=C.children;for(let Re=0,Ge=Ee.length;Re<Ge;Re++)Gr(Ee[Re],O,B,V)}function pL(C,O,B,V){const H=C.opaque,Ee=C.transmissive,Re=C.transparent;g.setupLightsView(B),!0===ge&&Ie.setGlobalState(y.clippingPlanes,B),Ee.length>0&&function GJ(C,O,B,V){if(null!==(!0===B.isScene?B.overrideMaterial:null))return;const Ee=re.isWebGL2;null===Ae&&(Ae=new Go(1,1,{generateMipmaps:!0,type:X.has("EXT_color_buffer_half_float")?sd:qs,minFilter:ls,samples:Ee?4:0})),y.getDrawingBufferSize(Ne),Ee?Ae.setSize(Ne.x,Ne.y):Ae.setSize(Tp(Ne.x),Tp(Ne.y));const Re=y.getRenderTarget();y.setRenderTarget(Ae),y.getClearColor(Y),P=y.getClearAlpha(),P<1&&y.setClearColor(16777215,.5),y.clear();const Ge=y.toneMapping;y.toneMapping=js,Vm(C,B,V),Te.updateMultisampleRenderTarget(Ae),Te.updateRenderTargetMipmap(Ae);let Ze=!1;for(let lt=0,tt=O.length;lt<tt;lt++){const rt=O[lt],fn=rt.object,Ui=rt.geometry,Fn=rt.material,Ms=rt.group;if(2===Fn.side&&fn.layers.test(V.layers)){const rn=Fn.side;Fn.side=1,Fn.needsUpdate=!0,mL(fn,B,V,Ui,Fn,Ms),Fn.side=rn,Fn.needsUpdate=!0,Ze=!0}}!0===Ze&&(Te.updateMultisampleRenderTarget(Ae),Te.updateRenderTargetMipmap(Ae)),y.setRenderTarget(Re),y.setClearColor(Y,P),y.toneMapping=Ge}(H,Ee,O,B),V&&J.viewport(T.copy(V)),H.length>0&&Vm(H,O,B),Ee.length>0&&Vm(Ee,O,B),Re.length>0&&Vm(Re,O,B),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1)}function Vm(C,O,B){const V=!0===O.isScene?O.overrideMaterial:null;for(let H=0,Ee=C.length;H<Ee;H++){const Re=C[H],Ge=Re.object,Ze=Re.geometry,lt=null===V?Re.material:V,tt=Re.group;Ge.layers.test(B.layers)&&mL(Ge,O,B,Ze,lt,tt)}}function mL(C,O,B,V,H,Ee){C.onBeforeRender(y,O,B,V,H,Ee),C.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,C.matrixWorld),C.normalMatrix.getNormalMatrix(C.modelViewMatrix),H.onBeforeRender(y,O,B,V,C,Ee),!0===H.transparent&&2===H.side&&!1===H.forceSinglePass?(H.side=1,H.needsUpdate=!0,y.renderBufferDirect(B,O,V,H,C,Ee),H.side=0,H.needsUpdate=!0,y.renderBufferDirect(B,O,V,H,C,Ee),H.side=2):y.renderBufferDirect(B,O,V,H,C,Ee),C.onAfterRender(y,O,B,V,H,Ee)}function Hm(C,O,B){!0!==O.isScene&&(O=ot);const V=we.get(C),H=g.state.lights,Re=H.state.version,Ge=k.getParameters(C,H.state,g.state.shadowsArray,O,B),Ze=k.getProgramCacheKey(Ge);let lt=V.programs;V.environment=C.isMeshStandardMaterial?O.environment:null,V.fog=O.fog,V.envMap=(C.isMeshStandardMaterial?ht:Qe).get(C.envMap||V.environment),void 0===lt&&(C.addEventListener("dispose",le),lt=new Map,V.programs=lt);let tt=lt.get(Ze);if(void 0!==tt){if(V.currentProgram===tt&&V.lightsStateVersion===Re)return vL(C,Ge),tt}else Ge.uniforms=k.getUniforms(C),C.onBuild(B,Ge,y),C.onBeforeCompile(Ge,y),tt=k.acquireProgram(Ge,Ze),lt.set(Ze,tt),V.uniforms=Ge.uniforms;const rt=V.uniforms;return(!C.isShaderMaterial&&!C.isRawShaderMaterial||!0===C.clipping)&&(rt.clippingPlanes=Ie.uniform),vL(C,Ge),V.needsLights=function $J(C){return C.isMeshLambertMaterial||C.isMeshToonMaterial||C.isMeshPhongMaterial||C.isMeshStandardMaterial||C.isShadowMaterial||C.isShaderMaterial&&!0===C.lights}(C),V.lightsStateVersion=Re,V.needsLights&&(rt.ambientLightColor.value=H.state.ambient,rt.lightProbe.value=H.state.probe,rt.directionalLights.value=H.state.directional,rt.directionalLightShadows.value=H.state.directionalShadow,rt.spotLights.value=H.state.spot,rt.spotLightShadows.value=H.state.spotShadow,rt.rectAreaLights.value=H.state.rectArea,rt.ltc_1.value=H.state.rectAreaLTC1,rt.ltc_2.value=H.state.rectAreaLTC2,rt.pointLights.value=H.state.point,rt.pointLightShadows.value=H.state.pointShadow,rt.hemisphereLights.value=H.state.hemi,rt.directionalShadowMap.value=H.state.directionalShadowMap,rt.directionalShadowMatrix.value=H.state.directionalShadowMatrix,rt.spotShadowMap.value=H.state.spotShadowMap,rt.spotLightMatrix.value=H.state.spotLightMatrix,rt.spotLightMap.value=H.state.spotLightMap,rt.pointShadowMap.value=H.state.pointShadowMap,rt.pointShadowMatrix.value=H.state.pointShadowMatrix),V.currentProgram=tt,V.uniformsList=null,tt}function gL(C){if(null===C.uniformsList){const O=C.currentProgram.getUniforms();C.uniformsList=Qp.seqWithValue(O.seq,C.uniforms)}return C.uniformsList}function vL(C,O){const B=we.get(C);B.outputColorSpace=O.outputColorSpace,B.instancing=O.instancing,B.instancingColor=O.instancingColor,B.skinning=O.skinning,B.morphTargets=O.morphTargets,B.morphNormals=O.morphNormals,B.morphColors=O.morphColors,B.morphTargetsCount=O.morphTargetsCount,B.numClippingPlanes=O.numClippingPlanes,B.numIntersection=O.numClipIntersection,B.vertexAlphas=O.vertexAlphas,B.vertexTangents=O.vertexTangents,B.toneMapping=O.toneMapping}li.setAnimationLoop(function xn(C){St&&St(C)}),typeof self<"u"&&li.setContext(self),this.setAnimationLoop=function(C){St=C,be.setAnimationLoop(C),null===C?li.stop():li.start()},be.addEventListener("sessionstart",Ji),be.addEventListener("sessionend",Vt),this.render=function(C,O){if(void 0===O||!0===O.isCamera){if(!0!==x){if(!0===C.matrixWorldAutoUpdate&&C.updateMatrixWorld(),null===O.parent&&!0===O.matrixWorldAutoUpdate&&O.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(O),O=be.getCamera()),!0===C.isScene&&C.onBeforeRender(y,C,O,b),g=ae.get(C,_.length),g.init(),_.push(g),Ue.multiplyMatrices(O.projectionMatrix,O.matrixWorldInverse),de.setFromProjectionMatrix(Ue),ye=this.localClippingEnabled,ge=Ie.init(this.clippingPlanes,ye),v=ee.get(C,m.length),v.init(),m.push(v),Gr(C,O,0,y.sortObjects),v.finish(),!0===y.sortObjects&&v.sort(ie,Z),this.info.render.frame++,!0===ge&&Ie.beginShadows(),ue.render(g.state.shadowsArray,C,O),!0===ge&&Ie.endShadows(),!0===this.info.autoReset&&this.info.reset(),_e.render(v,C),g.setupLights(y._useLegacyLights),O.isArrayCamera){const V=O.cameras;for(let H=0,Ee=V.length;H<Ee;H++){const Re=V[H];pL(v,C,Re,Re.viewport)}}else pL(v,C,O);null!==b&&(Te.updateMultisampleRenderTarget(b),Te.updateRenderTargetMipmap(b)),!0===C.isScene&&C.onAfterRender(y,C,O),et.resetDefaultState(),I=-1,w=null,_.pop(),g=_.length>0?_[_.length-1]:null,m.pop(),v=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(C,O,B){we.get(C.texture).__webglTexture=O,we.get(C.depthTexture).__webglTexture=B;const V=we.get(C);V.__hasExternalTextures=!0,V.__hasExternalTextures&&(V.__autoAllocateDepthBuffer=void 0===B,V.__autoAllocateDepthBuffer||!0===X.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),V.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(C,O){const B=we.get(C);B.__webglFramebuffer=O,B.__useDefaultFramebuffer=void 0===O},this.setRenderTarget=function(C,O=0,B=0){b=C,M=O,S=B;let V=!0,H=null,Ee=!1,Re=!1;if(C){const Ze=we.get(C);void 0!==Ze.__useDefaultFramebuffer?(J.bindFramebuffer(R.FRAMEBUFFER,null),V=!1):void 0===Ze.__webglFramebuffer?Te.setupRenderTarget(C):Ze.__hasExternalTextures&&Te.rebindTextures(C,we.get(C.texture).__webglTexture,we.get(C.depthTexture).__webglTexture);const lt=C.texture;(lt.isData3DTexture||lt.isDataArrayTexture||lt.isCompressedArrayTexture)&&(Re=!0);const tt=we.get(C).__webglFramebuffer;C.isWebGLCubeRenderTarget?(H=Array.isArray(tt[O])?tt[O][B]:tt[O],Ee=!0):H=re.isWebGL2&&C.samples>0&&!1===Te.useMultisampledRTT(C)?we.get(C).__webglMultisampledFramebuffer:Array.isArray(tt)?tt[B]:tt,T.copy(C.viewport),F.copy(C.scissor),W=C.scissorTest}else T.copy(Q).multiplyScalar(j).floor(),F.copy(L).multiplyScalar(j).floor(),W=$;if(J.bindFramebuffer(R.FRAMEBUFFER,H)&&re.drawBuffers&&V&&J.drawBuffers(C,H),J.viewport(T),J.scissor(F),J.setScissorTest(W),Ee){const Ze=we.get(C.texture);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+O,Ze.__webglTexture,B)}else if(Re){const Ze=we.get(C.texture);R.framebufferTextureLayer(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,Ze.__webglTexture,B||0,O||0)}I=-1},this.readRenderTargetPixels=function(C,O,B,V,H,Ee,Re){if(!C||!C.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ge=we.get(C).__webglFramebuffer;if(C.isWebGLCubeRenderTarget&&void 0!==Re&&(Ge=Ge[Re]),Ge){J.bindFramebuffer(R.FRAMEBUFFER,Ge);try{const Ze=C.texture,lt=Ze.format,tt=Ze.type;if(lt!==$i&&Rt.convert(lt)!==R.getParameter(R.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const rt=tt===sd&&(X.has("EXT_color_buffer_half_float")||re.isWebGL2&&X.has("EXT_color_buffer_float"));if(!(tt===qs||Rt.convert(tt)===R.getParameter(R.IMPLEMENTATION_COLOR_READ_TYPE)||tt===us&&(re.isWebGL2||X.has("OES_texture_float")||X.has("WEBGL_color_buffer_float"))||rt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");O>=0&&O<=C.width-V&&B>=0&&B<=C.height-H&&R.readPixels(O,B,V,H,Rt.convert(lt),Rt.convert(tt),Ee)}finally{const Ze=null!==b?we.get(b).__webglFramebuffer:null;J.bindFramebuffer(R.FRAMEBUFFER,Ze)}}},this.copyFramebufferToTexture=function(C,O,B=0){const V=Math.pow(2,-B),H=Math.floor(O.image.width*V),Ee=Math.floor(O.image.height*V);Te.setTexture2D(O,0),R.copyTexSubImage2D(R.TEXTURE_2D,B,0,0,C.x,C.y,H,Ee),J.unbindTexture()},this.copyTextureToTexture=function(C,O,B,V=0){const H=O.image.width,Ee=O.image.height,Re=Rt.convert(B.format),Ge=Rt.convert(B.type);Te.setTexture2D(B,0),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,B.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,B.unpackAlignment),O.isDataTexture?R.texSubImage2D(R.TEXTURE_2D,V,C.x,C.y,H,Ee,Re,Ge,O.image.data):O.isCompressedTexture?R.compressedTexSubImage2D(R.TEXTURE_2D,V,C.x,C.y,O.mipmaps[0].width,O.mipmaps[0].height,Re,O.mipmaps[0].data):R.texSubImage2D(R.TEXTURE_2D,V,C.x,C.y,Re,Ge,O.image),0===V&&B.generateMipmaps&&R.generateMipmap(R.TEXTURE_2D),J.unbindTexture()},this.copyTextureToTexture3D=function(C,O,B,V,H=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ee=C.max.x-C.min.x+1,Re=C.max.y-C.min.y+1,Ge=C.max.z-C.min.z+1,Ze=Rt.convert(V.format),lt=Rt.convert(V.type);let tt;if(V.isData3DTexture)Te.setTexture3D(V,0),tt=R.TEXTURE_3D;else{if(!V.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Te.setTexture2DArray(V,0),tt=R.TEXTURE_2D_ARRAY}R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,V.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,V.unpackAlignment);const rt=R.getParameter(R.UNPACK_ROW_LENGTH),fn=R.getParameter(R.UNPACK_IMAGE_HEIGHT),Ui=R.getParameter(R.UNPACK_SKIP_PIXELS),Fn=R.getParameter(R.UNPACK_SKIP_ROWS),Ms=R.getParameter(R.UNPACK_SKIP_IMAGES),rn=B.isCompressedTexture?B.mipmaps[0]:B.image;R.pixelStorei(R.UNPACK_ROW_LENGTH,rn.width),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,rn.height),R.pixelStorei(R.UNPACK_SKIP_PIXELS,C.min.x),R.pixelStorei(R.UNPACK_SKIP_ROWS,C.min.y),R.pixelStorei(R.UNPACK_SKIP_IMAGES,C.min.z),B.isDataTexture||B.isData3DTexture?R.texSubImage3D(tt,H,O.x,O.y,O.z,Ee,Re,Ge,Ze,lt,rn.data):B.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),R.compressedTexSubImage3D(tt,H,O.x,O.y,O.z,Ee,Re,Ge,Ze,rn.data)):R.texSubImage3D(tt,H,O.x,O.y,O.z,Ee,Re,Ge,Ze,lt,rn),R.pixelStorei(R.UNPACK_ROW_LENGTH,rt),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,fn),R.pixelStorei(R.UNPACK_SKIP_PIXELS,Ui),R.pixelStorei(R.UNPACK_SKIP_ROWS,Fn),R.pixelStorei(R.UNPACK_SKIP_IMAGES,Ms),0===H&&V.generateMipmaps&&R.generateMipmap(tt),J.unbindTexture()},this.initTexture=function(C){C.isCubeTexture?Te.setTextureCube(C,0):C.isData3DTexture?Te.setTexture3D(C,0):C.isDataArrayTexture||C.isCompressedArrayTexture?Te.setTexture2DArray(C,0):Te.setTexture2D(C,0),J.unbindTexture()},this.resetState=function(){M=0,S=0,b=null,J.reset(),et.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ds}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===V0?"display-p3":"srgb",t.unpackColorSpace=bt.workingColorSpace===xp?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Gt?Vo:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Vo?Gt:Bn}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class FY extends pP{}).prototype.isWebGL1Renderer=!0;class mP extends Nn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Mx{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ni()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ni()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ni()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ci=new A;class Ko{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ci.fromBufferAttribute(this,t),ci.applyMatrix4(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ci.fromBufferAttribute(this,t),ci.applyNormalMatrix(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ci.fromBufferAttribute(this,t),ci.transformDirection(e),this.setXYZ(t,ci.x,ci.y,ci.z);return this}setX(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Mi(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Mi(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Mi(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Mi(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array),s=it(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new en(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ko(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const MP=new A,wP=new It,SP=new It,BY=new A,EP=new We,rm=new A,Sx=new mr,bP=new We,Ex=new hd;class TP extends Zn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=RR,this.bindMatrix=new We,this.bindMatrixInverse=new We,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new fr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,rm),this.boundingBox.expandByPoint(rm)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new mr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,rm),this.boundingSphere.expandByPoint(rm)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Sx.copy(this.boundingSphere),Sx.applyMatrix4(r),!1!==e.ray.intersectsSphere(Sx)&&(bP.copy(r).invert(),Ex.copy(e.ray).applyMatrix4(bP),(null===this.boundingBox||!1!==Ex.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Ex)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new It,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===RR?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;wP.fromBufferAttribute(r.attributes.skinIndex,e),SP.fromBufferAttribute(r.attributes.skinWeight,e),MP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=SP.getComponent(s);if(0!==o){const a=wP.getComponent(s);EP.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(BY.copy(MP).applyMatrix4(EP),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class bx extends Nn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class xd extends hr{constructor(e=null,t=1,i=1,r,s,o,a,c,l=dn,u=dn,d,h){super(null,o,a,c,l,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const CP=new We,VY=new We;class sm{constructor(e=[],t=[]){this.uuid=Ni(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new We)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new We;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)CP.multiplyMatrices(e[s]?e[s].matrixWorld:VY,t[s]),CP.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new sm(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=m1(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new xd(t,e,e,$i,us);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new bx),this.bones.push(o),this.boneInverses.push((new We).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class ml extends en{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const gl=new We,AP=new We,om=[],DP=new fr,HY=new We,Md=new Zn,wd=new mr;class IP extends Zn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ml(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,HY)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new fr),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,gl),DP.copy(e.boundingBox).applyMatrix4(gl),this.boundingBox.union(DP)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new mr),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,gl),wd.copy(e.boundingSphere).applyMatrix4(gl),this.boundingSphere.union(wd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Md.geometry=this.geometry,Md.material=this.material,void 0!==Md.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),wd.copy(this.boundingSphere),wd.applyMatrix4(i),!1!==e.ray.intersectsSphere(wd)))for(let s=0;s<r;s++){this.getMatrixAt(s,gl),AP.multiplyMatrices(i,gl),Md.matrixWorld=AP,Md.raycast(e,om);for(let o=0,a=om.length;o<a;o++){const c=om[o];c.instanceId=s,c.object=this,t.push(c)}om.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new ml(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Si extends yr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new me(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const RP=new A,PP=new A,NP=new We,Tx=new hd,am=new mr;class Jo extends Nn{constructor(e=new ut,t=new Si){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)RP.fromBufferAttribute(t,r-1),PP.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=RP.distanceTo(PP);e.setAttribute("lineDistance",new Ce(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),am.copy(i.boundingSphere),am.applyMatrix4(r),am.radius+=s,!1===e.ray.intersectsSphere(am))return;NP.copy(r).invert(),Tx.copy(e.ray).applyMatrix4(NP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=new A,u=new A,d=new A,h=new A,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),x=Math.min(p.count,o.start+o.count)-1;y<x;y+=f){const M=p.getX(y),S=p.getX(y+1);if(l.fromBufferAttribute(g,M),u.fromBufferAttribute(g,S),Tx.distanceSqToSegment(l,u,h,d)>c)continue;h.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(h);I<e.near||I>e.far||t.push({distance:I,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;y<x;y+=f){if(l.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),Tx.distanceSqToSegment(l,u,h,d)>c)continue;h.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(h);S<e.near||S>e.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const LP=new A,OP=new A;class Cx extends Jo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)LP.fromBufferAttribute(t,r),OP.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+LP.distanceTo(OP);e.setAttribute("lineDistance",new Ce(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class FP extends Jo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Ax extends yr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const UP=new We,Dx=new hd,cm=new mr,lm=new A;class kP extends Nn{constructor(e=new ut,t=new Ax){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),cm.copy(i.boundingSphere),cm.applyMatrix4(r),cm.radius+=s,!1===e.ray.intersectsSphere(cm))return;UP.copy(r).invert(),Dx.copy(e.ray).applyMatrix4(UP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=i.index,d=i.attributes.position;if(null!==l)for(let p=Math.max(0,o.start),v=Math.min(l.count,o.start+o.count);p<v;p++){const g=l.getX(p);lm.fromBufferAttribute(d,g),BP(lm,g,c,r,e,t,this)}else for(let p=Math.max(0,o.start),v=Math.min(d.count,o.start+o.count);p<v;p++)lm.fromBufferAttribute(d,p),BP(lm,p,c,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function BP(n,e,t,i,r,s,o){const a=Dx.distanceSqToPoint(n);if(a<t){const c=new A;Dx.closestPointToPoint(n,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class wm extends yr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new me(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _s extends wm{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new K(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Qt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new me(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new me(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new me(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function ta(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function tN(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function Zx(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r}function Kx(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class Dd{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NZ extends Dd{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:o=e,c=2*i-t;break;case 2402:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),v=p*p,g=v*p,m=-h*g+2*h*v-h*p,_=(1+h)*g+(-1.5-2*h)*v+(-.5+h)*p+1,y=(-1-f)*g+(1.5+f)*v+.5*p,x=f*g-f*v;for(let M=0;M!==a;++M)s[M]=m*o[u+M]+_*o[l+M]+y*o[c+M]+x*o[d+M];return s}}class nN extends Dd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[l+h]*d+o[c+h]*u;return s}}class LZ extends Dd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Hr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ta(t,this.TimeBufferType),this.values=ta(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ta(e.times,Array),values:ta(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new LZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new nN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new NZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case od:t=this.InterpolantFactoryMethodDiscrete;break;case Uc:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return od;case this.InterpolantFactoryMethodLinear:return Uc;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&function eN(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const v=t[d+p];if(v!==t[h+p]||v!==t[f+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Hr.prototype.TimeBufferType=Float32Array,Hr.prototype.ValueBufferType=Float32Array,Hr.prototype.DefaultInterpolation=Uc;class _l extends Hr{}_l.prototype.ValueTypeName="bool",_l.prototype.ValueBufferType=Array,_l.prototype.DefaultInterpolation=od,_l.prototype.InterpolantFactoryMethodLinear=void 0,_l.prototype.InterpolantFactoryMethodSmooth=void 0;class iN extends Hr{}iN.prototype.ValueTypeName="color";class xl extends Hr{}xl.prototype.ValueTypeName="number";class OZ extends Dd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)oi.slerpFlat(s,0,o,l-a,o,l,c);return s}}class na extends Hr{InterpolantFactoryMethodLinear(e){return new OZ(this.times,this.values,this.getValueSize(),e)}}na.prototype.ValueTypeName="quaternion",na.prototype.DefaultInterpolation=Uc,na.prototype.InterpolantFactoryMethodSmooth=void 0;class Ml extends Hr{}Ml.prototype.ValueTypeName="string",Ml.prototype.ValueBufferType=Array,Ml.prototype.DefaultInterpolation=od,Ml.prototype.InterpolantFactoryMethodLinear=void 0,Ml.prototype.InterpolantFactoryMethodSmooth=void 0;class wl extends Hr{}wl.prototype.ValueTypeName="vector";class Id{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Ni(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(UZ(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Hr.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],l=[];c.push((a+s-1)%s,a,(a+1)%s),l.push(0,1,0);const u=tN(c);c=Zx(c,1,u),l=Zx(l,1,u),!r&&0===c[0]&&(c.push(s),l.push(l[0])),o.push(new xl(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const l=e[a],u=l.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(l)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,p,v){if(0!==f.length){const g=[],m=[];Kx(f,g,m,p),0!==g.length&&v.push(new d(h,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let d=0;d<l.length;d++){const h=l[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let v=0;v<h[p].morphTargets.length;v++)f[h[p].morphTargets[v]]=-1;for(const v in f){const g=[],m=[];for(let _=0;_!==h[p].morphTargets.length;++_){const y=h[p];g.push(y.time),m.push(y.morphTarget===v?1:0)}r.push(new xl(".morphTargetInfluence["+v+"]",g,m))}c=f.length*o}else{const f=".bones["+t[d].name+"]";i(wl,f+".position",h,"pos",r),i(na,f+".quaternion",h,"rot",r),i(wl,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,c,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UZ(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function FZ(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xl;case"vector":case"vector2":case"vector3":case"vector4":return wl;case"color":return iN;case"quaternion":return na;case"bool":case"boolean":return _l;case"string":return Ml}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Kx(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Sl={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class rN{constructor(e,t,i){const r=this;let c,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,d){return l.push(u,d),this},this.removeHandler=function(u){const d=l.indexOf(u);return-1!==d&&l.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=l.length;d<h;d+=2){const f=l[d],p=l[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const kZ=new rN;let Rd=(()=>{class n{constructor(t){this.manager=void 0!==t?t:kZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const xs={};class BZ extends Error{constructor(e,t){super(e),this.response=t}}class zr extends Rd{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Sl.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==xs[e])return void xs[e].push({onLoad:t,onProgress:i,onError:r});xs[e]=[],xs[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=xs[e],d=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),f=h?parseInt(h):0,p=0!==f;let v=0;const g=new ReadableStream({start(m){!function _(){d.read().then(({done:y,value:x})=>{if(y)m.close();else{v+=x.byteLength;const M=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:f});for(let S=0,b=u.length;S<b;S++){const I=u[S];I.onProgress&&I.onProgress(M)}m.enqueue(x),_()}})}()}});return new Response(g)}throw new BZ(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(void 0===a)return l.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{Sl.add(e,l);const u=xs[e];delete xs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=xs[e];if(void 0===u)throw this.manager.itemError(e),l;delete xs[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Sm extends Rd{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Sl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=cd("img");function c(){u(),Sl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class VZ extends Rd{constructor(e){super(e)}load(e,t,i,r){const s=new hr,o=new Sm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class Em extends Nn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new me(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Jx=new We,sN=new A,oN=new A;class Qx{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new K(512,512),this.map=null,this.mapPass=null,this.matrix=new We,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ux,this._frameExtents=new K(1,1),this._viewportCount=1,this._viewports=[new It(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;sN.setFromMatrixPosition(e.matrixWorld),t.position.copy(sN),oN.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(oN),t.updateMatrixWorld(),Jx.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Jx),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Jx)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class zZ extends Qx{constructor(){super(new On(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*zc*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class aN extends Em{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new zZ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const cN=new We,Pd=new A,eM=new A;class GZ extends Qx{constructor(){super(new On(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new K(4,2),this._viewportCount=6,this._viewports=[new It(2,1,1,1),new It(0,1,1,1),new It(3,1,1,1),new It(1,1,1,1),new It(3,0,1,1),new It(1,0,1,1)],this._cubeDirections=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],this._cubeUps=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Pd.setFromMatrixPosition(e.matrixWorld),i.position.copy(Pd),eM.copy(i.position),eM.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(eM),i.updateMatrixWorld(),r.makeTranslation(-Pd.x,-Pd.y,-Pd.z),cN.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cN)}}class lN extends Em{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new GZ}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class WZ extends Qx{constructor(){super(new Zp(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class uN extends Em{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.shadow=new WZ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class dN extends Em{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Nd{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class KZ extends Rd{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Sl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){Sl.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const nM="\\[\\]\\.:\\/",nK=new RegExp("["+nM+"]","g"),iM="[^"+nM+"]",iK="[^"+nM.replace("\\.","")+"]",cK=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",iM)+/(WCOD+)?/.source.replace("WCOD",iK)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",iM)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",iM)+"$"),lK=["material","materials","bones","map"];class uK{constructor(e,t,i){const r=i||Bt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Bt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(nK,"")}static parseTrackName(t){const i=cK.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==lK.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=uK,n})();function RN(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}Bt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Bt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Bt.prototype.GetterByBindingType=[Bt.prototype._getValue_direct,Bt.prototype._getValue_array,Bt.prototype._getValue_arrayElement,Bt.prototype._getValue_toArray],Bt.prototype.SetterByBindingTypeAndVersioning=[[Bt.prototype._setValue_direct,Bt.prototype._setValue_direct_setNeedsUpdate,Bt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_array,Bt.prototype._setValue_array_setNeedsUpdate,Bt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_arrayElement,Bt.prototype._setValue_arrayElement_setNeedsUpdate,Bt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bt.prototype._setValue_fromArray,Bt.prototype._setValue_fromArray_setNeedsUpdate,Bt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"158"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="158");class gK extends Rd{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new MK(t)}),this.register(function(t){return new DK(t)}),this.register(function(t){return new IK(t)}),this.register(function(t){return new RK(t)}),this.register(function(t){return new SK(t)}),this.register(function(t){return new EK(t)}),this.register(function(t){return new bK(t)}),this.register(function(t){return new TK(t)}),this.register(function(t){return new xK(t)}),this.register(function(t){return new CK(t)}),this.register(function(t){return new wK(t)}),this.register(function(t){return new AK(t)}),this.register(function(t){return new yK(t)}),this.register(function(t){return new PK(t)}),this.register(function(t){return new NK(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Nd.extractUrlBase(e),this.manager.itemStart(e);const a=function(l){r?r(l):console.error(l),s.manager.itemError(e),s.manager.itemEnd(e)},c=new zr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{s.parse(l,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},c=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===PN){try{o[mt.KHR_BINARY_GLTF]=new LK(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[mt.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new qK(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](l);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case mt.KHR_MATERIALS_UNLIT:o[d]=new _K;break;case mt.KHR_DRACO_MESH_COMPRESSION:o[d]=new OK(s,this.dracoLoader);break;case mt.KHR_TEXTURE_TRANSFORM:o[d]=new FK;break;case mt.KHR_MESH_QUANTIZATION:o[d]=new UK;break;default:h.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function vK(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const mt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class yK{constructor(e){this.parser=e,this.name=mt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let l;const u=new me(16777215);void 0!==c.color&&u.setRGB(c.color[0],c.color[1],c.color[2],Bn);const d=void 0!==c.range?c.range:0;switch(c.type){case"directional":l=new uN(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new lN(u),l.distance=d;break;case"spot":l=new aN(u),l.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,ro(l,c),void 0!==c.intensity&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class _K{constructor(){this.name=mt.KHR_MATERIALS_UNLIT}getMaterialType(){return Xi}extendParams(e,t,i){const r=[];e.color=new me(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Bn),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Gt))}return Promise.all(r)}}class xK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class MK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new K(a,a)}return Promise.all(s)}}class wK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class SK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new me(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Bn)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Gt)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class EK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class bK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new me).setRGB(a[0],a[1],a[2],Bn),Promise.all(s)}}class TK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class CK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new me).setRGB(a[0],a[1],a[2],Bn),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Gt)),Promise.all(s)}}class AK{constructor(e){this.parser=e,this.name=mt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?_s:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class DK{constructor(e){this.parser=e,this.name=mt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class IK{constructor(e){this.parser=e,this.name=mt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class RK{constructor(e){this.parser=e,this.name=mt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class PK{constructor(e){this.name=mt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,d=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}return null}}class NK{constructor(e){this.name=mt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==Zi.TRIANGLES&&l.mode!==Zi.TRIANGLE_STRIP&&l.mode!==Zi.TRIANGLE_FAN&&void 0!==l.mode)return null;const o=i.extensions[this.name].attributes,a=[],c={};for(const l in o)a.push(this.parser.getDependency("accessor",o[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const u=l.pop(),d=u.isGroup?u.children:[u],h=l[0].count,f=[];for(const p of d){const v=new We,g=new A,m=new oi,_=new A(1,1,1),y=new IP(p.geometry,p.material,h);for(let x=0;x<h;x++)c.TRANSLATION&&g.fromBufferAttribute(c.TRANSLATION,x),c.ROTATION&&m.fromBufferAttribute(c.ROTATION,x),c.SCALE&&_.fromBufferAttribute(c.SCALE,x),y.setMatrixAt(x,v.compose(g,m,_));for(const x in c)if("_COLOR_0"===x){const M=c[x];y.instanceColor=new ml(M.array,M.itemSize,M.normalized)}else"TRANSLATION"!==x&&"ROTATION"!==x&&"SCALE"!==x&&p.geometry.setAttribute(x,c[x]);Nn.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const PN="glTF";class LK{constructor(e){this.name=mt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==PN)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);if(o+=4,1313821514===c){const l=new Uint8Array(e,12+o,a);this.content=i.decode(l)}else if(5130562===c){const l=12+o;this.body=e.slice(l,l+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class OK{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=mt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},l={};for(const u in o){const d=uM[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=uM[u]||u.toLowerCase();if(void 0!==o[u]){const h=i.accessors[e.attributes[u]];l[d]=El[h.componentType].name,c[d]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(h){for(const f in h.attributes){const v=c[f];void 0!==v&&(h.attributes[f].normalized=v)}d(h)},a,l)})})}}class FK{constructor(){this.name=mt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class UK{constructor(){this.name=mt.KHR_MESH_QUANTIZATION}}class LN extends Dd{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=2*a,l=3*a,u=r-t,d=(i-t)/u,h=d*d,f=h*d,p=e*l,v=p-l,g=-2*f+3*h,m=f-h,_=1-g,y=m-h+d;for(let x=0;x!==a;x++)s[x]=_*o[v+x+a]+y*(o[v+x+c]*u)+g*o[p+x+a]+m*(o[p+x]*u);return s}}const kK=new oi;class BK extends LN{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return kK.fromArray(s).normalize().toArray(s),s}}const Zi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},El={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ON={9728:dn,9729:Jt,9984:1004,9985:1007,9986:1005,9987:ls},FN={33071:qn,33648:1002,10497:Uo},lM={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},uM={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},io={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},VK={CUBICSPLINE:void 0,LINEAR:Uc,STEP:od};function ca(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function ro(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function GK(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function WK(n){let e;const t=n.extensions&&n.extensions[mt.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+hM(t.attributes):n.indices+":"+hM(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+hM(n.targets[i]);return e}function hM(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function fM(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const $K=new We;class qK{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new vK,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new VZ(this.options.manager):new KZ(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new zr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return ca(s,a,r),ro(a,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const c=this.associations.get(o);null!=c&&this.associations.set(a,c);for(const[l,u]of o.children.entries())s(u,a.children[l])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[mt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Nd.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=lM[r.type],c=!0===r.normalized,l=new(0,El[r.componentType])(r.count*o);return Promise.resolve(new en(l,o,c))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=lM[r.type],l=El[r.componentType],u=l.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let v,g;if(f&&f!==u*c){const m=Math.floor(h/f),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let y=t.cache.get(_);y||(v=new l(a,m*f,r.count*f/u),y=new Mx(v,f/u),t.cache.add(_,y)),g=new Ko(y,c,h%f/u,p)}else v=null===a?new l(r.count*c):new l(a,h,r.count*c),g=new en(v,c,p);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,M=new(0,El[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*lM.SCALAR),S=new l(o[2],x,r.sparse.count*c);null!==a&&(g=new en(g.array.slice(),g.itemSize,g.normalized));for(let b=0,I=M.length;b<I;b++){const w=M[b];if(g.setX(w,S[b*c]),c>=2&&g.setY(w,S[b*c+1]),c>=3&&g.setZ(w,S[b*c+2]),c>=4&&g.setW(w,S[b*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=this.options.manager.getHandler(o.uri);null!==c&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",""===u.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(u.name=a.uri);const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=ON[h.magFilter]||Jt,u.minFilter=ON[h.minFilter]||ls,u.wrapS=FN[h.wrapS]||Uo,u.wrapT=FN[h.wrapT]||Uo,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",l=!1;if(void 0!==o.bufferView)c=this.getDependency("bufferView",o.bufferView).then(function(d){l=!0;const h=new Blob([d],{type:o.mimeType});return c=a.createObjectURL(h),c});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(d){return new Promise(function(h,f){let p=h;!0===t.isImageBitmapLoader&&(p=function(v){const g=new hr(v);g.needsUpdate=!0,h(g)}),t.load(Nd.resolveURL(d,s.path),p,void 0,f)})}).then(function(d){return!0===l&&a.revokeObjectURL(c),d.userData.mimeType=o.mimeType||function jK(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[mt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[mt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[mt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Ax,yr.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Si,yr.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return wm}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=[];if((s.extensions||{})[mt.KHR_MATERIALS_UNLIT]){const d=r[mt.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),l.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new me(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],Bn),a.opacity=h[3]}void 0!==d.baseColorTexture&&l.push(t.assignTexture(a,"map",d.baseColorTexture,Gt)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(l.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Xi&&(l.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new K(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}if(void 0!==s.occlusionTexture&&o!==Xi&&(l.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Xi){const d=s.emissiveFactor;a.emissive=(new me).setRGB(d[0],d[1],d[2],Bn)}return void 0!==s.emissiveTexture&&o!==Xi&&l.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Gt)),Promise.all(l).then(function(){const d=new o(a);return s.name&&(d.name=s.name),ro(d,s),t.associations.set(d,{materials:e}),s.extensions&&ca(r,d,s),d})}createUniqueName(e){const t=Bt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[mt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return UN(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const l=e[a],u=WK(l),d=r[u];if(d)o.push(d.promise);else{let h;h=l.extensions&&l.extensions[mt.KHR_DRACO_MESH_COMPRESSION]?s(l):UN(new ut,l,t),r[u]={primitive:l,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let c=0,l=o.length;c<l;c++){const u=void 0===o[c].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new wm({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[c].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],d=[];for(let f=0,p=u.length;f<p;f++){const v=u[f],g=o[f];let m;const _=l[f];if(g.mode===Zi.TRIANGLES||g.mode===Zi.TRIANGLE_STRIP||g.mode===Zi.TRIANGLE_FAN||void 0===g.mode)m=!0===s.isSkinnedMesh?new TP(v,_):new Zn(v,_),!0===m.isSkinnedMesh&&m.normalizeSkinWeights(),g.mode===Zi.TRIANGLE_STRIP?m.geometry=RN(m.geometry,1):g.mode===Zi.TRIANGLE_FAN&&(m.geometry=RN(m.geometry,2));else if(g.mode===Zi.LINES)m=new Cx(v,_);else if(g.mode===Zi.LINE_STRIP)m=new Jo(v,_);else if(g.mode===Zi.LINE_LOOP)m=new FP(v,_);else{if(g.mode!==Zi.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);m=new kP(v,_)}Object.keys(m.geometry.morphAttributes).length>0&&GK(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),ro(m,s),g.extensions&&ca(r,m,g),t.assignFinalMaterial(m),d.push(m)}for(let f=0,p=d.length;f<p;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(1===d.length)return s.extensions&&ca(r,d[0],s),d[0];const h=new to;s.extensions&&ca(r,h,s),t.associations.set(h,{meshes:e});for(let f=0,p=d.length;f<p;f++)h.add(d[f]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new On(hq_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Zp(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),ro(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],c=[];for(let l=0,u=o.length;l<u;l++){const d=o[l];if(d){a.push(d);const h=new We;null!==s&&h.fromArray(s.array,16*l),c.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new sm(a,c)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],c=[],l=[],u=[];for(let d=0,h=r.channels.length;d<h;d++){const f=r.channels[d],p=r.samplers[f.sampler],v=f.target,m=void 0!==r.parameters?r.parameters[p.input]:p.input,_=void 0!==r.parameters?r.parameters[p.output]:p.output;void 0!==v.node&&(o.push(this.getDependency("node",v.node)),a.push(this.getDependency("accessor",m)),c.push(this.getDependency("accessor",_)),l.push(p),u.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(d){const h=d[0],f=d[1],p=d[2],v=d[3],g=d[4],m=[];for(let _=0,y=h.length;_<y;_++){const x=h[_],M=f[_],S=p[_],b=v[_],I=g[_];if(void 0===x)continue;x.updateMatrix&&x.updateMatrix();const w=i._createAnimationTracks(x,M,S,b,I);if(w)for(let T=0;T<w.length;T++)m.push(w[T])}return new Id(s,void 0,m)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)o.push(i.getDependency("node",a[l]));const c=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),c]).then(function(l){const u=l[0],d=l[1],h=l[2];null!==h&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(h,$K)});for(let f=0,p=d.length;f<p;f++)u.add(d[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(l){return r._getNodeRef(r.cameraCache,s.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(u=!0===s.isBone?new bx:l.length>1?new to:1===l.length?l[0]:new Nn,u!==l[0])for(let d=0,h=l.length;d<h;d++)u.add(l[d]);if(s.name&&(u.userData.name=s.name,u.name=o),ro(u,s),s.extensions&&ca(i,u,s),void 0!==s.matrix){const d=new We;d.fromArray(s.matrix),u.applyMatrix4(d)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new to;i.name&&(s.name=r.createUniqueName(i.name)),ro(s,i),i.extensions&&ca(t,s,i);const o=i.nodes||[],a=[];for(let c=0,l=o.length;c<l;c++)a.push(r.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let u=0,d=c.length;u<d;u++)s.add(c[u]);return r.associations=(u=>{const d=new Map;for(const[h,f]of r.associations)(h instanceof yr||h instanceof hr)&&d.set(h,f);return u.traverse(h=>{const f=r.associations.get(h);null!=f&&d.set(h,f)}),d})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,c=[];let l;switch(io[s.path]===io.weights?e.traverse(function(h){h.morphTargetInfluences&&c.push(h.name?h.name:h.uuid)}):c.push(a),io[s.path]){case io.weights:l=xl;break;case io.rotation:l=na;break;case io.position:case io.scale:l=wl;break;default:l=1===i.itemSize?xl:wl}const u=void 0!==r.interpolation?VK[r.interpolation]:Uc,d=this._getArrayFromAccessor(i);for(let h=0,f=c.length;h<f;h++){const p=new l(c[h]+"."+io[s.path],t.array,d,u);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=fM(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof na?BK:LN)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function UN(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){n.setAttribute(a,c)})}for(const o in i){const a=uM[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return bt.workingColorSpace!==Bn&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${bt.workingColorSpace}" not supported.`),ro(n,e),function XK(n,e,t){const i=e.attributes,r=new fr;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],c=a.min,l=a.max;if(void 0===c||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new A(c[0],c[1],c[2]),new A(l[0],l[1],l[2])),a.normalized){const u=fM(El[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new A,c=new A;for(let l=0,u=s.length;l<u;l++){const d=s[l];if(void 0!==d.POSITION){const h=t.json.accessors[d.POSITION],f=h.min,p=h.max;if(void 0!==f&&void 0!==p){if(c.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),h.normalized){const v=fM(El[h.componentType]);c.multiplyScalar(v)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new mr;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function zK(n,e,t){let i=!1,r=!1,s=!1;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){const d=e[l];if(i){const h=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(h)}if(r){const h=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(h)}if(s){const h=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;c.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){const d=l[1],h=l[2];return i&&(n.morphAttributes.position=l[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const YK=["canvas"];let ZK=(()=>{class n{constructor(){this.resourceName="",this.resourceUrl="",this.rotationSpeedX=0,this.rotationSpeedY=0,this.size=2,this.cameraZ=125,this.fieldOfView=1,this.nearClippingPane=20,this.farClippingPane=1e3,this.loader=new gK,this.scene=new mP}get canvas(){return this.canvasRef.nativeElement}loadScene(){this.resourceUrl="assets/models/"+this.resourceName+"/"+this.resourceName+".gltf",this.loadGLTF()}createScene(){this.scene.scale.set(this.size,this.size,this.size);const t=(new fr).setFromObject(this.object),i=new A;t.getCenter(i),this.center=i,this.scene.position.sub(this.center),this.createCamera(),this.createLight()}createLight(){this.light=new dN(16777215,2.5,8,8),this.light.position.copy(this.center),this.light.position.z+=4.5,this.light.position.y-=1.5,this.light.lookAt(this.center),this.light=this.light,this.scene.add(this.light)}createCamera(){this.camera=new On(this.fieldOfView,this.aspectRatio,this.nearClippingPane,this.farClippingPane),this.camera.position.copy(this.center),this.camera.position.z+=this.cameraZ,this.camera.lookAt(this.center)}loadGLTF(){this.loader.load(this.resourceUrl,t=>{this.scene.add(t.scene),this.createMeshFromGLTF(t),this.createScene()},t=>{console.log(t.loaded/t.total*100+"% loaded")},t=>{console.log("An error happened"),console.log(t)})}createMeshFromGLTF(t){this.object=t.scene.children[0],this.renderer.outputColorSpace=Gt}get aspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}animate(){this.object.rotation.x+=this.rotationSpeedX,this.object.rotation.y+=this.rotationSpeedY}mouseover(){this.rotationSpeedY-=.02,this.camera.position.z-=this.cameraZ/5}mouseout(){this.rotationSpeedY+=.02,this.camera.position.z+=this.cameraZ/5}startRenderingLoop(){this.renderer=new pP({canvas:this.canvas,alpha:!0,antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.renderer.outputColorSpace=Gt,this.renderer.setClearColor(0,0);const t=this;!function i(){requestAnimationFrame(i),t.animate(),t.renderer.render(t.scene,t.camera)}()}ngOnInit(){}ngAfterViewInit(){this.loadScene(),this.startRenderingLoop()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-display3d"]],viewQuery:function(i,r){if(1&i&&EA(YK,5),2&i){let s;Zy(s=function Ky(){return function eG(n,e){return n[wr].queries[e].queryList}(z(),tS())}())&&(r.canvasRef=s.first)}},inputs:{resourceName:["resource","resourceName"],cameraZ:["zoom","cameraZ"]},decls:11,vars:0,consts:[[1,"clock"],["id","canvas",1,"center-square",3,"mouseenter","mouseleave"],["canvas",""],[1,"hand","hour-hand"],[1,"hand","minute-hand"],[1,"hand","second-hand"],[1,"hand","additional-hand-1"],[1,"hand","additional-hand-2"],[1,"hand","additional-hand-3"],[1,"hand","additional-hand-4"],[1,"hand","additional-hand-5"]],template:function(i,r){1&i&&(Pt(0,"div",0)(1,"canvas",1,2),Qr("mouseenter",function(){return r.mouseover()})("mouseleave",function(){return r.mouseout()}),Ct(),ln(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10),Ct())},styles:['#canvas[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#0000;position:relative}.center-square[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;outline:1px solid #ffffff;border-radius:50%;filter:drop-shadow(0px 0px 12px #ffffff)}body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;margin:0}.clock[_ngcontent-%COMP%]{position:relative;width:300px;height:300px;border:2px solid #333;border-radius:50%}.clock[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{animation-play-state:paused}.clock[_ngcontent-%COMP%]:hover   *[_ngcontent-%COMP%]{animation-play-state:running}.clock[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;display:block;border-radius:50%;box-shadow:0 0 40px #010b13cc,inset 0 0 75px #010b13cc;z-index:0;filter:invert(84%) sepia(2%) saturate(1676%) hue-rotate(320deg) brightness(116%) contrast(107%)}.clock[_ngcontent-%COMP%]:hover:before{animation:_ngcontent-%COMP%_glow 3s ease-in-out infinite alternate}.hand[_ngcontent-%COMP%]{position:absolute;width:50%;top:50%;left:25%;height:1px;background-color:#333;transform-origin:100%;animation-timing-function:steps;animation-iteration-count:infinite}.hand[_ngcontent-%COMP%]:before{content:"";position:absolute;width:100%;height:20px;background:linear-gradient(to top,transparent 20%,#aaa 80%);transform-origin:0%;opacity:.2}@keyframes _ngcontent-%COMP%_rotate-hour{0%{transform:translate(-50%) translateY(-50%) rotate(30deg)}to{transform:translate(-50%) translateY(-50%) rotate(390deg)}}@keyframes _ngcontent-%COMP%_rotate-minute{0%{transform:translate(-50%) translateY(-50%) rotate(120deg)}to{transform:translate(-50%) translateY(-50%) rotate(480deg)}}@keyframes _ngcontent-%COMP%_rotate-second{0%{transform:translate(-50%) translateY(-50%) rotate(240deg)}to{transform:translate(-50%) translateY(-50%) rotate(600deg)}}@keyframes _ngcontent-%COMP%_rotate-additional-1{0%{transform:translate(-50%) translateY(-50%) rotate(60deg)}to{transform:translate(-50%) translateY(-50%) rotate(420deg)}}@keyframes _ngcontent-%COMP%_rotate-additional-2{0%{transform:translate(-50%) translateY(-50%) rotate(180deg)}to{transform:translate(-50%) translateY(-50%) rotate(540deg)}}@keyframes _ngcontent-%COMP%_rotate-additional-3{0%{transform:translate(-50%) translateY(-50%) rotate(300deg)}to{transform:translate(-50%) translateY(-50%) rotate(660deg)}}@keyframes _ngcontent-%COMP%_rotate-additional-4{0%{transform:translate(-50%) translateY(-50%) rotate(90deg)}to{transform:translate(-50%) translateY(-50%) rotate(450deg)}}@keyframes _ngcontent-%COMP%_rotate-additional-5{0%{transform:translate(-50%) translateY(-50%) rotate(210deg)}to{transform:translate(-50%) translateY(-50%) rotate(570deg)}}@keyframes _ngcontent-%COMP%_trail{0%{transform:scaleY(0)}to{transform:scaleY(1)}}@keyframes _ngcontent-%COMP%_glow{0%{box-shadow:0 0 40px #010b13cc,inset 0 0 75px #010b13cc}to{box-shadow:0 0 40px #010b13cc,inset 0 0 15px #010b13cc}}.hour-hand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-hour 30s linear infinite;background-color:#333}.minute-hand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-minute 20s linear infinite;background-color:#666}.second-hand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-second 10s linear infinite;background-color:#999}.additional-hand-1[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-additional-1 25s linear infinite;background-color:#777}.additional-hand-2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-additional-2 18s linear infinite;background-color:#555}.additional-hand-3[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-additional-3 15s linear infinite;background-color:#888}.additional-hand-4[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-additional-4 12s linear infinite;background-color:#444}.additional-hand-5[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate-additional-5 22s linear infinite;background-color:#bbb}']})}return n})();const kN={now:()=>(kN.delegate||Date).now(),delegate:void 0};class JK extends Bi{constructor(e=1/0,t=1/0,i=kN){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let c=1;c<i.length&&i[c]<=o;c+=2)a=c;a&&i.splice(0,a+1)}}}function BN(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,fw({connector:()=>new JK(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}class Od{}let VN=(()=>{class n extends Od{getTranslation(t){return De({})}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ia(n)))(r||n)}})();static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();class pM{}let HN=(()=>{class n{handle(t){return t.key}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function Pm(n,e){if(n===e)return!0;if(null===n||null===e)return!1;if(n!=n&&e!=e)return!0;let r,s,o,t=typeof n;if(t==typeof e&&"object"==t){if(!Array.isArray(n)){if(Array.isArray(e))return!1;for(s in o=Object.create(null),n){if(!Pm(n[s],e[s]))return!1;o[s]=!0}for(s in e)if(!(s in o)&&typeof e[s]<"u")return!1;return!0}if(!Array.isArray(e))return!1;if((r=n.length)==e.length){for(s=0;s<r;s++)if(!Pm(n[s],e[s]))return!1;return!0}}return!1}function so(n){return typeof n<"u"&&null!==n}function mM(n){return n&&"object"==typeof n&&!Array.isArray(n)}function zN(n,e){let t=Object.assign({},n);return mM(n)&&mM(e)&&Object.keys(e).forEach(i=>{mM(e[i])?i in n?t[i]=zN(n[i],e[i]):Object.assign(t,{[i]:e[i]}):Object.assign(t,{[i]:e[i]})}),t}class Nm{}let GN=(()=>{class n extends Nm{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(t,i){let r;return r="string"==typeof t?this.interpolateString(t,i):"function"==typeof t?this.interpolateFunction(t,i):t,r}getValue(t,i){let r="string"==typeof i?i.split("."):[i];i="";do{i+=r.shift(),!so(t)||!so(t[i])||"object"!=typeof t[i]&&r.length?r.length?i+=".":t=void 0:(t=t[i],i="")}while(r.length);return t}interpolateFunction(t,i){return t(i)}interpolateString(t,i){return i?t.replace(this.templateMatcher,(r,s)=>{let o=this.getValue(i,s);return so(o)?o:r}):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ia(n)))(r||n)}})();static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();class Lm{}let WN=(()=>{class n extends Lm{compile(t,i){return t}compileTranslations(t,i){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ia(n)))(r||n)}})();static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();class jN{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new an;onLangChange=new an;onDefaultLangChange=new an}const gM=new ve("USE_STORE"),vM=new ve("USE_DEFAULT_LANG"),yM=new ve("DEFAULT_LANGUAGE"),_M=new ve("USE_EXTEND");let Fd=(()=>{class n{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;isolate;extend;loadingTranslations;pending=!1;_onTranslationChange=new an;_onLangChange=new an;_onDefaultLangChange=new an;_defaultLang;_currentLang;_langs=[];_translations={};_translationRequests={};get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(t){this.isolate?this._defaultLang=t:this.store.defaultLang=t}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(t){this.isolate?this._currentLang=t:this.store.currentLang=t}get langs(){return this.isolate?this._langs:this.store.langs}set langs(t){this.isolate?this._langs=t:this.store.langs=t}get translations(){return this.isolate?this._translations:this.store.translations}set translations(t){this.isolate?this._translations=t:this.store.translations=t}constructor(t,i,r,s,o,a=!0,c=!1,l=!1,u){this.store=t,this.currentLoader=i,this.compiler=r,this.parser=s,this.missingTranslationHandler=o,this.useDefaultLang=a,this.isolate=c,this.extend=l,u&&this.setDefaultLang(u)}setDefaultLang(t){if(t===this.defaultLang)return;let i=this.retrieveTranslations(t);typeof i<"u"?(null==this.defaultLang&&(this.defaultLang=t),i.pipe(Nr(1)).subscribe(r=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(t===this.currentLang)return De(this.translations[t]);let i=this.retrieveTranslations(t);return typeof i<"u"?(this.currentLang||(this.currentLang=t),i.pipe(Nr(1)).subscribe(r=>{this.changeLang(t)}),i):(this.changeLang(t),De(this.translations[t]))}retrieveTranslations(t){let i;return(typeof this.translations[t]>"u"||this.extend)&&(this._translationRequests[t]=this._translationRequests[t]||this.getTranslation(t),i=this._translationRequests[t]),i}getTranslation(t){this.pending=!0;const i=this.currentLoader.getTranslation(t).pipe(BN(1),Nr(1));return this.loadingTranslations=i.pipe(vt(r=>this.compiler.compileTranslations(r,t)),BN(1),Nr(1)),this.loadingTranslations.subscribe({next:r=>{this.translations[t]=this.extend&&this.translations[t]?{...r,...this.translations[t]}:r,this.updateLangs(),this.pending=!1},error:r=>{this.pending=!1}}),i}setTranslation(t,i,r=!1){i=this.compiler.compileTranslations(i,t),this.translations[t]=(r||this.extend)&&this.translations[t]?zN(this.translations[t],i):i,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){t.forEach(i=>{-1===this.langs.indexOf(i)&&this.langs.push(i)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(t,i,r){let s;if(i instanceof Array){let o={},a=!1;for(let c of i)o[c]=this.getParsedResult(t,c,r),zs(o[c])&&(a=!0);return a?function KK(...n){const e=lw(n),{args:t,keys:i}=yI(n),r=new Yt(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let d=!1;Vi(t[u]).subscribe(pn(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(i?xI(i,a):a),s.complete())}))}});return e?r.pipe(_I(e)):r}(i.map(l=>zs(o[l])?o[l]:De(o[l]))).pipe(vt(l=>{let u={};return l.forEach((d,h)=>{u[i[h]]=d}),u})):o}if(t&&(s=this.parser.interpolate(this.parser.getValue(t,i),r)),typeof s>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(s=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],i),r)),typeof s>"u"){let o={key:i,translateService:this};typeof r<"u"&&(o.interpolateParams=r),s=this.missingTranslationHandler.handle(o)}return typeof s<"u"?s:i}get(t,i){if(!so(t)||!t.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(Po(r=>zs(r=this.getParsedResult(r,t,i))?r:De(r)));{let r=this.getParsedResult(this.translations[this.currentLang],t,i);return zs(r)?r:De(r)}}getStreamOnTranslationChange(t,i){if(!so(t)||!t.length)throw new Error('Parameter "key" required');return Hu(Jf(()=>this.get(t,i)),this.onTranslationChange.pipe(di(r=>{const s=this.getParsedResult(r.translations,t,i);return"function"==typeof s.subscribe?s:De(s)})))}stream(t,i){if(!so(t)||!t.length)throw new Error('Parameter "key" required');return Hu(Jf(()=>this.get(t,i)),this.onLangChange.pipe(di(r=>{const s=this.getParsedResult(r.translations,t,i);return zs(s)?s:De(s)})))}instant(t,i){if(!so(t)||!t.length)throw new Error('Parameter "key" required');let r=this.getParsedResult(this.translations[this.currentLang],t,i);if(zs(r)){if(t instanceof Array){let s={};return t.forEach((o,a)=>{s[t[a]]=t[a]}),s}return t}return r}set(t,i,r=this.currentLang){this.translations[r][t]=this.compiler.compile(i,r),this.updateLangs(),this.onTranslationChange.emit({lang:r,translations:this.translations[r]})}changeLang(t){this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),null==this.defaultLang&&this.changeDefaultLang(t)}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.getTranslation(t)}resetLang(t){this._translationRequests[t]=void 0,this.translations[t]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof t>"u"?void 0:(-1!==t.indexOf("-")&&(t=t.split("-")[0]),-1!==t.indexOf("_")&&(t=t.split("_")[0]),t)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,t}static \u0275fac=function(i){return new(i||n)(Me(jN),Me(Od),Me(Lm),Me(Nm),Me(pM),Me(vM),Me(gM),Me(_M),Me(yM))};static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),$N=(()=>{class n{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(t,i){this.translate=t,this._ref=i}updateValue(t,i,r){let s=o=>{this.value=void 0!==o?o:t,this.lastKey=t,this._ref.markForCheck()};if(r){let o=this.translate.getParsedResult(r,t,i);zs(o.subscribe)?o.subscribe(s):s(o)}this.translate.get(t,i).subscribe(s)}transform(t,...i){if(!t||!t.length)return t;if(Pm(t,this.lastKey)&&Pm(i,this.lastParams))return this.value;let r;if(so(i[0])&&i.length)if("string"==typeof i[0]&&i[0].length){let s=i[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{r=JSON.parse(s)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${i[0]}`)}}else"object"==typeof i[0]&&!Array.isArray(i[0])&&(r=i[0]);return this.lastKey=t,this.lastParams=i,this.updateValue(t,r),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(s=>{this.lastKey&&s.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,r,s.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(s=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,r,s.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,r))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}static \u0275fac=function(i){return new(i||n)(Oe(Fd,16),Oe(du,16))};static \u0275pipe=Jn({name:"translate",type:n,pure:!1});static \u0275prov=Se({token:n,factory:n.\u0275fac})}return n})(),QK=(()=>{class n{static forRoot(t={}){return{ngModule:n,providers:[t.loader||{provide:Od,useClass:VN},t.compiler||{provide:Lm,useClass:WN},t.parser||{provide:Nm,useClass:GN},t.missingTranslationHandler||{provide:pM,useClass:HN},jN,{provide:gM,useValue:t.isolate},{provide:vM,useValue:t.useDefaultLang},{provide:_M,useValue:t.extend},{provide:yM,useValue:t.defaultLanguage},Fd]}}static forChild(t={}){return{ngModule:n,providers:[t.loader||{provide:Od,useClass:VN},t.compiler||{provide:Lm,useClass:WN},t.parser||{provide:Nm,useClass:GN},t.missingTranslationHandler||{provide:pM,useClass:HN},{provide:gM,useValue:t.isolate},{provide:vM,useValue:t.useDefaultLang},{provide:_M,useValue:t.extend},{provide:yM,useValue:t.defaultLanguage},Fd]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qr({type:n});static \u0275inj=xr({})}return n})();const eJ=[{path:"",component:(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-main-page"]],decls:59,vars:35,consts:[[1,"grid","grid-rows-3","justify-center","align-center","main"],[1,"element","grid","grid-cols-3"],["resource","giacca"],[1,"col-span-2","text"],[1,"title"],["resource","cappellino",3,"zoom"],["resource","giacca",3,"zoom"],[1,"element","grid","grid-cols-4"],[1,"col-span-2","grid","grid-cols-3"],[1,"logo","p-2"],["src","assets/brand-logos/sunnei.png"],[1,"logo","p-8"],["src","assets/brand-logos/lv.png"],[1,"logo","p-5"],["src","assets/brand-logos/gucci.png"],[1,"element","grid"],[1,"text",2,"text-align","center","font-size","22px"],[1,"flex-auto","flex","justify-center"],[1,"contact-button"]],template:function(i,r){1&i&&(Pt(0,"div",0)(1,"div",1),ln(2,"app-display3d",2),Pt(3,"div",3)(4,"div",4),Pn(5),vi(6,"translate"),Ct(),Pn(7),vi(8,"translate"),Ct()(),Pt(9,"div",1)(10,"div",3)(11,"div",4),Pn(12),vi(13,"translate"),Ct(),Pn(14),vi(15,"translate"),Ct(),ln(16,"app-display3d",5),Ct(),Pt(17,"div",1),ln(18,"app-display3d",6),Pt(19,"div",3)(20,"div",4),Pn(21),vi(22,"translate"),Ct(),Pn(23),vi(24,"translate"),Ct()(),ln(25,"br")(26,"br")(27,"br"),Pt(28,"div",7)(29,"div",3)(30,"div",4),Pn(31),vi(32,"translate"),Ct(),Pn(33),vi(34,"translate"),Ct(),Pt(35,"div",8)(36,"div",9),ln(37,"img",10),Ct(),Pt(38,"div",11),ln(39,"img",12),Ct(),Pt(40,"div",13),ln(41,"img",14),Ct()()(),ln(42,"br")(43,"br"),Pt(44,"div",15)(45,"div",16),Pn(46),vi(47,"translate"),ln(48,"br")(49,"br"),Pn(50),vi(51,"translate"),ln(52,"br")(53,"br")(54,"br"),Pt(55,"div",17)(56,"a",18),Pn(57),vi(58,"translate"),Ct()()()()()),2&i&&(jn(5),Co(yi(6,13,"title")),jn(2),ar(" ",yi(8,15,"welcomeMessage")," "),jn(5),Co(yi(13,17,"dedicationAndApproachability.heading")),jn(2),ar(" ",yi(15,19,"dedicationAndApproachability.content")," "),jn(2),af("zoom",40),jn(2),af("zoom",50),jn(3),Co(yi(22,21,"detailAndPerfection.heading")),jn(2),ar(" ",yi(24,23,"detailAndPerfection.content")," "),jn(8),Co(yi(32,25,"professionalism.heading")),jn(2),ar(" ",yi(34,27,"professionalism.content")," "),jn(13),ar(" ",yi(47,29,"joinJourney")," "),jn(4),ar("",yi(51,31,"learnMoreButton")," "),jn(7),ar(" ",yi(58,33,"contactButton")," "))},dependencies:[ZK,$N],styles:['.main[_ngcontent-%COMP%]{margin:5vh 10vw 10vh 10vw}.element[_ngcontent-%COMP%]{padding:10px 30px 20px;justify-items:center;align-items:center}.text[_ngcontent-%COMP%]{font: 20px "DM Serif Display",sans-serif;color:#f1f0ef;padding:0 50px;text-align:justify;text-justify:distribute;white-space:pre-line}.title[_ngcontent-%COMP%]{font:900 40px "DM Serif Display",sans-serif;color:#fffdfa}.logo[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;box-shadow:0 0 40px #010b13;margin:0;transition:.3s ease-in-out all;cursor:pointer;filter:invert(84%) sepia(2%) saturate(1676%) hue-rotate(320deg) brightness(116%) contrast(107%);align-items:center;display:flex}.contact-button[_ngcontent-%COMP%]{border:2px solid #FFFDFA;padding:5px 20px 6px;font-size:22px;color:#fffdfa;display:inline-block;position:relative;transition:.3s ease-in-out all;cursor:pointer}.contact-button[_ngcontent-%COMP%]:before{content:"";background:#FFFDFA;position:absolute;width:0%;top:0;left:0;height:100%;transition:.3s ease-out all;z-index:-1}.contact-button[_ngcontent-%COMP%]:hover:before{width:100%}.contact-button[_ngcontent-%COMP%]:hover{color:#010b13;font-weight:900}']})}return n})()}];let tJ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({imports:[MR.forRoot(eJ),MR]})}return n})(),nJ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header","flex"],["data-text","irina luta",1,"text"]],template:function(i,r){1&i&&(Pt(0,"div",0)(1,"h1",1),Pn(2," irina luta "),Ct()())},styles:[".header[_ngcontent-%COMP%]{z-index:1001;background-color:#010b13;display:flex;justify-content:center;padding:20px;border-bottom:1px solid #FFFDFA;position:sticky;top:0;left:0;box-shadow:0 0 40px #010b13;filter:invert(84%) sepia(2%) saturate(1676%) hue-rotate(320deg) brightness(116%) contrast(107%);background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='100%25' width='100%25'%3E%3Cdefs%3E%3Cpattern id='doodad' width='40' height='40' viewBox='0 0 40 40' patternUnits='userSpaceOnUse' patternTransform='rotate(135)'%3E%3Crect width='100%25' height='100%25' fill='rgba(10, 16, 20,1)'/%3E%3Cpath d='M10 0L20 10L30 0L30 10L40 10L30 20L40 30L30 30L30 40L20 30L10 40L10 30L0 30L10 20L0 10L10 10z' fill='rgba(16, 22, 34,1)'/%3E%3Cpath d='M9 10L20 10.5L10 20zM30 9L29.5 20L20 10zM31 30L20 29.5L30 20zM10 31L20 30L10.5 20z' fill='rgba(10, 10, 20,1)'/%3E%3C/pattern%3E%3C/defs%3E%3Crect fill='url(%23doodad)' height='200%25' width='200%25'/%3E%3C/svg%3E \")}.text[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#010b13;margin:0;padding:0;-webkit-text-fill-color:#FFFDFA;-webkit-text-stroke:.1px #FFFDFA;font:900 70px \"DM Serif Display\",sans-serif;display:inline-block;line-height:.75em;height:.75em}.text[_ngcontent-%COMP%]:before{content:attr(data-text);position:absolute;z-index:1;color:#010b13;pointer-events:none;width:0;overflow:hidden;transition:1s ease-out all;white-space:nowrap;-webkit-text-fill-color:#010B13}.text[_ngcontent-%COMP%]:hover:before{width:100%}"]})}return n})(),iJ=(()=>{class n{constructor(t){this.translate=t}changeLanguage(t){this.translate.use(t)}static#e=this.\u0275fac=function(i){return new(i||n)(Oe(Fd))};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-language-flags"]],decls:11,vars:0,consts:[[1,"flags","flex","space-x-2"],[1,"lang-icon","lang-icon-en",3,"click"],[1,"lang-icon","lang-icon-en","lang-icon-shadow"],[1,"lang-icon","lang-icon-es",3,"click"],[1,"lang-icon","lang-icon-es","lang-icon-shadow"],[1,"lang-icon","lang-icon-ro",3,"click"],[1,"lang-icon","lang-icon-ro","lang-icon-shadow"],[1,"lang-icon","lang-icon-it",3,"click"],[1,"lang-icon","lang-icon-it","lang-icon-shadow"],[1,"lang-icon","lang-icon-gl",3,"click"],[1,"lang-icon","lang-icon-gl","lang-icon-shadow"]],template:function(i,r){1&i&&(Pt(0,"div",0)(1,"div",1),Qr("click",function(){return r.changeLanguage("en")}),ln(2,"div",2),Ct(),Pt(3,"div",3),Qr("click",function(){return r.changeLanguage("es")}),ln(4,"div",4),Ct(),Pt(5,"div",5),Qr("click",function(){return r.changeLanguage("ro")}),ln(6,"div",6),Ct(),Pt(7,"div",7),Qr("click",function(){return r.changeLanguage("it")}),ln(8,"div",8),Ct(),Pt(9,"div",9),Qr("click",function(){return r.changeLanguage("gl")}),ln(10,"div",10),Ct()())},styles:[".flags[_ngcontent-%COMP%]{display:flex}.flag[_ngcontent-%COMP%]{width:30px;height:20px;cursor:pointer;margin:0 5px}.lang-icon[_ngcontent-%COMP%]{border-radius:2px;cursor:pointer;position:relative;border-right:1px solid rgba(0,0,0,.6666666667);border-bottom:1px solid rgba(0,0,0,.6666666667)}.lang-icon[_ngcontent-%COMP%]:hover{top:1px}.lang-icon[_ngcontent-%COMP%]:hover   .lang-icon-shadow[_ngcontent-%COMP%]{top:2px;left:1px}.lang-icon[_ngcontent-%COMP%]   .lang-icon-shadow[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:3px;left:1px;border-radius:2px;opacity:.5;background-color:#000;z-index:-1}"]})}return n})(),rJ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-footer"]],decls:18,vars:6,consts:[[1,"flex","footer","flex-nowrap"],[1,"flex-none","leading-2"],[2,"font-size","12px"],["href","https://www.linkedin.com/in/miguel-bautista-perez/","target","_blank"],[1,"flex-auto","pl-20","flex","justify-center"],[1,"flex-auto","flex","justify-end","mr-10"],[1,"contact-button"]],template:function(i,r){1&i&&(Pt(0,"div",0)(1,"div",1)(2,"p"),Pn(3,"\xa9 2023 Irina Luta. All rights reserved."),Ct(),Pt(4,"p",2),Pn(5,"Website by "),Pt(6,"a",3),Pn(7,"Miguel Bautista"),Ct()()(),Pt(8,"div",4)(9,"p"),Pn(10),vi(11,"translate"),Ct()(),Pt(12,"div",5)(13,"a",6),Pn(14),vi(15,"translate"),Ct()(),Pt(16,"div"),ln(17,"app-language-flags"),Ct()()),2&i&&(jn(10),Co(yi(11,2,"footer")),jn(4),ar(" ",yi(15,4,"footer-button")," "))},dependencies:[iJ,$N],styles:[".footer[_ngcontent-%COMP%]{z-index:1000;height:50px;align-items:center;padding:35px;background-color:#010b13;border-top:1px solid #212c45;outline:1px solid #101622;bottom:0;left:0;position:sticky;color:#fffdfa;font-family:\"DM Serif Display\",sans-serif;font-size:20px;box-shadow:0 0 40px #1e2940,inset 0 0 40px #000;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='100%25' width='100%25'%3E%3Cdefs%3E%3Cpattern id='doodad' width='40' height='40' viewBox='0 0 40 40' patternUnits='userSpaceOnUse' patternTransform='rotate(135)'%3E%3Crect width='100%25' height='100%25' fill='rgba(10, 16, 20,1)'/%3E%3Cpath d='M10 0L20 10L30 0L30 10L40 10L30 20L40 30L30 30L30 40L20 30L10 40L10 30L0 30L10 20L0 10L10 10z' fill='rgba(16, 22, 34,1)'/%3E%3Cpath d='M9 10L20 10.5L10 20zM30 9L29.5 20L20 10zM31 30L20 29.5L30 20zM10 31L20 30L10.5 20z' fill='rgba(10, 10, 20,1)'/%3E%3C/pattern%3E%3C/defs%3E%3Crect fill='url(%23doodad)' height='200%25' width='200%25'/%3E%3C/svg%3E \")}.contact-button[_ngcontent-%COMP%]{border:2px solid #FFFDFA;padding:2px 20px 3px;font-size:22px;color:#fffdfa;display:inline-block;position:relative;transition:.3s ease-in-out all;cursor:pointer}.contact-button[_ngcontent-%COMP%]:before{content:\"\";background:#FFFDFA;position:absolute;width:0%;top:0;left:0;height:100%;transition:.3s ease-out all;z-index:-1}.contact-button[_ngcontent-%COMP%]:hover:before{width:100%}.contact-button[_ngcontent-%COMP%]:hover{color:#010b13;font-weight:900}"]})}return n})(),sJ=(()=>{class n{constructor(){this.title="irinaluta"}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Ts({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"router"]],template:function(i,r){1&i&&ln(0,"app-header")(1,"router-outlet",0)(2,"app-footer")},dependencies:[h0,nJ,rJ]})}return n})();class Om{}class Fm{}class Ki{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ki?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Ki;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ki?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class oJ{encodeKey(e){return qN(e)}encodeValue(e){return qN(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const cJ=/%(\d[a-f0-9])/gi,lJ={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function qN(n){return encodeURIComponent(n).replace(cJ,(e,t)=>lJ[t]??e)}function Um(n){return`${n}`}class oo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new oJ,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function aJ(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Um):[Um(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new oo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Um(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Um(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class uJ{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function XN(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function YN(n){return typeof Blob<"u"&&n instanceof Blob}function ZN(n){return typeof FormData<"u"&&n instanceof FormData}class Ud{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function dJ(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers||(this.headers=new Ki),this.context||(this.context=new uJ),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new oo,this.urlWithParams=t}serializeBody(){return null===this.body?null:XN(this.body)||YN(this.body)||ZN(this.body)||function hJ(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof oo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||ZN(this.body)?null:YN(this.body)?this.body.type||null:XN(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof oo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),l)),new Ud(t,i,s,{params:l,headers:c,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var ao=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(ao||{});class xM{constructor(e,t=200,i="OK"){this.headers=e.headers||new Ki,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class km extends xM{constructor(e={}){super(e),this.type=ao.ResponseHeader}clone(e={}){return new km({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class la extends xM{constructor(e={}){super(e),this.type=ao.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new la({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class bl extends xM{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function MM(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let wM=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Ud)s=t;else{let c,l;c=r.headers instanceof Ki?r.headers:new Ki(r.headers),r.params&&(l=r.params instanceof oo?r.params:new oo({fromObject:r.params})),s=new Ud(t,i,void 0!==r.body?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=De(s).pipe(Po(c=>this.handler.handle(c)));if(t instanceof Ud||"events"===r.observe)return o;const a=o.pipe(ss(c=>c instanceof la));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(vt(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(vt(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(vt(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(vt(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new oo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,MM(r,i))}post(t,i,r={}){return this.request("POST",t,MM(r,i))}put(t,i,r={}){return this.request("PUT",t,MM(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(Me(Om))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function JN(n,e){return e(n)}function vJ(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const _J=new ve(""),kd=new ve(""),QN=new ve(""),eL=new ve("");function xJ(){let n=null;return(e,t)=>{null===n&&(n=(se(_J,{optional:!0})??[]).reduceRight(vJ,JN));const i=se(Cf),r=i.add();return n(e,t).pipe(zu(()=>i.remove(r)))}}let tL=(()=>{class n extends Om{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=se(Cf);const r=se(eL,{optional:!0});this.backend=r??t}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(kd),...this.injector.get(QN,[])]));this.chain=r.reduceRight((s,o)=>function yJ(n,e,t){return(i,r)=>Is(t,()=>e(i,s=>n(s,r)))}(s,o,this.injector),JN)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(zu(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(Me(Fm),Me(Ai))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const bJ=/^\)\]\}',?\n/;let iL=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new te(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Sn(i.\u0275loadImpl()):De(null)).pipe(di(()=>new Yt(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((v,g)=>o.setRequestHeader(v,g.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const v=t.detectContentTypeHeader();null!==v&&o.setRequestHeader("Content-Type",v)}if(t.responseType){const v=t.responseType.toLowerCase();o.responseType="json"!==v?v:"text"}const a=t.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const v=o.statusText||"OK",g=new Ki(o.getAllResponseHeaders()),m=function TJ(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return c=new km({headers:g,status:o.status,statusText:v,url:m}),c},u=()=>{let{headers:v,status:g,statusText:m,url:_}=l(),y=null;204!==g&&(y=typeof o.response>"u"?o.responseText:o.response),0===g&&(g=y?200:0);let x=g>=200&&g<300;if("json"===t.responseType&&"string"==typeof y){const M=y;y=y.replace(bJ,"");try{y=""!==y?JSON.parse(y):null}catch(S){y=M,x&&(x=!1,y={error:S,text:y})}}x?(s.next(new la({body:y,headers:v,status:g,statusText:m,url:_||void 0})),s.complete()):s.error(new bl({error:y,headers:v,status:g,statusText:m,url:_||void 0}))},d=v=>{const{url:g}=l(),m=new bl({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:g||void 0});s.error(m)};let h=!1;const f=v=>{h||(s.next(l()),h=!0);let g={type:ao.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),"text"===t.responseType&&o.responseText&&(g.partialText=o.responseText),s.next(g)},p=v=>{let g={type:ao.UploadProgress,loaded:v.loaded};v.lengthComputable&&(g.total=v.total),s.next(g)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:ao.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(Me(KD))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();const bM=new ve("XSRF_ENABLED"),rL=new ve("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),sL=new ve("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class oL{}let DJ=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=zD(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(Me(_i),Me(_o),Me(rL))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac})}return n})();function IJ(n,e){const t=n.url.toLowerCase();if(!se(bM)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=se(oL).getToken(),r=se(sL);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var co=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(co||{});function RJ(...n){const e=[wM,iL,tL,{provide:Om,useExisting:tL},{provide:Fm,useExisting:iL},{provide:kd,useValue:IJ,multi:!0},{provide:bM,useValue:!0},{provide:oL,useClass:DJ}];for(const t of n)e.push(...t.\u0275providers);return function Qg(n){return{\u0275providers:n}}(e)}const aL=new ve("LEGACY_INTERCEPTOR_FN");function PJ(){return function ua(n,e){return{\u0275kind:n,\u0275providers:e}}(co.LegacyInterceptors,[{provide:aL,useFactory:xJ},{provide:kd,useExisting:aL,multi:!0}])}let NJ=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qr({type:n});static#n=this.\u0275inj=xr({providers:[RJ(PJ())]})}return n})();class BJ{http;prefix;suffix;constructor(e,t="/assets/i18n/",i=".json"){this.http=e,this.prefix=t,this.suffix=i}getTranslation(e){return this.http.get(`${this.prefix}${e}${this.suffix}`)}}let VJ=(()=>{class n{constructor(t){this.http=t}getTranslation(t){return this.http.get(`./assets/i18n/${t}.json`)}static#e=this.\u0275fac=function(i){return new(i||n)(Me(wM))};static#t=this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function HJ(n){return new BJ(n,"./assets/i18n/",".json")}let zJ=(()=>{class n{constructor(t){this.translate=t,t.setDefaultLang("en")}static#e=this.\u0275fac=function(i){return new(i||n)(Me(Fd))};static#t=this.\u0275mod=qr({type:n,bootstrap:[sJ]});static#n=this.\u0275inj=xr({providers:[VJ],imports:[sj,tJ,NJ,QK.forRoot({loader:{provide:Od,useFactory:HJ,deps:[wM]}})]})}return n})();ij().bootstrapModule(zJ).catch(n=>console.error(n))}},zm=>{zm(zm.s=76)}]);